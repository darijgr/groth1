% -------------------------------------------------------------
% NOTE ON THE DETAILED AND SHORT VERSIONS:
% -------------------------------------------------------------
% This paper comes in two versions, a detailed and a short one.
% The short version should be more than sufficient for any
% reasonable use; the detailed one was written purely to
% convince the author of its correctness.
% To switch between the two versions, find the line containing
% "\newenvironment{noncompile}{}{}" in this LaTeX file.
% Look at the two lines right beneath this line.
% To compile the detailed version, they should be as follows:
%   \includecomment{verlong}
%   \excludecomment{vershort}
% To compile the short version, they should be as follows:
%   \excludecomment{verlong}
%   \includecomment{vershort}
% As a rule, the line
%   \excludecomment{noncompile}
% should stay as it is.
% -------------------------------------------------------------
% NOTES ON SOME HACKS USED IN THIS FILE:
% -------------------------------------------------------------
% One of my pet peeves with amsthm is its use of italics in the theorem and
% proposition environments; this makes math and text indistinguishable in said
% enviroments. To avoid this, I redefine the enviroments to use the standard
% font and to use a hanging indent, along with a bold vertical bar to its
% left, to distinguish these environments from surrounding text. (Along with
% the advantage of distinguishing math from text, this also allows nesting
% several such environments inside each other, like a definition inside a
% remark. I'm not sure how good of an idea this is, though. There are also
% downsides related to the hanging indentation, such as footnotes out of it
% being painful to do right.) This is done starting from the line
%   \theoremstyle{definition}
% and until the line
%   {\end{leftbar}\end{exmp}}

\documentclass[numbers=enddot,12pt,final,onecolumn,notitlepage]{scrartcl}%
\usepackage[all,cmtip]{xy}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{framed}
\usepackage{amsmath}
\usepackage{comment}
\usepackage{needspace}
\usepackage{color}
\usepackage{hyperref}
\usepackage[sc]{mathpazo}
\usepackage[T1]{fontenc}
\usepackage{amsthm}
\usepackage{fancyhdr}
\usepackage{ytableau}
%TCIDATA{OutputFilter=latex2.dll}
%TCIDATA{Version=5.50.0.2960}
%TCIDATA{LastRevised=Friday, June 05, 2015 02:13:51}
%TCIDATA{SuppressPackageManagement}
%TCIDATA{<META NAME="GraphicsSave" CONTENT="32">}
%TCIDATA{<META NAME="SaveForMode" CONTENT="1">}
%TCIDATA{BibliographyScheme=Manual}
%BeginMSIPreambleData
\providecommand{\U}[1]{\protect\rule{.1in}{.1in}}
%EndMSIPreambleData
\theoremstyle{definition}
\newtheorem{theo}{Theorem}[section]
\newenvironment{theorem}[1][]
{\begin{theo}[#1]\begin{leftbar}}
{\end{leftbar}\end{theo}}
\newtheorem{lem}[theo]{Lemma}
\newenvironment{lemma}[1][]
{\begin{lem}[#1]\begin{leftbar}}
{\end{leftbar}\end{lem}}
\newtheorem{prop}[theo]{Proposition}
\newenvironment{proposition}[1][]
{\begin{prop}[#1]\begin{leftbar}}
{\end{leftbar}\end{prop}}
\newtheorem{defi}[theo]{Definition}
\newenvironment{definition}[1][]
{\begin{defi}[#1]\begin{leftbar}}
{\end{leftbar}\end{defi}}
\newtheorem{remk}[theo]{Remark}
\newenvironment{remark}[1][]
{\begin{remk}[#1]\begin{leftbar}}
{\end{leftbar}\end{remk}}
\newtheorem{coro}[theo]{Corollary}
\newenvironment{corollary}[1][]
{\begin{coro}[#1]\begin{leftbar}}
{\end{leftbar}\end{coro}}
\newtheorem{conv}[theo]{Convention}
\newenvironment{condition}[1][]
{\begin{conv}[#1]\begin{leftbar}}
{\end{leftbar}\end{conv}}
\newtheorem{quest}[theo]{TODO}
\newenvironment{todo}[1][]
{\begin{quest}[#1]\begin{leftbar}}
{\end{leftbar}\end{quest}}
\newtheorem{warn}[theo]{Warning}
\newenvironment{conclusion}[1][]
{\begin{warn}[#1]\begin{leftbar}}
{\end{leftbar}\end{warn}}
\newtheorem{conj}[theo]{Conjecture}
\newenvironment{conjecture}[1][]
{\begin{conj}[#1]\begin{leftbar}}
{\end{leftbar}\end{conj}}
\newtheorem{exmp}[theo]{Example}
\newenvironment{example}[1][]
{\begin{exmp}[#1]\begin{leftbar}}
{\end{leftbar}\end{exmp}}
\iffalse
\newenvironment{proof}[1][Proof]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\fi
\newenvironment{verlong}{}{}
\newenvironment{vershort}{}{}
\newenvironment{noncompile}{}{}
\newenvironment{obsolete}{}{}
\excludecomment{verlong}
\includecomment{vershort}
\excludecomment{noncompile}
\excludecomment{obsolete}
\newcommand{\kk}{\mathbf{k}}
\newcommand{\id}{\operatorname{id}}
\newcommand{\ev}{\operatorname{ev}}
\newcommand{\Comp}{\operatorname{Comp}}
\newcommand{\bk}{\mathbf{k}}
\newcommand{\Nplus}{\mathbb{N}_{+}}
\newcommand{\NN}{\mathbb{N}}
\let\sumnonlimits\sum
\let\prodnonlimits\prod
\renewcommand{\sum}{\sumnonlimits\limits}
\renewcommand{\prod}{\prodnonlimits\limits}
\setlength\textheight{22.5cm}
\setlength\textwidth{15cm}
\pagestyle{fancy}
\lhead{Refined dual stable Grothendieck polynomials}
\rhead{\today}
\begin{document}

\title{Refined dual stable Grothendieck polynomials and generalized Bender-Knuth involutions}
\author{Pavel Galashin, Darij Grinberg, and Gaku Liu}
\date{\today}
\maketitle

\section{Introduction}

\begin{todo}
Add an introduction (as in, abstract/advertisement; the definitions of all
notations used should be separate and have already been written).

Ask Alex to come up with reasons why to care about dual stable Grothendieck polynomials?

The below introduction is a stopgap.
\end{todo}

Thomas Lam and Pavlo Pylyavskyy, in \cite[\S 9.1]{LamPyl}, (and earlier Mark
Shimozono and Mike Zabrocki in unpublished work of 2003) studied \textit{dual
stable Grothendieck polynomials}, a deformation (in a sense) of the Schur
functions. As the Schur functions are multivariate generating functions of
semistandard tableaux of a given (skew) partition shape, the dual stable
Grothendieck polynomials are generating functions of reverse plane partitions,
which, unlike semistandard tableaux, are only required to have their entries
increase \textit{weakly} down columns. (Like for the Schur function, each
addend of the generating function corresponds to a single reverse plane
partition $T$. It is, in fact, the product of the $x$'s corresponding to the
entries of $T$ -- but with the caveat that every entry counts only once per
column, even if it appears several times in the column. We will give a more
formal definition of this and other concepts further below.) Lam and
Pylyavskyy have shown that these dual stable Grothendieck
polynomials\footnote{The word \textquotedblleft polynomials\textquotedblright%
\ is a stretch: these generating functions are bounded-degree power series in
infinitely many indeterminates (like the Schur functions).} are symmetric functions.

We devise a common generalization (with infinitely many additional degrees of
freedom) of the dual stable Grothendieck polynomials and the classical skew
Schur functions. We then prove that these generalized power series still are
symmetric functions (which also yields a new proof of \cite[Theorem
9.1]{LamPyl}). This is achieved through a generalization of the classical
Bender-Knuth involutions to the reverse plane partitions; these generalized
involutions are constructed using a form of the \textit{diamond lemma}, which
we prove for the sake of completeness.

\subsection{Acknowledgments}

Thanks are due to Richard Stanley for familiarizing the authors of this paper
with dual stable Grothendieck polynomials, and to Alexander Postnikov for
providing context and motivation.

\begin{todo}
Keep this up to date.
\end{todo}

\section{\label{sect.notations}Notations and definitions}

Let us begin by defining our notations (including some standard conventions
from algebraic combinatorics).

\subsection{Partitions and tableaux}

We set $\mathbb{N}=\left\{  0,1,2,\ldots\right\}  $ and $\mathbb{N}%
_{+}=\left\{  1,2,3,\ldots\right\}  $. A \textit{weak composition} will mean a
sequence $\left(  \alpha_{1},\alpha_{2},\alpha_{3},\ldots\right)
\in\mathbb{N}^{\mathbb{N}_{+}}$ of nonnegative integers such that all but
finitely many $i\in\mathbb{N}_{+}$ satisfy $\alpha_{i}=0$. Given a weak
composition $\alpha=\left(  \alpha_{1},\alpha_{2},\alpha_{3},\ldots\right)  $,
we denote the sum $\alpha_{1}+\alpha_{2}+\alpha_{3}+\cdots$ (which is finite
and an element of $\mathbb{N}$) by $\left\vert \alpha\right\vert $ and call it
the \textit{size} of $\alpha$. Given a weak composition $\alpha$ and a
positive integer $i$, we let $\alpha_{i}$ denote the $i$-th entry of $\alpha$
(so that every weak composition $\alpha$ automatically satisfies
$\alpha=\left(  \alpha_{1},\alpha_{2},\alpha_{3},\ldots\right)  $).

A \textit{partition} means a weak composition $\left(  \alpha_{1},\alpha
_{2},\alpha_{3},\ldots\right)  $ satisfying $\alpha_{1}\geq\alpha_{2}%
\geq\alpha_{3}\geq\cdots$. We identify every partition $\left(  \alpha
_{1},\alpha_{2},\alpha_{3},\ldots\right)  $ with the (truncated) sequence
$\left(  \alpha_{1},\alpha_{2},\ldots,\alpha_{m}\right)  $ whenever $m$ is a
nonnegative integer such that $\alpha_{m+1}=\alpha_{m+2}=\alpha_{m+3}%
=\cdots=0$. In particular, the partition $\left(  0,0,0,\ldots\right)  $ is
thus identified with the empty sequence $\left(  {}\right)  $ (but also, for
example, with $\left(  0,0,0\right)  $). We denote the latter partition by
$\varnothing$, and call it the \textit{empty partition}.

We let $\operatorname*{Par}$ denote the set of all partitions.

The \textit{Young diagram}\footnote{also known as the \textit{Ferrers
diagram}} of a partition $\lambda$ is defined to be the subset $\left\{
\left(  i,j\right)  \in\mathbb{N}_{+}^{2}\ \mid\ j\leq\lambda_{i}\right\}  $
of $\mathbb{N}_{+}^{2}$. It is denoted by $Y\left(  \lambda\right)  $, and has
size $\left\vert Y\left(  \lambda\right)  \right\vert =\lambda_{1}+\lambda
_{2}+\lambda_{3}+\cdots=\left\vert \lambda\right\vert $.

We draw every subset of $\mathbb{N}_{+}^{2}$ (for example, the Young diagram
of a partition) as a set of boxes in the plane, according to the following
convention (known as the \textit{English notation}, or also as the
\textit{matrix notation}): We imagine an infinite table, whose rows are
labelled $1,2,3,\ldots$ (from left to right) and whose columns are labelled
$1,2,3,\ldots$ as well (from top to bottom). We represent every element
$\left(  i,j\right)  $ of $\mathbb{N}_{+}^{2}$ as a box in this table --
namely, as the box at the intersection of row $i$ with column $j$. In order to
draw a subset $Z$ of $\mathbb{N}_{+}^{2}$, we simply chart (the borders of)
the boxes corresponding to all the $\left(  i,j\right)  \in Z$. For instance,
the Young diagram of the partition $\left(  4,2,1\right)  $ is the subset
$\left\{  \left(  1,1\right)  ,\left(  1,2\right)  ,\left(  1,3\right)
,\left(  1,4\right)  ,\left(  2,1\right)  ,\left(  2,2\right)  ,\left(
3,1\right)  \right\}  $ of $\mathbb{N}_{+}^{2}$, and we draw it as $%
%TCIMACRO{\TeXButton{y}{\ydiagram{0+4,0+2,0+1}}}%
%BeginExpansion
\ydiagram{0+4,0+2,0+1}%
%EndExpansion
$. We refer to elements of $\mathbb{N}_{+}^{2}$ as \textit{cells} (since we
draw them as boxes in the plane).

If $\mu$ and $\lambda$ are two partitions, then we say that $\mu
\subseteq\lambda$ if and only if every $i\in\mathbb{N}_{+}$ satisfies $\mu
_{i}\leq\lambda_{i}$. Equivalently, $\mu\subseteq\lambda$ if and only if
$Y\left(  \mu\right)  \subseteq Y\left(  \lambda\right)  $. This defines a
partial order $\subseteq$ on the set $\operatorname*{Par}$ of all partitions.
A \textit{skew partition} shall denote a pair $\left(  \mu,\lambda\right)  $
of two partitions $\mu$ and $\lambda$ satisfying $\mu\subseteq\lambda$; this
pair will also be denoted by $\lambda/\mu$. Given a skew partition
$\lambda/\mu$, we define the \textit{(skew) Young diagram} $Y\left(
\lambda/\mu\right)  $ of this skew partition to be the subset $Y\left(
\lambda\right)  \setminus Y\left(  \mu\right)  $ of $\mathbb{N}_{+}^{2}$.
Again, this Young diagram is drawn as above; for instance, the Young diagram
of $\left(  4,3,1\right)  /\left(  2,1\right)  $ is $%
%TCIMACRO{\TeXButton{y}{\ydiagram{2+2,2+1,0+1}}}%
%BeginExpansion
\ydiagram{2+2,2+1,0+1}%
%EndExpansion
$.

A subset $Z$ of $\mathbb{N}_{+}^{2}$ is said to be \textit{convex} if it has
the following property: If $\left(  i,j\right)  \in Z$, $\left(  i^{\prime
},j^{\prime}\right)  \in\mathbb{N}_{+}^{2}$ and $\left(  i^{\prime\prime
},j^{\prime\prime}\right)  \in Z$ are such that $i\leq i^{\prime}\leq
i^{\prime\prime}$ and $j\leq j^{\prime}\leq j^{\prime\prime}$, then
\begin{equation}
\left(  i^{\prime},j^{\prime}\right)  \in Z. \label{eq.convex}%
\end{equation}
It is clear that the Young diagram $Y\left(  \lambda/\mu\right)  $ is convex
whenever $\lambda/\mu$ is a skew partition. It is easy to show that,
conversely, every finite convex subset of $\mathbb{N}_{+}^{2}$ has the form
$Y\left(  \lambda/\mu\right)  $ for some skew partition $\lambda/\mu$.

If $Z$ is a subset of $\mathbb{N}_{+}^{2}$ (for instance, a Young diagram),
then a \textit{filling} of $Z$ means a map $T:Z\rightarrow\mathbb{N}_{+}$.
Such a filling can be visually represented by drawing the elements of $Z$ as
boxes (following the convention above) and, for every $c\in Z$, inserting the
value $T\left(  c\right)  $ into the box corresponding to $c$. For instance, $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{centertableaux}
%\begin{ytableau}
%3 & 2 \\
%4 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{centertableaux}
\begin{ytableau}
3 & 2 \\
4 \\
2
\end{ytableau}%
%EndExpansion
$ is one possible filling of $Y\left(  \left(  2,1,1\right)  \right)  $;
formally speaking, it is the map $Y\left(  \left(  2,1,1\right)  \right)
\rightarrow\mathbb{N}_{+}$ which sends $\left(  1,1\right)  $, $\left(
1,2\right)  $, $\left(  2,1\right)  $ and $\left(  3,1\right)  $ to $3$, $2$,
$4$ and $2$, respectively. When $T$ is a filling of $Z$ and when $c$ is a cell
in $Z$, we refer to the integer $T\left(  c\right)  \in\mathbb{N}_{+}$ as the
\textit{entry} of $T$ in the cell $c$. For varying $c$, these integers are
called the \textit{entries} of $T$.

Given a finite convex subset $Z$ of $\mathbb{N}_{+}^{2}$, we define a
\textit{reverse plane partition of shape }$Z$ to be a filling $T:Z\rightarrow
\mathbb{N}_{+}^{2}$ of $Z$ satisfying the following two requirements:

\begin{itemize}
\item The entries of $T$ are \textit{weakly increasing along rows} (speaking
in terms of the picture). In more precise terms: If $\left(  i,j\right)  $ and
$\left(  i,j^{\prime}\right)  $ are two elements of $Z$ such that
$j<j^{\prime}$, then $T\left(  i,j\right)  \leq T\left(  i,j^{\prime}\right)
$.

\item The entries of $T$ are \textit{weakly increasing down columns}. In more
precise terms: If $\left(  i,j\right)  $ and $\left(  i^{\prime},j\right)  $
are two elements of $Z$ such that $i<i^{\prime}$, then $T\left(  i,j\right)
\leq T\left(  i^{\prime},j\right)  $.
\end{itemize}

Generally, a \textit{reverse plane partition} is defined to be a map which is
a reverse plane partition of shape $Z$ for some finite convex subset $Z$ of
$\mathbb{N}_{+}^{2}$. Notice that $Z$ is uniquely determined by the map (in
fact, it is the domain of the map).

We shall abbreviate the term \textquotedblleft reverse plane
partition\textquotedblright\ as \textquotedblleft\textit{rpp}%
\textquotedblright. For instance, $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 3 & 3 \\
%2 & 3 \\
%3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 3 & 3 \\
2 & 3 \\
3 & 4
\end{ytableau}%
%EndExpansion
$ is an rpp of shape $Y\left(  \left(  3,2,2\right)  /\left(  1\right)
\right)  $.

A well-known class of rpps are the \textit{semistandard tableaux} (also known
as column-strict tableaux). To define this class, it is enough to change
\textquotedblleft weakly increasing down columns\textquotedblright\ into
\textquotedblleft strictly increasing down columns\textquotedblright\ (and,
correspondingly, change \textquotedblleft$T\left(  i,j\right)  \leq T\left(
i^{\prime},j\right)  $\textquotedblright\ into \textquotedblleft$T\left(
i,j\right)  <T\left(  i^{\prime},j\right)  $\textquotedblright) in the above
definition of an rpp. For instance, $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 3 & 3 \\
%2 & 3 \\
%3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 3 & 3 \\
2 & 3 \\
3 & 4
\end{ytableau}%
%EndExpansion
$ is not a semistandard tableau due to having two $3$'s in its second column,
but $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 3 & 3 \\
%2 & 4 \\
%3 & 7
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 3 & 3 \\
2 & 4 \\
3 & 7
\end{ytableau}%
%EndExpansion
$ is a semistandard tableau. Semistandard tableaux have been studied for
decades; an exposition of their properties and applications can be found in
Fulton's \cite{Fulton97}.

\begin{vershort}
\begin{remark}
Let $\lambda/\mu$ be a skew partition. What we call a semistandard tableau of
shape $Y\left(  \lambda/\mu\right)  $ is usually called a \textit{semistandard
tableau of shape }$\lambda/\mu$. (However, unlike the ``semistandard
tableaux'' defined by some other authors, our semistandard tableaux of shape
$Y\left(  \lambda/ \mu\right)  $ do not ``store'' the skew partition $\lambda/
\mu$ as part of their data.)
\end{remark}
\end{vershort}

\begin{comment}
[Here is some older writing which I have commented out because it is too
long and rather irrelevant to this paper.]
However, there is a minor discrepancy between
the meaning of \textquotedblleft semistandard tableau\textquotedblright\ in
this paper and the meaning of \textquotedblleft semistandard
tableau\textquotedblright\ in some other literature: Namely, for us, a
\textquotedblleft semistandard tableau\textquotedblright\ is just a filling of
a finite convex subset $Z$ of $\mathbb{N}_{+}^{2}$ satisfying certain
properties, whereas for some other authors, a semistandard tableau also
\textquotedblleft remembers\textquotedblright\ a skew partition $\lambda/\mu$
(called its \textquotedblleft shape\textquotedblright) satisfying $Z=Y\left(
\lambda/\mu\right)  $. This does make a difference, because every finite
convex subset $Z$ of $\mathbb{N}_{+}^{2}$ can be written in the form $Y\left(
\lambda/\mu\right)  $, but not uniquely, and thus one and the same filling of
one and the same subset $Z$ can have different skew partitions $\lambda/\mu$
assigned to it. For us, however, the difference does not matter.
\end{comment}


\begin{verlong}
\begin{remark}
Our definition of \textquotedblleft semistandard tableau\textquotedblright%
\ differs mildly from that used in some papers on algebraic combinatorics.
Namely, combinatorialists often define a \textquotedblleft semistandard
tableau\textquotedblright\ to be a triple $\left(  \lambda,\mu,T\right)  $,
where $\lambda/\mu$ is a skew partition and where $T$ is what we call a
semistandard tableau $T$ of shape $Y\left(  \lambda/\mu\right)  $. The
parameters $\lambda$ and $\mu$ cannot always be uniquely reconstructed from
$T$ (since, e.g., we have $Y\left(  \left(  2,1\right)  /\left(  2\right)
\right)  =Y\left(  \left(  1,1\right)  /\left(  1\right)  \right)  $), and it
makes sense to explicitly carry them around when studying certain algorithms
such as jeu de taquin and Robinson-Schensted insertion (although, of course,
they play a role subordinate to that of $T$, and one usually refers to $T$ as
the tableau). However, for what we are going to do in this paper, our
definition is just as suitable.

Let $\lambda/\mu$ be a skew partition. What we call a semistandard tableau of
shape $Y\left(  \lambda/\mu\right)  $ is usually called a \textit{semistandard
tableau of shape }$\lambda/\mu$ (except that, as explained above, many
combinatorialists prefer to keep $\lambda$ and $\mu$ as part of the data).
\end{remark}
\end{verlong}

\subsection{Symmetric functions}

We now come to the algebraic part of our definitions.

\begin{vershort}
We let $\mathbf{k}$ be an arbitrary commutative ring with unity.\footnote{Many
authors, such as those of \cite{LamPyl}, set $\mathbf{k}=\mathbb{Z}$.} We
consider the ring $\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]
\right]  $ of formal power series in countably many indeterminates
$x_{1},x_{2},x_{3},\ldots$. Given a weak composition $\alpha$, we let
$\mathbf{x}^{\alpha}$ be the monomial $x_{1}^{\alpha_{1}}x_{2}^{\alpha_{2}%
}x_{3}^{\alpha_{3}}\cdots$.
\end{vershort}

\begin{verlong}
We let $\mathbf{k}$ be an arbitrary commutative ring with unity.\footnote{Many
authors, such as those of \cite{LamPyl}, set $\mathbf{k}=\mathbb{Z}$.} Let
$x_{1},x_{2},x_{3},\ldots$ be a set of countably many (hitherto unused)
symbols, which we will use as commuting indeterminates. We can then consider
the ring $\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]  \right]
$ of formal power series in these indeterminates $x_{1},x_{2},x_{3},\ldots$.
Given a weak composition $\alpha$, we let $\mathbf{x}^{\alpha}$ be the
monomial $x_{1}^{\alpha_{1}}x_{2}^{\alpha_{2}}x_{3}^{\alpha_{3}}\cdots$. Then,
these monomials $\mathbf{x}^{\alpha}$ with $\alpha$ ranging over all weak
compositions are precisely all the monomials that can occur in a formal power
series in $\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]  \right]
$.
\end{verlong}

A formal power series $f\in\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3}%
,\ldots\right]  \right]  $ is said to be \textit{bounded-degree} if there
exists an $N\in\mathbb{N}$ such that every monomial $\mathbf{x}^{\alpha}$
which occurs (with nonzero coefficient) in $f$ satisfies $\left\vert
\alpha\right\vert \leq N$. (Notice that $\left\vert \alpha\right\vert $ is the
degree of $\mathbf{x}^{\alpha}$.) The set of all bounded-degree power series
in $\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]  \right]  $ is a
$\mathbf{k}$-subalgebra of $\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3}%
,\ldots\right]  \right]  $, and will be denoted by $\mathbf{k}\left[  \left[
x_{1},x_{2},x_{3},\ldots\right]  \right]  _{\operatorname*{bdd}}$.

We let $\mathfrak{S}_{\left(  \infty\right)  }$ denote the group of all
permutations $\pi$ of the set $\mathbb{N}_{+}$ such that all but finitely many
$i\in\mathbb{N}_{+}$ satisfy $\pi\left(  i\right)  =i$. This is a subgroup of
the group $\mathfrak{S}_{\infty}$ of \textit{all} permutations of
$\mathbb{N}_{+}$. The group $\mathfrak{S}_{\left(  \infty\right)  }$ is
generated by the subset $\left\{  s_{1},s_{2},s_{3},\ldots\right\}  $, where
each $s_{i}$ is the transposition $\left(  i,i+1\right)  $%
.\ \ \ \ \footnote{To prove this result, it is enough to notice that the
finite symmetric groups $\mathfrak{S}_{n}$ for all $n\in\mathbb{N}$ can be
canonically embedded into $\mathfrak{S}_{\left(  \infty\right)  }$, and
$\mathfrak{S}_{\left(  \infty\right)  }$ becomes their direct limit.} The
group $\mathfrak{S}_{\infty}$ (and thus, also its subgroup $\mathfrak{S}%
_{\left(  \infty\right)  }$) acts on the set of all weak compositions by the
rule%
\begin{align*}
\pi\cdot\left(  \alpha_{1},\alpha_{2},\alpha_{3},\ldots\right)   &  =\left(
\alpha_{\pi^{-1}\left(  1\right)  },\alpha_{\pi^{-1}\left(  2\right)  }%
,\alpha_{\pi^{-1}\left(  3\right)  },\ldots\right) \\
&  \ \ \ \ \ \ \ \ \ \ \text{for every }\pi\in\mathfrak{S}_{\infty}\text{
and}\\
&  \ \ \ \ \ \ \ \ \ \ \text{ every weak composition }\left(  \alpha
_{1},\alpha_{2},\alpha_{3},\ldots\right)  .
\end{align*}


A formal power series $f\in\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3}%
,\ldots\right]  \right]  $ is said to be \textit{symmetric} if it has the
following property: Whenever $\alpha$ and $\beta$ are two weak compositions in
the same $\mathfrak{S}_{\left(  \infty\right)  }$-orbit, the coefficients of
$f$ before $\mathbf{x}^{\alpha}$ and before $\mathbf{x}^{\beta}$ are
equal.\footnote{Notice that this definition does not change if $\mathfrak{S}%
_{\left(  \infty\right)  }$ is replaced by $\mathfrak{S}_{\infty}$. But it is
customary (and useful to our purposes) to define it using $\mathfrak{S}%
_{\left(  \infty\right)  }$.}

The \textit{symmetric functions} over $\mathbf{k}$ are defined to be the
symmetric bounded-degree power series $f\in\mathbf{k}\left[  \left[
x_{1},x_{2},x_{3},\ldots\right]  \right]  $. They form a $\mathbf{k}%
$-subalgebra of $\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]
\right]  $. This $\mathbf{k}$-subalgebra is called the \textit{ring of
symmetric functions over }$\mathbf{k}$; it will be denoted by $\Lambda$ or
(when $\mathbf{k}$ is not clear from the context) by $\Lambda_{\mathbf{k}}$.
(The reader shall be warned that \cite{LamPyl} denotes this $\mathbf{k}%
$-algebra by $\operatorname*{Sym}$, while using the notation $\Lambda$ for the
set which we call $\operatorname*{Par}$.) Symmetric functions are a classical
field of research, and are closely related to Young diagrams and tableaux; see
\cite[Chapter 7]{Stan99}, \cite{Macdon95} and \cite[Chapter 2]{GriRei15} for expositions.

\begin{todo}
Update Grinberg-Reiner reference to whatever is most recent.
\end{todo}

Another equivalent way to define the notion of symmetric functions\ is the
following: The group $\mathfrak{S}_{\infty}$ acts $\mathbf{k}$-linearly and
continuously on the $\mathbf{k}$-module $\mathbf{k}\left[  \left[  x_{1}%
,x_{2},x_{3},\ldots\right]  \right]  $ by the rule%
\[
\pi\mathbf{x}^{\alpha}=\mathbf{x}^{\pi\cdot\alpha}%
\ \ \ \ \ \ \ \ \ \ \text{for every }\pi\in\mathfrak{S}_{\infty}\text{ and
every weak composition }\alpha\text{.}%
\]
The subgroup $\mathfrak{S}_{\left(  \infty\right)  }$ of $\mathfrak{S}%
_{\infty}$ thus also acts on $\mathbf{k}\left[  \left[  x_{1},x_{2}%
,x_{3},\ldots\right]  \right]  $ by restriction. Both $\mathfrak{S}_{\infty}$
and $\mathfrak{S}_{\left(  \infty\right)  }$ preserve the $\mathbf{k}%
$-submodule $\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]
\right]  _{\operatorname*{bdd}}$, and thus act on $\mathbf{k}\left[  \left[
x_{1},x_{2},x_{3},\ldots\right]  \right]  _{\operatorname*{bdd}}$ as well.
Now,%
\[
\Lambda=\left(  \mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]
\right]  _{\operatorname*{bdd}}\right)  ^{\mathfrak{S}_{\infty}}=\left(
\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]  \right]
_{\operatorname*{bdd}}\right)  ^{\mathfrak{S}_{\left(  \infty\right)  }}.
\]


\subsection{Schur functions}

Given a subset $Z$ of $\mathbb{N}_{+}^{2}$ and a filling $T$ of $Z$, we define
a weak composition $\operatorname*{cont}\left(  T\right)  $ by setting%
\begin{align*}
\left(  \operatorname*{cont}\left(  T\right)  \right)  _{i}  &  =\left\vert
T^{-1}\left(  i\right)  \right\vert =\left(  \text{the number of entries of
}T\text{ equal to }i\right) \\
&  \ \ \ \ \ \ \ \ \ \ \text{for every }i\in\mathbb{N}_{+}.
\end{align*}
We call $\operatorname*{cont}\left(  T\right)  $ the \textit{content} of $T$.
Notice that $\mathbf{x}^{\operatorname*{cont}\left(  T\right)  }=\prod_{c\in
Z}x_{T\left(  c\right)  }$.

\begin{verlong}
\begin{proof}
Let $Z$ be a subset of $\mathbb{N}_{+}^{2}$. Let $T$ be a filling of $Z$. We
need to show that $\mathbf{x}^{\operatorname*{cont}\left(  T\right)  }%
=\prod_{c\in Z}x_{T\left(  c\right)  }$.

The definition of $\mathbf{x}^{\operatorname*{cont}\left(  T\right)  }$ yields%
\begin{align*}
\mathbf{x}^{\operatorname*{cont}\left(  T\right)  }  &  =\prod_{i\in
\mathbb{N}_{+}}\underbrace{x_{i}^{\left(  \operatorname*{cont}\left(
T\right)  \right)  _{i}}}_{\substack{=x_{i}^{\left\vert T^{-1}\left(
i\right)  \right\vert }\\\text{(since }\left(  \operatorname*{cont}\left(
T\right)  \right)  _{i}=\left\vert T^{-1}\left(  i\right)  \right\vert
\text{)}}}=\prod_{i\in\mathbb{N}_{+}}\underbrace{x_{i}^{\left\vert
T^{-1}\left(  i\right)  \right\vert }}_{\substack{=\prod_{c\in T^{-1}\left(
i\right)  }x_{i}\\\text{(since }\prod_{c\in T^{-1}\left(  i\right)  }%
x_{i}=x_{i}^{\left\vert T^{-1}\left(  i\right)  \right\vert }\text{)}}%
}=\prod_{i\in\mathbb{N}_{+}}\underbrace{\prod_{c\in T^{-1}\left(  i\right)  }%
}_{=\prod_{\substack{c\in Z;\\T\left(  c\right)  =i}}}x_{i}\\
&  =\prod_{i\in\mathbb{N}_{+}}\prod_{\substack{c\in Z;\\T\left(  c\right)
=i}}\underbrace{x_{i}}_{\substack{=x_{T\left(  c\right)  }\\\text{(since
}i=T\left(  c\right)  \text{ (since }T\left(  c\right)  =i\text{))}%
}}=\underbrace{\prod_{i\in\mathbb{N}_{+}}\prod_{\substack{c\in Z;\\T\left(
c\right)  =i}}}_{=\prod_{c\in Z}}x_{T\left(  c\right)  }=\prod_{c\in
Z}x_{T\left(  c\right)  },
\end{align*}
qed.
\end{proof}
\end{verlong}

Given a skew partition $\lambda/\mu$, we define the \textit{Schur function}
$s_{\lambda/\mu}$ to be the formal power series $\sum_{\substack{T\text{ is a
semistandard}\\\text{tableau of shape }Y\left(  \lambda/\mu\right)
}}\mathbf{x}^{\operatorname*{cont}\left(  T\right)  }$. A nontrivial property
of these Schur functions is that they are symmetric:

\begin{proposition}
\label{prop.schur.symm}We have $s_{\lambda/\mu}\in\Lambda$ for every skew
partition $\lambda/\mu$.
\end{proposition}

This result appears, e.g., in \cite[Theorem 7.10.2]{Stan99} and
\cite[Proposition 2.11]{GriRei15}; it is commonly proven bijectively using the
so-called \textit{Bender-Knuth involutions}. We shall recall the definitions
of these involutions in Section \ref{sect.BKclassical}.

One might attempt to replace \textquotedblleft semistandard
tableau\textquotedblright\ by \textquotedblleft rpp\textquotedblright\ in the
definition of a Schur function. However, the resulting power series are (in
general) no longer symmetric (for instance, $\sum_{\substack{T\text{ is an
rpp}\\\text{of shape }Y\left(  \left(  2,1\right)  \right)  }}\mathbf{x}%
^{\operatorname*{cont}\left(  T\right)  }\notin\Lambda$). Nevertheless, Lam
and Pylyavskyy \cite[\S 9]{LamPyl} have noticed that it is possible to define
symmetric functions from rpps, albeit it requires replacing the content
$\operatorname*{cont}\left(  T\right)  $ by a subtler construction. Let us now
discuss their definition.

\subsection{Dual stable Grothendieck polynomials}

If $Z$ is a convex subset of $\mathbb{N}_{+}^{2}$, if $T$ is a filling of $Z$,
and if $k\in\mathbb{N}_{+}$, then:

\begin{itemize}
\item The $k$\textit{-th column of }$T$ will mean the sequence of all entries
of $T$ in cells of the form $\left(  i,k\right)  $ with $i\in\mathbb{N}_{+}$
(in the order of increasing $i$).

\item The $k$\textit{-th row of }$T$ will mean the sequence of all entries of
$T$ in cells of the form $\left(  k,i\right)  $ with $i\in\mathbb{N}_{+}$ (in
the order of increasing $i$).
\end{itemize}

Notice that (due to $Z$ being convex) there are no \textquotedblleft
gaps\textquotedblright\ in these rows and columns: If $Z$ is a convex subset
of $\mathbb{N}_{+}^{2}$, and if $k\in\mathbb{N}_{+}$, then the positive
integers $i$ satisfying $\left(  i,k\right)  \in Z$ form a (possibly empty)
interval, and so do the positive integers $i$ satisfying $\left(  k,i\right)
\in Z$.

If $Z$ is a convex subset of $\mathbb{N}_{+}^{2}$, and if $T$ is a filling of
$Z$, then we define a weak composition $\operatorname*{ircont}\left(
T\right)  $ by setting%
\begin{align*}
&  \left(  \operatorname*{ircont}\left(  T\right)  \right)  _{i}=\left(
\text{the number of }k\in\mathbb{N}_{+}\text{ such that the }k\text{-th column
of }T\text{ contains }i\right) \\
&  \ \ \ \ \ \ \ \ \ \ \text{for every }i\in\mathbb{N}_{+}.
\end{align*}
(In more colloquial terms, $\left(  \operatorname*{ircont}\left(  T\right)
\right)  _{i}$ is the number of columns of $T$ which contain $i$.) We refer to
$\operatorname*{ircont}\left(  T\right)  $ as the \textit{irredundant content}
of $T$. For instance, if $T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 3 & 3 \\
%2 & 3 \\
%3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 3 & 3 \\
2 & 3 \\
3 & 4
\end{ytableau}%
%EndExpansion
$, then $\operatorname*{ircont}\left(  T\right)  =\left(  0,1,3,1,0,0,0,\ldots
\right)  $ (since $1$ is contained in $0$ columns of $T$, while $2$ is
contained in $1$ column, $3$ in $3$ columns, etc.).

Notice that
\begin{equation}
\operatorname*{ircont}\left(  T\right)  =\operatorname*{cont}\left(  T\right)
\ \ \ \ \ \ \ \ \ \ \text{if }T\text{ is a semistandard tableau.}
\label{eq.ircont=cont}%
\end{equation}


\begin{vershort}
Indeed, (\ref{eq.ircont=cont}) follows by noticing that in every given column
of a semistandard tableau, every positive integer occurs at most once.
\end{vershort}

\begin{verlong}
\begin{proof}
[Proof of (\ref{eq.ircont=cont}).]Let $T$ be a semistandard tableau. Let
$i\in\mathbb{N}_{+}$. The definition of $\left(  \operatorname*{cont}\left(
T\right)  \right)  _{i}$ yields%
\begin{align}
&  \left(  \operatorname*{cont}\left(  T\right)  \right)  _{i}\nonumber\\
&  =\left(  \text{the number of entries of }T\text{ equal to }i\right)
\nonumber\\
&  =\sum_{k\in\mathbb{N}_{+}}\left(  \text{the number of entries in the
}k\text{-th column of }T\text{ which are equal to }i\right)  .
\label{pf.eq.ircont=cont.1}%
\end{align}
But let $k\in\mathbb{N}_{+}$. The entries of $T$ are strictly increasing down
columns (since $T$ is a semistandard tableau). Thus, in particular, the $k$-th
column of $T$ is strictly increasing. Consequently, all entries of this column
are distinct. Hence, the entry $i$ appears at most once in this column. In
other words,%
\[
\left(  \text{the number of entries in the }k\text{-th column of }T\text{
which are equal to }i\right)  \leq1.
\]
Hence,
\begin{align}
&  \left(  \text{the number of entries in the }k\text{-th column of }T\text{
which are equal to }i\right) \nonumber\\
&  =\left\{
\begin{array}
[c]{c}%
1,\ \text{if the }k\text{-th column of }T\text{ contains }i;\\
0,\ \text{if the }k\text{-th column of }T\text{ does not contain }i
\end{array}
\right.  . \label{pf.eq.ircont=cont.2}%
\end{align}


Let us now forget that we fixed $k$. We thus have shown that every
$k\in\mathbb{N}_{+}$ satisfies (\ref{pf.eq.ircont=cont.2}). Hence,
(\ref{pf.eq.ircont=cont.1}) becomes%
\begin{align*}
&  \left(  \operatorname*{cont}\left(  T\right)  \right)  _{i}\\
&  =\sum_{k\in\mathbb{N}_{+}}\underbrace{\left(  \text{the number of entries
in the }k\text{-th column of }T\text{ which are equal to }i\right)
}_{\substack{=\left\{
\begin{array}
[c]{c}%
1,\ \text{if the }k\text{-th column of }T\text{ contains }i;\\
0,\ \text{if the }k\text{-th column of }T\text{ does not contain }i
\end{array}
\right.  \\\text{(by (\ref{pf.eq.ircont=cont.2}))}}}\\
&  =\sum_{k\in\mathbb{N}_{+}}\left\{
\begin{array}
[c]{c}%
1,\ \text{if the }k\text{-th column of }T\text{ contains }i;\\
0,\ \text{if the }k\text{-th column of }T\text{ does not contain }i
\end{array}
\right. \\
&  =\sum_{\substack{k\in\mathbb{N}_{+};\\\text{the }k\text{-th column of
}T\text{ contains }i}}1+\underbrace{\sum_{\substack{k\in\mathbb{N}%
_{+};\\\text{the }k\text{-th column of }T\text{ does not contain }i}}0}%
_{=0}=\sum_{\substack{k\in\mathbb{N}_{+};\\\text{the }k\text{-th column of
}T\text{ contains }i}}1\\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ contains }i\right) \\
&  =\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{i}%
\end{align*}
(because $\left(  \operatorname*{ircont}\left(  T\right)  \right)
_{i}=\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ contains }i\right)  $).

Let us now forget that we fixed $i$. We thus have shown that $\left(
\operatorname*{cont}\left(  T\right)  \right)  _{i}=\left(
\operatorname*{ircont}\left(  T\right)  \right)  _{i}$ for every
$i\in\mathbb{N}_{+}$. In other words, $\operatorname*{cont}\left(  T\right)
=\operatorname*{ircont}\left(  T\right)  $. This proves (\ref{eq.ircont=cont}).
\end{proof}
\end{verlong}

For the rest of this section, we fix a skew partition $\lambda/\mu$. Now, the
\textit{dual stable Grothendieck polynomial} $g_{\lambda/\mu}$ is defined to
be the formal power series%
\[
\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  }}\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }.
\]
It is easy to see that $g_{\lambda/\mu}$ is a well-defined formal power series
(i.e., the infinite sum $\sum_{\substack{T\text{ is an rpp}\\\text{of shape
}Y\left(  \lambda/\mu\right)  }}\mathbf{x}^{\operatorname*{ircont}\left(
T\right)  }$ converges in the usual topology on the ring $\mathbf{k}\left[
\left[  x_{1},x_{2},x_{3},\ldots\right]  \right]  $).\ \ \ \ \footnote{Be
warned that $g_{\lambda/\mu}$ is (despite its name) not a polynomial (barring
trivial cases).} Unlike the Schur function $s_{\lambda/\mu}$, it is (in
general) not homogeneous, because whenever a column of an rpp $T$ contains an
entry several times, the corresponding monomial $\mathbf{x}%
^{\operatorname*{ircont}\left(  T\right)  }$ \textquotedblleft
counts\textquotedblright\ this entry only once. It is fairly clear that the
highest-degree homogeneous component of $g_{\lambda/\mu}$ is $s_{\lambda/\mu}$
(the component of degree $\left\vert \lambda\right\vert -\left\vert
\mu\right\vert $). Therefore, $g_{\lambda/\mu}$ can be regarded as an
inhomogeneous deformation of the Schur function $s_{\lambda/\mu}$.

Lam and Pylyavskyy, in \cite[\S 9.1]{LamPyl}, have shown the following fact:

\begin{proposition}
\label{prop.g.symm}We have $g_{\lambda/\mu}\in\Lambda$ for every skew
partition $\lambda/\mu$.
\end{proposition}

\begin{vershort}
They prove this proposition using generalized plactic algebras \cite[Lemma
3.1]{FomGre} (and also give a second, combinatorial proof for the case
$\mu=\varnothing$ by explicitly expanding $g_{\lambda/\varnothing}$ as a sum
of Schur functions).
\end{vershort}

\begin{verlong}
They prove this fact using the Fomin--Greene machinery of generalized plactic
algebras \cite{FomGre}.\footnote{In \cite[\S 9.1]{LamPyl}, Lam and Pylyavskyy
claim to \textquotedblleft give two proofs\textquotedblright\ of Proposition
\ref{prop.g.symm}. As far as we can tell, this is slightly imprecise: They
only give one proof of Proposition \ref{prop.g.symm}, and then they give an
alternative proof of the particular case of Proposition \ref{prop.g.symm} when
$\mu=\varnothing$ (which actually gives an explicit expression of
$g_{\lambda/\varnothing}$ as a sum of Schur functions).}
\end{verlong}

In the next section, we shall introduce a refinement of these $g_{\lambda/\mu
}$, and later we will reprove Proposition \ref{prop.g.symm} in a
self-contained and elementary way.

\section{\label{sect.def}Refined dual stable Grothendieck polynomials}

\subsection{Definition}

We fix arbitrary elements $t_{1},t_{2},t_{3},\ldots$ of $\mathbf{k}$. (For
instance, $\mathbf{k}$ can be a polynomial ring in infinitely many variables
over another ring $\mathbf{m}$, and $t_{1},t_{2},t_{3},\ldots$ can then be
these variables.) For every weak composition $\alpha$, we set $\mathbf{t}%
^{\alpha}=t_{1}^{\alpha_{1}}t_{2}^{\alpha_{2}}t_{3}^{\alpha_{3}}\cdots
\in\mathbf{k}$.

\begin{vershort}
If $Z$ is a subset of $\mathbb{N}_{+}^{2}$, and if $T$ is a filling of $Z$,
then a \textit{stagnant cell} of $T$ will mean a cell $\left(  i,j\right)  $
of $Z$ such that $\left(  i+1,j\right)  $ is also a cell of $Z$ and satisfies
$T\left(  i,j\right)  =T\left(  i+1,j\right)  $. Notice that a semistandard
tableau is the same thing as an rpp which has no stagnant
cells\footnote{\textit{Proof.} Recall that the difference between a
semistandard tableau and an rpp is that the entries of a semistandard tableau
have to be strictly increasing down columns, whereas the entries of an rpp
have to be merely weakly increasing down columns. Thus, a semistandard tableau
is the same thing as an rpp whose every column has no adjacent equal entries.
In other words, a semistandard tableau is the same thing as an rpp which has
no stagnant cells (because having two adjacent equal entries in a column is
tantamount to having a stagnant cell).}.
\end{vershort}

\begin{verlong}
If $Z$ is a subset of $\mathbb{N}_{+}^{2}$, and if $T$ is a filling of $Z$,
then a \textit{stagnant cell} of $T$ will mean a cell $\left(  i,j\right)  $
of $Z$ such that $\left(  i+1,j\right)  $ is also a cell of $Z$ and satisfies
$T\left(  i,j\right)  =T\left(  i+1,j\right)  $. Notice that a semistandard
tableau is the same thing as an rpp which has no stagnant
cells\footnote{\textit{Proof.} First, let $T$ be a semistandard tableau. Then,
$T$ is a filling of a finite convex subset $Z$ of $\mathbb{N}_{+}^{2}$.
Consider this $Z$. The entries of $T$ are strictly increasing down columns
(since $T$ is a semistandard tableau). Hence, if $\left(  i,j\right)  $ is a
cell of $Z$ such that $\left(  i+1,j\right)  $ is also a cell of $Z$, then
$T\left(  i,j\right)  <T\left(  i+1,j\right)  $, and therefore we cannot have
$T\left(  i,j\right)  =T\left(  i+1,j\right)  $. Thus, $T$ has no stagnant
cells. Hence, $T$ is an rpp which has no stagnant cells.
\par
Let us now forget that we fixed $T$. We thus have shown that if $T$ is a
semistandard tableau, then $T$ is an rpp which has no stagnant cells. It thus
remains to prove the converse, i.e., to prove that if $T$ is an rpp which has
no stagnant cells, then $T$ is a semistandard tableau.
\par
So let $T$ be an rpp which has no stagnant cells. We need to show that $T$ is
a semistandard tableau. Notice that $T$ is a filling of a finite convex subset
$Z$ of $\mathbb{N}_{+}^{2}$. Consider this $Z$. We need to show that $T$ is a
semistandard tableau. It is clearly enough to prove that the entries of $T$
are strictly increasing down columns (since all other conditions in the
definition of a semistandard tableau follow from $T$ being an rpp). In order
to show this, it suffices to check that if $\left(  i,j\right)  $ is a cell of
$Z$ such that $\left(  i+1,j\right)  $ is also a cell of $Z$, then $T\left(
i,j\right)  <T\left(  i+1,j\right)  $. So let $\left(  i,j\right)  $ be a cell
of $Z$ such that $\left(  i+1,j\right)  $ is also a cell of $Z$. Then,
$T\left(  i,j\right)  \leq T\left(  i+1,j\right)  $ (since the entries of $T$
are weakly increasing down columns (since $T$ is an rpp)), but we cannot have
$T\left(  i,j\right)  =T\left(  i+1,j\right)  $ (since otherwise, $\left(
i,j\right)  $ would be a stagnant cell of $T$, but this would contradict the
fact that $T$ has no stagnant cells). Thus, $T\left(  i,j\right)  <T\left(
i+1,j\right)  $. This completes our proof.}.
\end{verlong}

If $Z$ is a subset of $\mathbb{N}_{+}^{2}$, and if $T$ is a filling of $Z$,
then we define a weak composition $\operatorname*{ceq}\left(  T\right)  $ by%
\begin{align}
&  \left(  \operatorname*{ceq}\left(  T\right)  \right)  _{i}=\left(
\text{the number of }j\in\mathbb{N}_{+}\text{ such that }\left(  i,j\right)
\text{ is a stagnant cell of }T\right) \label{eq.gtilde.ceq.def}\\
&  \ \ \ \ \ \ \ \ \ \ \text{for every }i\in\mathbb{N}_{+}.\nonumber
\end{align}
(Visually speaking, $\left(  \operatorname*{ceq}\left(  T\right)  \right)
_{i}$ is the number of columns of $T$ whose entry in the $i$-th row equals
their entry in the $\left(  i+1\right)  $-th row.) We call
$\operatorname*{ceq}\left(  T\right)  $ the \textit{column-equalities counter}
of $T$. Notice that%
\begin{equation}
\left\vert \operatorname*{ceq}\left(  T\right)  \right\vert =\left(  \text{the
number of all stagnant cells of }T\right)  \label{eq.gtilde.ceq.abs}%
\end{equation}
for every rpp $T$. For instance, if $T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 3 & 3 \\
%2 & 3 \\
%3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 3 & 3 \\
2 & 3 \\
3 & 4
\end{ytableau}%
%EndExpansion
$, then $\operatorname*{ceq}\left(  T\right)  =\left(  1,0,0,0,\ldots\right)
$ (since the $1$-st and $2$-nd rows of $T$ have equal entries in one column,
while for every $i>1$, the $i$-th and $\left(  i+1\right)  $-th rows of $T$ do
not have equal entries in any column).

\begin{verlong}
\begin{proof}
[Proof of (\ref{eq.gtilde.ceq.abs}).]Let $T$ be any rpp. The definition of
$\left\vert \operatorname*{ceq}\left(  T\right)  \right\vert $ yields%
\begin{align*}
\left\vert \operatorname*{ceq}\left(  T\right)  \right\vert  &  =\left(
\operatorname*{ceq}\left(  T\right)  \right)  _{1}+\left(  \operatorname*{ceq}%
\left(  T\right)  \right)  _{2}+\left(  \operatorname*{ceq}\left(  T\right)
\right)  _{3}+\cdots\\
&  =\sum_{i\in\mathbb{N}_{+}}\underbrace{\left(  \operatorname*{ceq}\left(
T\right)  \right)  _{i}}_{=\left(  \text{the number of }j\in\mathbb{N}%
_{+}\text{ such that }\left(  i,j\right)  \text{ is a stagnant cell of
}T\right)  }\\
&  =\sum_{i\in\mathbb{N}_{+}}\left(  \text{the number of }j\in\mathbb{N}%
_{+}\text{ such that }\left(  i,j\right)  \text{ is a stagnant cell of
}T\right) \\
&  =\left(  \text{the number of }\left(  i,j\right)  \in\mathbb{N}_{+}%
\times\mathbb{N}_{+}\text{ such that }\left(  i,j\right)  \text{ is a stagnant
cell of }T\right) \\
&  =\left(  \text{the number of all stagnant cells of }T\right)  .
\end{align*}
This proves (\ref{eq.gtilde.ceq.abs}).
\end{proof}
\end{verlong}

\begin{vershort}
Let now $\lambda/\mu$ be a skew partition. We set%
\[
\widetilde{g}_{\lambda/\mu}=\sum_{\substack{T\text{ is an rpp}\\\text{of shape
}Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }.
\]
This $\widetilde{g}_{\lambda/\mu}$ is a well-defined formal power series in
$\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]  \right]
$\ \ \ \ \footnote{\textit{Proof.} We need to show that the infinite sum
$\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }%
\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }$ converges with respect
to the standard topology on $\mathbf{k}\left[  \left[  x_{1},x_{2}%
,x_{3},\ldots\right]  \right]  $. In other words, we need to show that every
monomial $\mathbf{x}^{\alpha}$ occurs only finitely often in this sum. But
this is fairly clear: Given a monomial $\mathbf{x}^{\alpha}$, there exist only
finitely many $i\in\mathbb{N}_{+}$ satisfying $\alpha_{i}>0$. These finitely
many $i$ are the only entries that can occur in an rpp $T$ of shape $Y\left(
\lambda/\mu\right)  $ which satisfies $\operatorname*{ircont}\left(  T\right)
=\alpha$. Hence, there are only finitely many such rpps. This means that there
are only finitely many terms in the sum $\sum_{\substack{T\text{ is an
rpp}\\\text{of shape }Y\left(  \lambda/\mu\right)  }}\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{\operatorname*{ircont}%
\left(  T\right)  }$ in which the monomial $\mathbf{x}^{\alpha}$ occurs,
qed.}, and moreover belongs to $\mathbf{k}\left[  \left[  x_{1},x_{2}%
,x_{3},\ldots\right]  \right]  _{\operatorname*{bdd}}$ (since $\left\vert
\operatorname*{ircont}\left(  T\right)  \right\vert \leq\left\vert Y\left(
\lambda/\mu\right)  \right\vert =\left\vert \lambda\right\vert -\left\vert
\mu\right\vert $ for every rpp $T$ of shape $Y\left(  \lambda/\mu\right)  $).
\end{vershort}

\begin{verlong}
Let now $\lambda/\mu$ be a skew partition. We set%
\[
\widetilde{g}_{\lambda/\mu}=\sum_{\substack{T\text{ is an rpp}\\\text{of shape
}Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }.
\]
This $\widetilde{g}_{\lambda/\mu}$ is a well-defined formal power series in
$\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]  \right]
$\ \ \ \ \footnote{\textit{Proof.} We need to show that the infinite sum
$\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }%
\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }$ converges with respect
to the standard topology on $\mathbf{k}\left[  \left[  x_{1},x_{2}%
,x_{3},\ldots\right]  \right]  $. In other words, we need to show that every
monomial $\mathbf{x}^{\alpha}$ occurs only finitely often in the sum
$\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }%
\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }$. In other words, we
need to show that, for every weak composition $\alpha$, there exist only
finitely many rpps $T$ of shape $Y\left(  \lambda/\mu\right)  $ satisfying
$\operatorname*{ircont}\left(  T\right)  =\alpha$.
\par
Indeed, fix a weak composition $\alpha$. Let $S$ be the set of all
$i\in\mathbb{N}_{+}$ such that $\alpha_{i}\neq0$. Clearly, this set $S$ is
finite. Thus, there exist only finitely many maps from $Y\left(  \lambda
/\mu\right)  $ to $S$ (since $Y\left(  \lambda/\mu\right)  $ is also finite).
Therefore, there exist only finitely many rpps of shape $Y\left(  \lambda
/\mu\right)  $ whose entries belong to $S$ (because these rpps are maps from
$Y\left(  \lambda/\mu\right)  $ to $S$).
\par
Now, if $T$ is an rpp of shape $Y\left(  \lambda/\mu\right)  $ satisfying
$\operatorname*{ircont}\left(  T\right)  =\alpha$, then all entries of $T$
belong to $S$ (because if $i$ is an entry of $T$, then%
\begin{align*}
\alpha_{i}  &  =\left(  \operatorname*{ircont}\left(  T\right)  \right)
_{i}\ \ \ \ \ \ \ \ \ \ \left(  \text{since }\alpha=\operatorname*{ircont}%
\left(  T\right)  \right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ contains }i\right) \\
&  \neq0\ \ \ \ \ \ \ \ \ \ \left(  \text{since at least one column of
}T\text{ contains }i\text{ (because }i\text{ is an entry of }T\text{)}\right)
\end{align*}
and therefore $i\in S$ (by the definition of $S$)). Thus, every rpp of shape
$Y\left(  \lambda/\mu\right)  $ satisfying $\operatorname*{ircont}\left(
T\right)  =\alpha$ is an rpp of shape $Y\left(  \lambda/\mu\right)  $ whose
entries belong to $S$. But since there exist only finitely many rpps of shape
$Y\left(  \lambda/\mu\right)  $ whose entries belong to $S$, this yields that
there exist only finitely many rpps $T$ of shape $Y\left(  \lambda/\mu\right)
$ satisfying $\operatorname*{ircont}\left(  T\right)  =\alpha$. This completes
our proof.}, and moreover belongs to $\mathbf{k}\left[  \left[  x_{1}%
,x_{2},x_{3},\ldots\right]  \right]  _{\operatorname*{bdd}}$ (since
$\left\vert \operatorname*{ircont}\left(  T\right)  \right\vert \leq\left\vert
Y\left(  \lambda/\mu\right)  \right\vert =\left\vert \lambda\right\vert
-\left\vert \mu\right\vert $ for every rpp $T$ of shape $Y\left(  \lambda
/\mu\right)  $).
\end{verlong}

Let us give some examples of $\widetilde{g}_{\lambda/\mu}$.

\begin{example}
\label{exa.gtilde.1}\textbf{(a)} Let $n\in\mathbb{N}$, let $\lambda=\left(
n\right)  $ and let $\mu=\varnothing$. Then, the rpps $T$ of shape $Y\left(
\lambda/\mu\right)  $ have the form $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%a_1 & a_2 & \cdots& a_n
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
a_1 & a_2 & \cdots& a_n
\end{ytableau}%
%EndExpansion
$ with $a_{1}\leq a_{2}\leq\cdots\leq a_{n}$. Each such rpp $T$ satisfies
$\operatorname*{ceq}\left(  T\right)  =\varnothing$ and $\mathbf{x}%
^{\operatorname*{ircont}\left(  T\right)  }=x_{a_{1}}x_{a_{2}}\cdots x_{a_{n}%
}$. Thus, the definition of $\widetilde{g}_{\lambda/\mu}$ yields
\begin{align*}
\widetilde{g}_{\lambda/\mu}  &  =\sum_{\substack{T\text{ is an rpp}\\\text{of
shape }Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }=\sum
_{a_{1}\leq a_{2}\leq\cdots\leq a_{n}}\underbrace{\mathbf{t}^{\varnothing}%
}_{=1}x_{a_{1}}x_{a_{2}}\cdots x_{a_{n}}\\
&  =\sum_{a_{1}\leq a_{2}\leq\cdots\leq a_{n}}x_{a_{1}}x_{a_{2}}\cdots
x_{a_{n}}.
\end{align*}
This is the so-called $n$-th complete homogeneous symmetric function $h_{n}$.

\textbf{(b)} Let now $n\in\mathbb{N}$, let $\lambda=\underbrace{\left(
1,1,\ldots,1\right)  }_{n\text{ times}}$ and let $\mu=\varnothing$. Then, the
rpps $T$ of shape $Y\left(  \lambda/\mu\right)  $ have the form $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%a_1 \\
%a_2 \\
%\vdots\\
%a_n
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
a_1 \\
a_2 \\
\vdots\\
a_n
\end{ytableau}%
%EndExpansion
$ with $a_{1}\leq a_{2}\leq\cdots\leq a_{n}$. Each such rpp $T$ satisfies
$\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }=\prod_{\substack{i\in
\left\{  1,2,\ldots,n\right\}  ;\\a_{i}=a_{i+1}}}t_{i}$ and $\mathbf{x}%
^{\operatorname*{ircont}\left(  T\right)  }=\prod_{\substack{i\in\left\{
1,2,\ldots,n\right\}  ;\\a_{i}<a_{i+1}}}x_{i}$, where we set $a_{n+1}=\infty$
in order to simplify our notations. Thus, the definition of $\widetilde{g}%
_{\lambda/\mu}$ yields
\begin{align*}
\widetilde{g}_{\lambda/\mu}  &  =\sum_{\substack{T\text{ is an rpp}\\\text{of
shape }Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }=\sum
_{a_{1}\leq a_{2}\leq\cdots\leq a_{n}}\left(  \prod_{\substack{i\in\left\{
1,2,\ldots,n\right\}  ;\\a_{i}=a_{i+1}}}t_{i}\right)  \left(  \prod
_{\substack{i\in\left\{  1,2,\ldots,n\right\}  ;\\a_{i}<a_{i+1}}}x_{i}\right)
\\
&  =\sum_{k=0}^{n}e_{k}\left(  t_{1},t_{2},\ldots,t_{n-1}\right)
e_{n-k}\left(  x_{1},x_{2},x_{3},\ldots\right)  ,
\end{align*}
where $e_{i}\left(  \xi_{1},\xi_{2},\xi_{3},\ldots\right)  $ denotes the
$i$-th elementary symmetric function in the indeterminates $\xi_{1},\xi
_{2},\xi_{3},\ldots$. It is possible to rewrite this as%
\[
\widetilde{g}_{\lambda/\mu}=e_{n}\left(  t_{1},t_{2},\ldots,t_{n-1}%
,x_{1},x_{2},x_{3},\ldots\right)  .
\]


\textbf{(c)} Let now $n=3$, let $\lambda=\left(  2,1\right)  $ and let
$\mu=\varnothing$. Then, the rpps $T$ of shape $Y\left(  \lambda/\mu\right)  $
have the form $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%a & b \\
%c
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
a & b \\
c
\end{ytableau}%
%EndExpansion
$ with $a\leq b$ and $a\leq c$. Each such rpp $T$ satisfies $\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }=\left\{
\begin{array}
[c]{c}%
1,\text{ if }a<c;\\
t_{1},\text{ if }a=c
\end{array}
\right.  $ and $\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }=\left\{
%
\begin{array}
[c]{c}%
x_{a}x_{b}x_{c},\ \text{if }a<c;\\
x_{a}x_{b},\ \text{if }a=c
\end{array}
\right.  $. Thus,%
\begin{align*}
\widetilde{g}_{\lambda/\mu}  &  =\sum_{\substack{T\text{ is an rpp}\\\text{of
shape }Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }=\sum_{a\leq
b;\ a\leq c}\left\{
\begin{array}
[c]{c}%
1,\text{ if }a<c;\\
t_{1},\text{ if }a=c
\end{array}
\right.  \left\{
\begin{array}
[c]{c}%
x_{a}x_{b}x_{c},\ \text{if }a<c;\\
x_{a}x_{b},\ \text{if }a=c
\end{array}
\right. \\
&  =\sum_{a\leq b;\ a<c}x_{a}x_{b}x_{c}+t_{1}\sum_{a\leq b}x_{a}x_{b}.
\end{align*}

\end{example}

The power series $\widetilde{g}_{\lambda/\mu}$ generalize the power series
$g_{\lambda/\mu}$ and $s_{\lambda/\mu}$ studied before:

\begin{proposition}
\label{prop.gtilde.gener}Let $\lambda/\mu$ be a skew partition.

\textbf{(a)} If $\left(  t_{1},t_{2},t_{3},\ldots\right)  =\left(
1,1,1,\ldots\right)  $, then $\widetilde{g}_{\lambda/\mu}=g_{\lambda/\mu}$.

\textbf{(b)} If $\left(  t_{1},t_{2},t_{3},\ldots\right)  =\left(
0,0,0,\ldots\right)  $, then $\widetilde{g}_{\lambda/\mu}=s_{\lambda/\mu}$.
\end{proposition}

\begin{proof}
[Proof of Proposition \ref{prop.gtilde.gener}.]\textbf{(a)} Let $\left(
t_{1},t_{2},t_{3},\ldots\right)  =\left(  1,1,1,\ldots\right)  $. Then,
$\mathbf{t}^{\alpha}=1$ for every weak composition $\alpha$. Thus,
$\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }=1$ for every rpp $T$. Now,
the definition of $\widetilde{g}_{\lambda/\mu}$ yields $\widetilde{g}%
_{\lambda/\mu}=\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(
\lambda/\mu\right)  }}\underbrace{\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }}_{=1}\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }%
=\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  }}\mathbf{x}^{\operatorname*{ircont}\left(  T\right)
}=g_{\lambda/\mu}$. This proves Proposition \ref{prop.gtilde.gener}
\textbf{(a)}.

\begin{vershort}
\textbf{(b)} Let $\left(  t_{1},t_{2},t_{3},\ldots\right)  =\left(
0,0,0,\ldots\right)  $. Then, if $T$ is an rpp which has at least one stagnant
cell, then $\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }=0$ (because
$\operatorname*{ceq}\left(  T\right)  $ has at least one nonzero entry in this
case). Therefore, the sum $\sum_{\substack{T\text{ is an rpp}\\\text{of shape
}Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }$ does not
change if we discard all addends for which $T$ has at least one stagnant cell.
Thus,%
\begin{align*}
\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }%
\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }  &  =\sum
_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda/\mu\right)
;\\T\text{ has no stagnant cells}}}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }\\
&  =\sum_{\substack{T\text{ is a semistandard}\\\text{tableau of shape
}Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }%
\end{align*}
(since a semistandard tableau of shape $Y\left(  \lambda/\mu\right)  $ is the
same thing as an rpp of shape $Y\left(  \lambda/\mu\right)  $ which has no
stagnant cells). Now, the definition of $\widetilde{g}_{\lambda/\mu}$ yields%
\begin{align*}
\widetilde{g}_{\lambda/\mu}  &  =\sum_{\substack{T\text{ is an rpp}\\\text{of
shape }Y\left(  \lambda/\mu\right)  }}\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }%
=\sum_{\substack{T\text{ is a semistandard}\\\text{tableau of shape }Y\left(
\lambda/\mu\right)  }}\underbrace{\mathbf{t}^{\operatorname*{ceq}\left(
T\right)  }}_{\substack{=1\\\text{(since }\operatorname*{ceq}\left(  T\right)
=\varnothing\text{)}}}\underbrace{\mathbf{x}^{\operatorname*{ircont}\left(
T\right)  }}_{\substack{=\mathbf{x}^{\operatorname*{cont}\left(  T\right)
}\\\text{(by (\ref{eq.ircont=cont}))}}}\\
&  =\sum_{\substack{T\text{ is a semistandard}\\\text{tableau of shape
}Y\left(  \lambda/\mu\right)  }}\mathbf{x}^{\operatorname*{cont}\left(
T\right)  }=s_{\lambda/\mu}.
\end{align*}

\end{vershort}

\begin{verlong}
\textbf{(b)} We shall use the \textit{Iverson bracket notation}: Whenever
$\mathcal{A}$ is a logical statement, we let $\left[  \mathcal{A}\right]  $
denote the truth value of $\mathcal{A}$ (that is, the integer $\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }\mathcal{A}\text{ is true;}\\
0,\ \ \ \ \ \ \ \ \ \ \text{if }\mathcal{A}\text{ is false}%
\end{array}
\right.  $).

Let $\left(  t_{1},t_{2},t_{3},\ldots\right)  =\left(  0,0,0,\ldots\right)  $.
Then,
\begin{align*}
\mathbf{t}^{\alpha}  &  =t_{1}^{\alpha_{1}}t_{2}^{\alpha_{2}}t_{3}^{\alpha
_{3}}\cdots=0^{\alpha_{1}}0^{\alpha_{2}}0^{\alpha_{3}}\cdots
\ \ \ \ \ \ \ \ \ \ \left(  \text{since }\left(  t_{1},t_{2},t_{3}%
,\ldots\right)  =\left(  0,0,0,\ldots\right)  \right) \\
&  =0^{\alpha_{1}+\alpha_{2}+\alpha_{3}+\cdots}=0^{\left\vert \alpha
\right\vert }\ \ \ \ \ \ \ \ \ \ \left(  \text{since }\alpha_{1}+\alpha
_{2}+\alpha_{3}+\cdots=\left\vert \alpha\right\vert \right) \\
&  =\left[  \left\vert \alpha\right\vert =0\right]
\end{align*}
for every weak composition $\alpha$. Hence, if $T$ is an rpp of shape
$Y\left(  \lambda/\mu\right)  $, then%
\begin{align*}
\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }  &  =\left[  \left\vert
\operatorname*{ceq}T\right\vert =0\right] \\
&  =\left[  \left(  \text{the number of all stagnant cells of }T\right)
=0\right]  \ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{eq.gtilde.ceq.abs}%
)}\right) \\
&  =\left[  T\text{ has no stagnant cells}\right]  .
\end{align*}
Now, the definition of $\widetilde{g}_{\lambda/\mu}$ yields%
\begin{align*}
\widetilde{g}_{\lambda/\mu}  &  =\sum_{\substack{T\text{ is an rpp}\\\text{of
shape }Y\left(  \lambda/\mu\right)  }}\underbrace{\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }}_{=\left[  T\text{ has no stagnant
cells}\right]  }\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }\\
&  =\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  }}\left[  T\text{ has no stagnant cells}\right]  \mathbf{x}%
^{\operatorname*{ircont}\left(  T\right)  }\\
&  =\sum_{\substack{T\text{ is an rpp}\\\text{of shape }Y\left(  \lambda
/\mu\right)  ;\\T\text{ has no stagnant cells}}}\mathbf{x}%
^{\operatorname*{ircont}\left(  T\right)  }=\sum_{\substack{T\text{ is a
semistandard}\\\text{tableau of shape }Y\left(  \lambda/\mu\right)
}}\underbrace{\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }%
}_{\substack{=\mathbf{x}^{\operatorname*{cont}\left(  T\right)  }%
\\\text{(since }\operatorname*{ircont}\left(  T\right)  =\operatorname*{cont}%
\left(  T\right)  \\\text{whenever }T\text{ is a semistandard}%
\\\text{tableau)}}}\\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since a semistandard tableau of shape }Y\left(  \lambda/\mu\right)
\text{ is the same}\\
\text{thing as an rpp of shape }Y\left(  \lambda/\mu\right)  \text{ which has
no stagnant cells}%
\end{array}
\right) \\
&  =\sum_{\substack{T\text{ is a semistandard}\\\text{tableau of shape
}Y\left(  \lambda/\mu\right)  }}\mathbf{x}^{\operatorname*{cont}\left(
T\right)  }=s_{\lambda/\mu}.
\end{align*}


This proves Proposition \ref{prop.gtilde.gener} \textbf{(b)}.
\end{verlong}
\end{proof}

\subsection{The symmetry statement}

Our main result is now the following:

\begin{theorem}
\label{thm.gtilde.symm}Let $\lambda/\mu$ be a skew partition. Then,
$\widetilde{g}_{\lambda/\mu}\in\Lambda$.
\end{theorem}

It is clear that Proposition \ref{prop.schur.symm} and Proposition
\ref{prop.g.symm} are particular cases of Theorem \ref{thm.gtilde.symm} (due
to Proposition \ref{prop.gtilde.gener}).

We shall prove Theorem \ref{thm.gtilde.symm} bijectively. The core of our
proof will be the following fact:

\begin{theorem}
\label{thm.BK}Let $\lambda/\mu$ be a skew partition. Let $i\in\mathbb{N}_{+}$.
Let $\operatorname*{RPP}\left(  \lambda/\mu\right)  $ denote the set of all
rpps of shape $Y\left(  \lambda/\mu\right)  $. Then, there exists an
involution $\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)
\rightarrow\operatorname*{RPP}\left(  \lambda/\mu\right)  $ which has the
following property: For every $T\in\operatorname*{RPP}\left(  \lambda
/\mu\right)  $, we have%
\begin{equation}
\operatorname*{ceq}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
=\operatorname*{ceq}\left(  T\right)  \label{eq.thm.BK.ceq}%
\end{equation}
and%
\begin{equation}
\operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
=s_{i}\cdot\operatorname*{ircont}\left(  T\right)  . \label{eq.thm.BK.ircont}%
\end{equation}
\footnotemark(Here, $s_{i}\cdot\operatorname*{ircont}\left(  T\right)  $ means
the result of the transposition $s_{i}=\left(  i,i+1\right)  \in
\mathfrak{S}_{\left(  \infty\right)  }$ acting on the weak composition
$\operatorname*{ircont}\left(  T\right)  $.)
\end{theorem}

\footnotetext{We notice that the equality (\ref{eq.thm.BK.ircont}) says the
following:
\par
\begin{itemize}
\item The number of columns of $\mathbf{B}_{i}\left(  T\right)  $ containing
the entry $i$ equals the number of columns of $T$ containing the entry $i+1$.
\par
\item The number of columns of $\mathbf{B}_{i}\left(  T\right)  $ containing
the entry $i+1$ equals the number of columns of $T$ containing the entry $i$.
\par
\item For every $h\in\mathbb{N}_{+}\setminus\left\{  i,i+1\right\}  $, the
number of columns of $\mathbf{B}_{i}\left(  T\right)  $ containing the entry
$h$ equals the number of columns of $T$ containing the entry $h$.
\end{itemize}
}This involution $\mathbf{B}_{i}$ is a generalization of the $i$-th
Bender-Knuth involution defined for semistandard tableaux (see, e.g.,
\cite[proof of Proposition 2.11]{GriRei15}), but its definition is more
complicated than that of the latter.\footnote{We will compare our involution
$\mathbf{B}_{i}$ with the $i$-th Bender-Knuth involution in Section
\ref{sect.BKclassical}.} Defining it and proving its properties will take a
significant part of this paper.

Let us first see how Theorem \ref{thm.BK} implies Theorem
\ref{thm.gtilde.symm}:

\begin{proof}
[Proof of Theorem \ref{thm.gtilde.symm} using Theorem \ref{thm.BK}.]We know
that $\widetilde{g}_{\lambda/\mu}\in\mathbf{k}\left[  \left[  x_{1}%
,x_{2},x_{3},\ldots\right]  \right]  _{\operatorname*{bdd}}$. Hence, in order
to prove that $\widetilde{g}_{\lambda/\mu}\in\Lambda$, it is enough to prove
that $\widetilde{g}_{\lambda/\mu}$ is invariant under the action of
$\mathfrak{S}_{\left(  \infty\right)  }$ (since $\Lambda=\left(
\mathbf{k}\left[  \left[  x_{1},x_{2},x_{3},\ldots\right]  \right]
_{\operatorname*{bdd}}\right)  ^{\mathfrak{S}_{\left(  \infty\right)  }}$). To
show this, it is enough to prove that $\widetilde{g}_{\lambda/\mu}$ is
invariant under the action of $s_{i}\in\mathfrak{S}_{\left(  \infty\right)  }$
for every $i\in\mathbb{N}_{+}$ (because the group $\mathfrak{S}_{\left(
\infty\right)  }$ is generated by the subset $\left\{  s_{1},s_{2}%
,s_{3},\ldots\right\}  $). In other words, it is enough to prove that
$s_{i}\cdot\widetilde{g}_{\lambda/\mu}=\widetilde{g}_{\lambda/\mu}$ for every
$i\in\mathbb{N}_{+}$. So let us prove this.

\begin{vershort}
Fix $i\in\mathbb{N}_{+}$. Theorem \ref{thm.BK} gives us an involution
$\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)  \rightarrow
\operatorname*{RPP}\left(  \lambda/\mu\right)  $ satisfying the property
described in Theorem \ref{thm.BK}. Now, the definition of $\widetilde{g}%
_{\lambda/\mu}$ yields $\widetilde{g}_{\lambda/\mu}=\sum_{T\in
\operatorname*{RPP}\left(  \lambda/\mu\right)  }\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{\operatorname*{ircont}%
\left(  T\right)  }$, so that%
\[
s_{i}\cdot\widetilde{g}_{\lambda/\mu}=\sum_{T\in\operatorname*{RPP}\left(
\lambda/\mu\right)  }\mathbf{t}^{\operatorname*{ceq}\left(  T\right)
}\underbrace{\left(  s_{i}\cdot\mathbf{x}^{\operatorname*{ircont}\left(
T\right)  }\right)  }_{=\mathbf{x}^{s_{i}\cdot\operatorname*{ircont}\left(
T\right)  }}=\sum_{T\in\operatorname*{RPP}\left(  \lambda/\mu\right)
}\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{s_{i}%
\cdot\operatorname*{ircont}\left(  T\right)  }.
\]
Compared with%
\begin{align*}
\widetilde{g}_{\lambda/\mu}  &  =\sum_{T\in\operatorname*{RPP}\left(
\lambda/\mu\right)  }\mathbf{t}^{\operatorname*{ceq}\left(  T\right)
}\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }=\sum_{T\in
\operatorname*{RPP}\left(  \lambda/\mu\right)  }\underbrace{\mathbf{t}%
^{\operatorname*{ceq}\left(  \mathbf{B}_{i}\left(  T\right)  \right)  }%
}_{\substack{=\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }\\\text{(by
(\ref{eq.thm.BK.ceq}))}}}\underbrace{\mathbf{x}^{\operatorname*{ircont}\left(
\mathbf{B}_{i}\left(  T\right)  \right)  }}_{\substack{=\mathbf{x}^{s_{i}%
\cdot\operatorname*{ircont}\left(  T\right)  }\\\text{(by
(\ref{eq.thm.BK.ircont}))}}}\\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{here, we have substituted }\mathbf{B}_{i}\left(  T\right)  \text{ for
}T\text{ in the sum}\\
\text{(since }\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)
\rightarrow\operatorname*{RPP}\left(  \lambda/\mu\right)  \text{ is a
bijection)}%
\end{array}
\right) \\
&  =\sum_{T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  }\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{s_{i}\cdot
\operatorname*{ircont}\left(  T\right)  },
\end{align*}
this yields $s_{i}\cdot\widetilde{g}_{\lambda/\mu}=\widetilde{g}_{\lambda/\mu
}$, and this completes our proof.
\end{vershort}

\begin{verlong}
Fix $i\in\mathbb{N}_{+}$. Theorem \ref{thm.BK} gives us an involution
$\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)  \rightarrow
\operatorname*{RPP}\left(  \lambda/\mu\right)  $ satisfying the property
described in Theorem \ref{thm.BK}. This involution $\mathbf{B}_{i}$ is clearly
a bijection. Now, the definition of $\widetilde{g}_{\lambda/\mu}$ yields
$\widetilde{g}_{\lambda/\mu}=\underbrace{\sum_{\substack{T\text{ is an
rpp}\\\text{of shape }Y\left(  \lambda/\mu\right)  }}}_{=\sum_{T\in
\operatorname*{RPP}\left(  \lambda/\mu\right)  }}\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{\operatorname*{ircont}%
\left(  T\right)  }=\sum_{T\in\operatorname*{RPP}\left(  \lambda/\mu\right)
}\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}%
^{\operatorname*{ircont}\left(  T\right)  }$, so that%
\begin{align*}
s_{i}\cdot\widetilde{g}_{\lambda/\mu}  &  =s_{i}\cdot\left(  \sum
_{T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  }\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{\operatorname*{ircont}%
\left(  T\right)  }\right)  =\sum_{T\in\operatorname*{RPP}\left(  \lambda
/\mu\right)  }\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }%
\underbrace{\left(  s_{i}\cdot\mathbf{x}^{\operatorname*{ircont}\left(
T\right)  }\right)  }_{=\mathbf{x}^{s_{i}\cdot\operatorname*{ircont}\left(
T\right)  }}\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since the action of }s_{i}\in
\mathfrak{S}_{\left(  \infty\right)  }\text{ on }\mathbf{k}\left[  \left[
x_{1},x_{2},x_{3},\ldots\right]  \right]  \text{ is }\mathbf{k}\text{-linear}%
\right) \\
&  =\sum_{T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  }\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{s_{i}\cdot
\operatorname*{ircont}\left(  T\right)  }.
\end{align*}
Compared with%
\begin{align*}
\widetilde{g}_{\lambda/\mu}  &  =\sum_{T\in\operatorname*{RPP}\left(
\lambda/\mu\right)  }\mathbf{t}^{\operatorname*{ceq}\left(  T\right)
}\mathbf{x}^{\operatorname*{ircont}\left(  T\right)  }=\sum_{T\in
\operatorname*{RPP}\left(  \lambda/\mu\right)  }\underbrace{\mathbf{t}%
^{\operatorname*{ceq}\left(  \mathbf{B}_{i}\left(  T\right)  \right)  }%
}_{\substack{=\mathbf{t}^{\operatorname*{ceq}\left(  T\right)  }\\\text{(by
(\ref{eq.thm.BK.ceq}))}}}\underbrace{\mathbf{x}^{\operatorname*{ircont}\left(
\mathbf{B}_{i}\left(  T\right)  \right)  }}_{\substack{=\mathbf{x}^{s_{i}%
\cdot\operatorname*{ircont}\left(  T\right)  }\\\text{(by
(\ref{eq.thm.BK.ircont}))}}}\\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{here, we have substituted }\mathbf{B}_{i}\left(  T\right)  \text{ for
}T\text{ in the sum}\\
\text{(since }\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)
\rightarrow\operatorname*{RPP}\left(  \lambda/\mu\right)  \text{ is a
bijection)}%
\end{array}
\right) \\
&  =\sum_{T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  }\mathbf{t}%
^{\operatorname*{ceq}\left(  T\right)  }\mathbf{x}^{s_{i}\cdot
\operatorname*{ircont}\left(  T\right)  },
\end{align*}
this yields $s_{i}\cdot\widetilde{g}_{\lambda/\mu}=\widetilde{g}_{\lambda/\mu
}$, and this completes our proof.
\end{verlong}
\end{proof}

\subsection{Reduction to 12-rpps}

We shall make one further simplification before we step to the actual proof of
Theorem \ref{thm.BK}.

We define a \textit{12-rpp} to be an rpp whose entries all belong to the set
$\left\{  1,2\right\}  $. For instance, $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 1 & 2 \\
%\none& \none& 1 & 2 & 2 \\
%\none& 1 & 2 & 2 \\
%1 & 1 & 2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 1 & 2 \\
\none& \none& 1 & 2 & 2 \\
\none& 1 & 2 & 2 \\
1 & 1 & 2
\end{ytableau}%
%EndExpansion
$ is a 12-rpp of shape $\left(  5,5,4,3\right)  /\left(  2,2,1\right)  $.

Clearly, every column of a 12-rpp is a sequence of $1$'s followed by a
sequence of $2$'s (where each of these sequences can be empty). The same holds
for every row of a 12-rpp.

We now claim:

\begin{lemma}
\label{lem.BK}Let $Z$ be a finite convex subset of $\mathbb{N}_{+}^{2}$. Let
$\mathbf{R}$ denote the set of all 12-rpps of shape $Z$. Then, there exists an
involution $\mathbf{B}:\mathbf{R}\rightarrow\mathbf{R}$ (defined canonically
in terms of $Z$) which has the following property: For every $S\in\mathbf{R}$,
the equalities%
\begin{equation}
\operatorname*{ceq}\left(  \mathbf{B}\left(  S\right)  \right)
=\operatorname*{ceq}\left(  S\right)  \label{eq.lem.BK.ceq}%
\end{equation}
and%
\begin{equation}
\operatorname*{ircont}\left(  \mathbf{B}\left(  S\right)  \right)  =s_{1}%
\cdot\operatorname*{ircont}\left(  S\right)  \label{eq.lem.BK.ircont}%
\end{equation}
hold.
\end{lemma}

Before we prove this lemma, we will show how Theorem \ref{thm.BK} can be
derived from this lemma. But first of all, let us rewrite the lemma as follows:

\begin{lemma}
\label{lem.BKi}Let $Z$ be a finite convex subset of $\mathbb{N}_{+}^{2}$. Let
$i\in\mathbb{N}_{+}$. Let $\mathbf{R}_{Z}$ denote the set of all rpps of shape
$Z$ whose entries all belong to the set $\left\{  i,i+1\right\}  $. Then,
there exists an involution $\mathbf{B}_{Z}:\mathbf{R}_{Z}\rightarrow
\mathbf{R}_{Z}$ (defined canonically in terms of $Z$) which has the following
property: For every $P\in\mathbf{R}_{Z}$, the equalities%
\begin{equation}
\operatorname*{ceq}\left(  \mathbf{B}_{Z}\left(  P\right)  \right)
=\operatorname*{ceq}\left(  P\right)  \label{eq.lem.BKi.ceq}%
\end{equation}
and%
\begin{equation}
\operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(  P\right)  \right)
=s_{i}\cdot\operatorname*{ircont}\left(  P\right)  \label{eq.lem.BKi.ircont}%
\end{equation}
hold.
\end{lemma}

\begin{vershort}
\begin{proof}
[Proof of Lemma \ref{lem.BKi} using Lemma \ref{lem.BK}.]The only difference
between Lemma \ref{lem.BK} and Lemma \ref{lem.BKi} is that the entries $1$ and
$2$ in Lemma \ref{lem.BK} have been relabelled as $i$ and $i+1$ in Lemma
\ref{lem.BKi}. Thus, the two lemmas are equivalent, so that the latter follows
from the former.

(More formally: Define $\mathbf{R}$ as in Lemma \ref{lem.BK}. Then, we can
define a bijection $\Phi:\mathbf{R}\rightarrow\mathbf{R}_{Z}$ as follows: For
every $T\in\mathbf{R}$, let $\Phi\left(  T\right)  $ be the filling of $Z$
which is obtained from $T$ by replacing all $1$'s and $2$'s by $i$'s and
$\left(  i+1\right)  $'s, respectively. Now, an involution $\mathbf{B}_{Z}$
satisfying the claim of Lemma \ref{lem.BKi} can be constructed from an
involution $\mathbf{B}$ satisfying the claim of Lemma \ref{lem.BK} by the
formula $\mathbf{B}_{Z}=\Phi\circ\mathbf{B}\circ\Phi^{-1}$.)
\end{proof}
\end{vershort}

\begin{verlong}
\begin{proof}
[Proof of Lemma \ref{lem.BKi} using Lemma \ref{lem.BK}.]Define $\mathbf{R}$ as
in Lemma \ref{lem.BK}. Then, we can define a bijection $\Phi:\mathbf{R}%
\rightarrow\mathbf{R}_{Z}$ as follows: For every $T\in\mathbf{R}$, let
$\Phi\left(  T\right)  $ be the filling of $Z$ which is obtained from $T$ by
replacing all $1$'s and $2$'s by $i$'s and $\left(  i+1\right)  $'s,
respectively. This is clearly well-defined (since $i$ and $i+1$ have the same
relative order as $1$ and $2$).

Every $T\in\mathbf{R}$ satisfies%
\begin{equation}
\operatorname*{ceq}\left(  \Phi\left(  T\right)  \right)  =\operatorname*{ceq}%
\left(  T\right)  \label{pf.lem.BKi.ceq}%
\end{equation}
\footnote{\textit{Proof of (\ref{pf.lem.BKi.ceq}):} Let $T\in\mathbf{R}$. The
filling $\Phi\left(  T\right)  $ is obtained from $T$ simply by replacing all
$1$'s and $2$'s by $i$'s and $\left(  i+1\right)  $'s, respectively (because
this is how $\Phi\left(  T\right)  $ was defined). Hence, the stagnant cells
of $\Phi\left(  T\right)  $ are precisely the stagnant cells of $T$ (because
all entries of $T$ are $1$'s and $2$'s). Thus, for every $i\in\mathbb{N}_{+}$,
we have $\left(  \operatorname*{ceq}\left(  \Phi\left(  T\right)  \right)
\right)  _{i}=\left(  \operatorname*{ceq}\left(  T\right)  \right)  _{i}$
(because of how $\left(  \operatorname*{ceq}\left(  \Phi\left(  T\right)
\right)  \right)  _{i}$ and $\left(  \operatorname*{ceq}\left(  T\right)
\right)  _{i}$ were defined in terms of stagnant cells). In other words,
$\operatorname*{ceq}\left(  \Phi\left(  T\right)  \right)
=\operatorname*{ceq}\left(  T\right)  $. This proves (\ref{pf.lem.BKi.ceq}).}
and%
\begin{equation}
\left(  \operatorname*{ircont}\left(  \Phi\left(  T\right)  \right)  \right)
_{i}=\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{1}
\label{pf.lem.BKi.ircont1}%
\end{equation}
\footnote{\textit{Proof of (\ref{pf.lem.BKi.ircont1}):} Let $T\in\mathbf{R}$.
Recall that $\Phi\left(  T\right)  $ is the filling of $Z$ which is obtained
from $T$ by replacing all $1$'s and $2$'s by $i$'s and $\left(  i+1\right)
$'s, respectively. Since all entries of $T$ are $1$'s and $2$'s, this has the
following consequence: The cells which contain the entry $i$ in $\Phi\left(
T\right)  $ are precisely the cells which contain the entry $1$ in $T$. Hence,%
\begin{align*}
&  \left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\Phi\left(  T\right)  \text{ contains }i\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ contains }1\right)  .
\end{align*}
But now, the definition of $\left(  \operatorname*{ircont}\left(  \Phi\left(
T\right)  \right)  \right)  _{i}$ yields%
\begin{align*}
\left(  \operatorname*{ircont}\left(  \Phi\left(  T\right)  \right)  \right)
_{i}  &  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\Phi\left(  T\right)  \text{ contains }i\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ contains }1\right) \\
&  =\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{1}%
\end{align*}
(since $\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{1}$ was
defined as \newline$\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such
that the }k\text{-th column of }T\text{ contains }1\right)  $). This proves
(\ref{pf.lem.BKi.ircont1}).} and%
\begin{equation}
\left(  \operatorname*{ircont}\left(  \Phi\left(  T\right)  \right)  \right)
_{i+1}=\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{2}
\label{pf.lem.BKi.ircont2}%
\end{equation}
\footnote{\textit{Proof of (\ref{pf.lem.BKi.ircont2}):} The proof of
(\ref{pf.lem.BKi.ircont2}) can be obtained from the above proof of
(\ref{pf.lem.BKi.ircont1}) by replacing all appearances of \textquotedblleft%
$i$\textquotedblright\ and of \textquotedblleft$1$\textquotedblright%
\ (beginning from the fourth sentence)\ by \textquotedblleft$i+1$%
\textquotedblright\ and \textquotedblleft$2$\textquotedblright, respectively.}%
. Finally, every $T\in\mathbf{R}$ and $h\in\mathbb{N}_{+}\setminus\left\{
i,i+1\right\}  $ satisfy%
\begin{equation}
\left(  \operatorname*{ircont}\left(  \Phi\left(  T\right)  \right)  \right)
_{h}=0. \label{pf.lem.BKi.ircont3}%
\end{equation}
\footnote{\textit{Proof of (\ref{pf.lem.BKi.ircont3}):} Let $T\in\mathbf{R}$
and $h\in\mathbb{N}_{+}\setminus\left\{  i,i+1\right\}  $. Recall that
$\Phi\left(  T\right)  $ is the filling of $Z$ which is obtained from $T$ by
replacing all $1$'s and $2$'s by $i$'s and $\left(  i+1\right)  $'s,
respectively. Thus, all entries of $\Phi\left(  T\right)  $ are $i$'s and
$\left(  i+1\right)  $'s (because all entries of $T$ are $1$'s and $2$'s).
Hence, no entry of $\Phi\left(  T\right)  $ equals $h$ (since $h\notin\left\{
i,i+1\right\}  $). Thus, no column of $\Phi\left(  T\right)  $ contains $h$.
Now, the definition of $\left(  \operatorname*{ircont}\left(  \Phi\left(
T\right)  \right)  \right)  _{h}$ yields
\begin{align*}
\left(  \operatorname*{ircont}\left(  \Phi\left(  T\right)  \right)  \right)
_{h}  &  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\Phi\left(  T\right)  \text{ contains }h\right) \\
&  =0\ \ \ \ \ \ \ \ \ \ \left(  \text{since no column of }\Phi\left(
T\right)  \text{ contains }h\right)  .
\end{align*}
This proves (\ref{pf.lem.BKi.ircont3}).}

Now, Lemma \ref{lem.BK} yields the existence of an involution $\mathbf{B}%
:\mathbf{R}\rightarrow\mathbf{R}$ (defined canonically in terms of $Z$) which
has the property that, for every $S\in\mathbf{R}$, the equalities
(\ref{eq.lem.BK.ceq}) and (\ref{eq.lem.BK.ircont}) hold. Consider this
involution $\mathbf{B}$. Now, we define a map $\mathbf{B}_{Z}:\mathbf{R}%
_{Z}\rightarrow\mathbf{R}_{Z}$ by $\mathbf{B}_{Z}=\Phi\circ\mathbf{B}\circ
\Phi^{-1}$. This map $\mathbf{B}_{Z}$ is clearly defined canonically in terms
of $Z$, and is an involution\footnote{\textit{Proof.} We have $\mathbf{B}%
\circ\mathbf{B}=\operatorname*{id}$ (since $\mathbf{B}$ is an involution).
Now, using $\mathbf{B}_{Z}=\Phi\circ\mathbf{B}\circ\Phi^{-1}$, we obtain%
\begin{align*}
\mathbf{B}_{Z}\circ\mathbf{B}_{Z}  &  =\left(  \Phi\circ\mathbf{B}\circ
\Phi^{-1}\right)  \circ\left(  \Phi\circ\mathbf{B}\circ\Phi^{-1}\right)
=\Phi\circ\mathbf{B}\circ\underbrace{\Phi^{-1}\circ\Phi}_{=\operatorname*{id}%
}\circ\mathbf{B}\circ\Phi^{-1}\\
&  =\Phi\circ\underbrace{\mathbf{B}\circ\mathbf{B}}_{=\operatorname*{id}}%
\circ\Phi^{-1}=\Phi\circ\Phi^{-1}=\operatorname*{id}.
\end{align*}
Thus, $\mathbf{B}_{Z}$ is an involution, qed.}. Now, in order to prove Lemma
\ref{lem.BKi}, it remains to show that this map $\mathbf{B}_{Z}$ has the
property that, for every $P\in\mathbf{R}_{Z}$, the equalities
(\ref{eq.lem.BKi.ceq}) and (\ref{eq.lem.BKi.ircont}) hold.

So, let us fix a $P\in\mathbf{R}_{Z}$. Let $S=\Phi^{-1}\left(  P\right)  $.
Then, $\Phi\left(  S\right)  =P$ and $\underbrace{\mathbf{B}_{Z}}_{=\Phi
\circ\mathbf{B}\circ\Phi^{-1}}\left(  P\right)  =\left(  \Phi\circ
\mathbf{B}\circ\Phi^{-1}\right)  \left(  P\right)  =\Phi\left(  \mathbf{B}%
\left(  \underbrace{\Phi^{-1}\left(  P\right)  }_{=S}\right)  \right)
=\Phi\left(  \mathbf{B}\left(  S\right)  \right)  $. Also,
(\ref{pf.lem.BKi.ceq}) (applied to $T=S$) yields $\operatorname*{ceq}\left(
\Phi\left(  S\right)  \right)  =\operatorname*{ceq}\left(  S\right)  $. Hence,
$\operatorname*{ceq}\left(  S\right)  =\operatorname*{ceq}\left(
\underbrace{\Phi\left(  S\right)  }_{=P}\right)  =\operatorname*{ceq}\left(
P\right)  $. Now,
\begin{align*}
\operatorname*{ceq}\left(  \underbrace{\mathbf{B}_{Z}\left(  P\right)
}_{=\Phi\left(  \mathbf{B}\left(  S\right)  \right)  }\right)   &
=\operatorname*{ceq}\left(  \Phi\left(  \mathbf{B}\left(  S\right)  \right)
\right)  =\operatorname*{ceq}\left(  \mathbf{B}\left(  S\right)  \right)
\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BKi.ceq}), applied to
}T=S\right) \\
&  =\operatorname*{ceq}\left(  S\right)  \ \ \ \ \ \ \ \ \ \ \left(  \text{by
(\ref{eq.lem.BK.ceq})}\right) \\
&  =\operatorname*{ceq}\left(  P\right)  .
\end{align*}
Thus, (\ref{eq.lem.BKi.ceq}) is proven. It remains to prove
(\ref{eq.lem.BKi.ircont}). In other words, it remains to prove that
$\operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(  P\right)  \right)
=s_{i}\cdot\operatorname*{ircont}\left(  P\right)  $. In other words, it
remains to prove that $\left(  \operatorname*{ircont}\left(  \mathbf{B}%
_{Z}\left(  P\right)  \right)  \right)  _{h}=\left(  s_{i}\cdot
\operatorname*{ircont}\left(  P\right)  \right)  _{h}$ for every
$h\in\mathbb{N}_{+}$.

So let us fix $h\in\mathbb{N}_{+}$. We then are in one of the following three cases:

\textit{Case 1:} We have $h=i$.

\textit{Case 2:} We have $h=i+1$.

\textit{Case 3:} We have $h\notin\left\{  i,i+1\right\}  $.

Let us first consider Case 1. In this case, we have $h=i$. Thus,%
\begin{align*}
\left(  \operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(  P\right)  \right)
\right)  _{h}  &  =\left(  \operatorname*{ircont}\left(
\underbrace{\mathbf{B}_{Z}\left(  P\right)  }_{=\Phi\left(  \mathbf{B}\left(
S\right)  \right)  }\right)  \right)  _{i}=\left(  \operatorname*{ircont}%
\left(  \Phi\left(  \mathbf{B}\left(  S\right)  \right)  \right)  \right)
_{i}\\
&  =\left(  \underbrace{\operatorname*{ircont}\left(  \mathbf{B}\left(
S\right)  \right)  }_{\substack{=s_{1}\cdot\operatorname*{ircont}\left(
S\right)  \\\text{(by (\ref{eq.lem.BK.ircont}))}}}\right)  _{1}%
\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BKi.ircont1}), applied to
}T=\mathbf{B}\left(  S\right)  \right) \\
&  =\left(  s_{1}\cdot\operatorname*{ircont}\left(  S\right)  \right)
_{1}=\left(  \operatorname*{ircont}\left(  S\right)  \right)  _{s_{1}%
^{-1}\left(  1\right)  }=\left(  \operatorname*{ircont}\left(  S\right)
\right)  _{2}\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }s_{1}^{-1}\left(  1\right)
=2\right)  .
\end{align*}
Compared with%
\begin{align*}
\left(  s_{i}\cdot\operatorname*{ircont}\left(  P\right)  \right)  _{h}  &
=\left(  \operatorname*{ircont}\left(  P\right)  \right)  _{s_{i}^{-1}\left(
h\right)  }=\left(  \operatorname*{ircont}\left(  \underbrace{P}_{=\Phi\left(
S\right)  }\right)  \right)  _{i+1}\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }s_{i}^{-1}\left(  \underbrace{h}%
_{=i}\right)  =s_{i}^{-1}\left(  i\right)  =i+1\right) \\
&  =\left(  \operatorname*{ircont}\left(  \Phi\left(  S\right)  \right)
\right)  _{i+1}=\left(  \operatorname*{ircont}\left(  S\right)  \right)
_{2}\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BKi.ircont2}), applied to
}T=S\right)  ,
\end{align*}
this yields $\left(  \operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(
P\right)  \right)  \right)  _{h}=\left(  s_{i}\cdot\operatorname*{ircont}%
\left(  P\right)  \right)  _{h}$. Thus, $\left(  \operatorname*{ircont}\left(
\mathbf{B}_{Z}\left(  P\right)  \right)  \right)  _{h}=\left(  s_{i}%
\cdot\operatorname*{ircont}\left(  P\right)  \right)  _{h}$ is proven in Case 1.

Let us now consider Case 2. In this case, we have $h=i+1$. Thus,%
\begin{align*}
\left(  \operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(  P\right)  \right)
\right)  _{h}  &  =\left(  \operatorname*{ircont}\left(
\underbrace{\mathbf{B}_{Z}\left(  P\right)  }_{=\Phi\left(  \mathbf{B}\left(
S\right)  \right)  }\right)  \right)  _{i+1}=\left(  \operatorname*{ircont}%
\left(  \Phi\left(  \mathbf{B}\left(  S\right)  \right)  \right)  \right)
_{i+1}\\
&  =\left(  \underbrace{\operatorname*{ircont}\left(  \mathbf{B}\left(
S\right)  \right)  }_{\substack{=s_{1}\cdot\operatorname*{ircont}\left(
S\right)  \\\text{(by (\ref{eq.lem.BK.ircont}))}}}\right)  _{2}%
\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BKi.ircont2}), applied to
}T=\mathbf{B}\left(  S\right)  \right) \\
&  =\left(  s_{1}\cdot\operatorname*{ircont}\left(  S\right)  \right)
_{2}=\left(  \operatorname*{ircont}\left(  S\right)  \right)  _{s_{1}%
^{-1}\left(  2\right)  }=\left(  \operatorname*{ircont}\left(  S\right)
\right)  _{1}\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }s_{1}^{-1}\left(  2\right)
=1\right)  .
\end{align*}
Compared with%
\begin{align*}
\left(  s_{i}\cdot\operatorname*{ircont}\left(  P\right)  \right)  _{h}  &
=\left(  \operatorname*{ircont}\left(  P\right)  \right)  _{s_{i}^{-1}\left(
h\right)  }=\left(  \operatorname*{ircont}\left(  \underbrace{P}_{=\Phi\left(
S\right)  }\right)  \right)  _{i}\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }s_{i}^{-1}\left(  \underbrace{h}%
_{=i+1}\right)  =s_{i}^{-1}\left(  i+1\right)  =i\right) \\
&  =\left(  \operatorname*{ircont}\left(  \Phi\left(  S\right)  \right)
\right)  _{i}=\left(  \operatorname*{ircont}\left(  S\right)  \right)
_{1}\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BKi.ircont1}), applied
to }T=S\right)  ,
\end{align*}
this yields $\left(  \operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(
P\right)  \right)  \right)  _{h}=\left(  s_{i}\cdot\operatorname*{ircont}%
\left(  P\right)  \right)  _{h}$. Thus, $\left(  \operatorname*{ircont}\left(
\mathbf{B}_{Z}\left(  P\right)  \right)  \right)  _{h}=\left(  s_{i}%
\cdot\operatorname*{ircont}\left(  P\right)  \right)  _{h}$ is proven in Case 2.

Let us finally consider Case 3. In this case, we have $h\notin\left\{
i,i+1\right\}  $. Thus, $s_{i}^{-1}\left(  h\right)  =h$. Now,%
\begin{align*}
\left(  \operatorname*{ircont}\left(  \underbrace{\mathbf{B}_{Z}\left(
P\right)  }_{=\Phi\left(  \mathbf{B}\left(  S\right)  \right)  }\right)
\right)  _{h}  &  =\left(  \operatorname*{ircont}\left(  \Phi\left(
\mathbf{B}\left(  S\right)  \right)  \right)  \right)  _{h}=0\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BKi.ircont3}), applied to
}T=\mathbf{B}\left(  S\right)  \right)  .
\end{align*}
Compared with%
\begin{align*}
\left(  s_{i}\cdot\operatorname*{ircont}\left(  P\right)  \right)  _{h}  &
=\left(  \operatorname*{ircont}\left(  P\right)  \right)  _{s_{i}^{-1}\left(
h\right)  }=\left(  \operatorname*{ircont}\left(  \underbrace{P}_{=\Phi\left(
S\right)  }\right)  \right)  _{h}\ \ \ \ \ \ \ \ \ \ \left(  \text{since
}s_{i}^{-1}\left(  h\right)  =h\right) \\
&  =\left(  \operatorname*{ircont}\left(  \Phi\left(  S\right)  \right)
\right)  _{h}=0\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BKi.ircont3}%
), applied to }T=S\right)  ,
\end{align*}
this yields $\left(  \operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(
P\right)  \right)  \right)  _{h}=\left(  s_{i}\cdot\operatorname*{ircont}%
\left(  P\right)  \right)  _{h}$. Thus, $\left(  \operatorname*{ircont}\left(
\mathbf{B}_{Z}\left(  P\right)  \right)  \right)  _{h}=\left(  s_{i}%
\cdot\operatorname*{ircont}\left(  P\right)  \right)  _{h}$ is proven in Case 3.

We have now proven $\left(  \operatorname*{ircont}\left(  \mathbf{B}%
_{Z}\left(  P\right)  \right)  \right)  _{h}=\left(  s_{i}\cdot
\operatorname*{ircont}\left(  P\right)  \right)  _{h}$ in each of the three
Cases 1, 2 and 3. Since these three Cases cover all possibilities, this shows
that $\left(  \operatorname*{ircont}\left(  \mathbf{B}_{Z}\left(  P\right)
\right)  \right)  _{h}=\left(  s_{i}\cdot\operatorname*{ircont}\left(
P\right)  \right)  _{h}$ always holds. This completes the proof of Lemma
\ref{lem.BKi} using Lemma \ref{lem.BK}.
\end{proof}
\end{verlong}

\begin{vershort}
\begin{proof}
[Proof of Theorem \ref{thm.BK} using Lemma \ref{lem.BKi}.]Let us define a map
$\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)  \rightarrow
\operatorname*{RPP}\left(  \lambda/\mu\right)  $.

Indeed, let $T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  $. Then,
$T^{-1}\left(  \left\{  i,i+1\right\}  \right)  $ is a finite convex subset of
$Y\left(  \lambda/\mu\right)  $. We denote this subset by $Z$. Let
$\mathbf{R}_{Z}$ denote the set of all rpps of shape $Z$ whose entries all
belong to the set $\left\{  i,i+1\right\}  $. Lemma \ref{lem.BKi} yields that
there exists an involution $\mathbf{B}_{Z}:\mathbf{R}_{Z}\rightarrow
\mathbf{R}_{Z}$ (defined canonically in terms of $Z$) which has the following
property: For every $P\in\mathbf{R}_{Z}$, the equalities (\ref{eq.lem.BKi.ceq}%
) and (\ref{eq.lem.BKi.ircont}) hold. Consider this involution $\mathbf{B}%
_{Z}$. Clearly, $T\mid_{Z}\in\mathbf{R}_{Z}$. Hence, the involution
$\mathbf{B}_{Z}:\mathbf{R}_{Z}\rightarrow\mathbf{R}_{Z}$ gives rise to a
$\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  \in\mathbf{R}_{Z}$. Now, we define a
new filling $T^{\prime}$ of $Y\left(  \lambda/\mu\right)  $ as follows:%
\[
T^{\prime}\left(  c\right)  =\left\{
\begin{array}
[c]{c}%
\left(  \mathbf{B}_{Z}\left(  T\mid_{Z}\right)  \right)  \left(  c\right)
,\ \ \ \ \ \ \ \ \ \ \text{if }c\in Z;\\
T\left(  c\right)  ,\ \ \ \ \ \ \ \ \ \ \text{if }c\notin Z
\end{array}
\right.  \ \ \ \ \ \ \ \ \ \ \text{for every cell }c\text{ of }Y\left(
\lambda/\mu\right)  .
\]
In other words, $T^{\prime}$ is obtained from $T$ by:

\begin{itemize}
\item replacing all entries of the restriction $T\mid_{Z}$ (that is, all
entries in cells $c\in Z$) by the respective entries of $\mathbf{B}_{Z}\left(
T\mid_{Z}\right)  $, and

\item leaving all other entries as they are.
\end{itemize}

Notice that $T^{\prime}\mid_{Z}=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $ and
$T^{\prime}\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}=T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}$. These two equalities determine $T^{\prime}%
$. It is easy to see that $T^{\prime}$ is an rpp of shape $Y\left(
\lambda/\mu\right)  $. That is, $T^{\prime}\in\operatorname*{RPP}\left(
\lambda/\mu\right)  $. We now define $\mathbf{B}_{i}\left(  T\right)
=T^{\prime}$. Thus, a map $\mathbf{B}_{i}:\operatorname*{RPP}\left(
\lambda/\mu\right)  \rightarrow\operatorname*{RPP}\left(  \lambda/\mu\right)
$ is defined.

The reader can easily verify that this map $\mathbf{B}_{i}$ is an involution,
and that every $T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  $ satisfies
(\ref{eq.thm.BK.ceq}) and (\ref{eq.thm.BK.ircont}). (Essentially, these
properties follow from the analogous properties of the map $\mathbf{B}_{Z}$,
once one realizes that every $T\in\operatorname*{RPP}\left(  \lambda
/\mu\right)  $ satisfies%
\[
\left(  \mathbf{B}_{i}\left(  T\right)  \right)  ^{-1}\left(  \left\{
i,i+1\right\}  \right)  =T^{-1}\left(  \left\{  i,i+1\right\}  \right)  ,
\]
\[
\operatorname*{ceq}\left(  T\right)  =\operatorname*{ceq}\left(  T\mid
_{Z}\right)  +\operatorname*{ceq}\left(  T\mid_{Y\left(  \lambda/\mu\right)
\setminus Z}\right)
\]
and%
\[
\operatorname*{ircont}\left(  T\right)  =\operatorname*{ircont}\left(
T\mid_{Z}\right)  +\underbrace{\operatorname*{ircont}\left(  T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}\right)  }_{\substack{\text{This composition
is invariant under }s_{i}\\\text{(because its }i\text{-th and }\left(
i+1\right)  \text{-th entries are zero).}}}.
\]
) \Needspace{14\baselineskip}

\begin{example}
Let us give an example of how $\mathbf{B}_{i}$ acts on an rpp. Assume for this
example that $\lambda=\left(  9,8,8,7\right)  $ and $\mu=\left(
4,3,2,1\right)  $, and let $T$ be the filling%
\[%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
%\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
%\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
%\none& 1 & 1 & 2 & 3 & 4 & 8
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
\none& 1 & 1 & 2 & 3 & 4 & 8
\end{ytableau}%
%EndExpansion
\]
(there is an invisible empty $1$-st column here). Set $i=3$. Then, the
$\left(  i,i+1\right)  $-domain $Z$ of $T$ is the set%
\[
\left\{  \left(  1,6\right)  ,\left(  1,7\right)  ,\left(  1,8\right)
,\left(  2,6\right)  ,\left(  2,7\right)  ,\left(  3,5\right)  ,\left(
3,6\right)  ,\left(  4,5\right)  ,\left(  4,6\right)  \right\}  .
\]
The rpp $T\mid_{Z}$ is%
\[%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& \none& 3 & 3 & 4 \\
%\none& \none& \none& \none& \none& 3 & 4 \\
%\none& \none& \none& \none& 3 & 3\\
%\none& \none& \none& \none& 3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& \none& 3 & 3 & 4 \\
\none& \none& \none& \none& \none& 3 & 4 \\
\none& \none& \none& \none& 3 & 3\\
\none& \none& \none& \none& 3 & 4
\end{ytableau}%
%EndExpansion
\]
(with the first four columns being empty and invisible). We have not defined
$\mathbf{B}_{Z}$ yet, but let us assume that $\mathbf{B}_{Z}$ maps this rpp
$T\mid_{Z}$ to%
\[
\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& \none& 3 & 3 & 4 \\
%\none& \none& \none& \none& \none& 3 & 4 \\
%\none& \none& \none& \none& 3 & 3 \\
%\none& \none& \none& \none& 3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& \none& 3 & 3 & 4 \\
\none& \none& \none& \none& \none& 3 & 4 \\
\none& \none& \none& \none& 3 & 3 \\
\none& \none& \none& \none& 3 & 4
\end{ytableau}%
%EndExpansion
.
\]
(This is, in fact, what the map $\mathbf{B}_{Z}$ defined below does to
$T\mid_{Z}$.) Then, $\mathbf{B}_{i}\left(  T\right)  $ is obtained from $T$ by
replacing the entries of $T\mid_{Z}$ by the respective entries of
$\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $, while leaving all other entries as
they are. Thus,%
\[
\mathbf{B}_{i}\left(  T\right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
%\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
%\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
%\none& 1 & 1 & 2 & 3 & 4 & 8
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
\none& 1 & 1 & 2 & 3 & 4 & 8
\end{ytableau}%
%EndExpansion
.
\]

\end{example}
\end{proof}
\end{vershort}

\begin{verlong}
\begin{proof}
[Proof of Theorem \ref{thm.BK} using Lemma \ref{lem.BKi}.]Let us first define
a map $\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)
\rightarrow\operatorname*{RPP}\left(  \lambda/\mu\right)  $.

Indeed, let $T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  $. Then,
$T^{-1}\left(  \left\{  i,i+1\right\}  \right)  $ is a finite convex subset of
$Y\left(  \lambda/\mu\right)  $.\ \ \ \ \footnote{Indeed, the fact that it is
convex follows from the fact that the entries of $T$ are weakly increasing
along rows and weakly increasing down columns.} Let us denote this subset by
$Z$, and refer to it as the $\left(  i,i+1\right)  $\textit{-domain} of $T$.
Let $\mathbf{R}_{Z}$ denote the set of all rpps of shape $Z$ whose entries all
belong to the set $\left\{  i,i+1\right\}  $. Lemma \ref{lem.BKi} yields that
there exists an involution $\mathbf{B}_{Z}:\mathbf{R}_{Z}\rightarrow
\mathbf{R}_{Z}$ (defined canonically in terms of $Z$) which has the following
property: For every $P\in\mathbf{R}_{Z}$, the equalities (\ref{eq.lem.BKi.ceq}%
) and (\ref{eq.lem.BKi.ircont}) hold. Consider this involution $\mathbf{B}%
_{Z}$. We have $Z=T^{-1}\left(  \left\{  i,i+1\right\}  \right)  $, and thus
$T\mid_{Z}$ is an rpp of shape $Z$ whose entries all belong to the set
$\left\{  i,i+1\right\}  $. In other words, $T\mid_{Z}\in\mathbf{R}_{Z}$.
Hence, the involution $\mathbf{B}_{Z}:\mathbf{R}_{Z}\rightarrow\mathbf{R}_{Z}$
gives rise to a new such rpp $\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $. Now,
we define a new filling $T^{\prime}$ of $Y\left(  \lambda/\mu\right)  $ as
follows:%
\[
T^{\prime}\left(  c\right)  =\left\{
\begin{array}
[c]{c}%
\left(  \mathbf{B}_{Z}\left(  T\mid_{Z}\right)  \right)  \left(  c\right)
,\ \ \ \ \ \ \ \ \ \ \text{if }c\in Z;\\
T\left(  c\right)  ,\ \ \ \ \ \ \ \ \ \ \text{if }c\notin Z
\end{array}
\right.  \ \ \ \ \ \ \ \ \ \ \text{for every cell }c\text{ of }Y\left(
\lambda/\mu\right)  .
\]
In other words, $T^{\prime}$ is obtained from $T$ by:

\begin{itemize}
\item replacing all entries of the restriction $T\mid_{Z}$ (that is, all
entries in cells $c\in Z$) by the respective entries of $\mathbf{B}_{Z}\left(
T\mid_{Z}\right)  $, and

\item leaving all other entries as they are.
\end{itemize}

Notice that $T^{\prime}\mid_{Z}=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $ and
$T^{\prime}\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}=T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}$. These two equalities determine $T^{\prime}%
$. It is easy to see that $T^{\prime}$ is an rpp of shape $Y\left(
\lambda/\mu\right)  $\ \ \ \ \footnote{\textit{Proof.} We need to show that
$T^{\prime}$ is an rpp. The fillings $T$ and $T^{\prime}$ differ only in some
entries in cells belonging to $Z$; these entries are $i$'s and $\left(
i+1\right)  $'s (both in $T$ and in $T^{\prime}$). Hence, in order to prove
that $T^{\prime}$ is an rpp, we only need to check that there is no $i+1$ to
the left of an $i$ or above an $i$ in $T^{\prime}$ (because we already know
that $T$ is an rpp). In other words, we only need to check that the $i$'s and
the $\left(  i+1\right)  $'s in $T^{\prime}$ form an rpp. But this is clear,
because they form the filling $\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $,
which is an rpp by definition. Thus, we have shown that $T^{\prime}$ is an
rpp.}. That is, $T^{\prime}\in\operatorname*{RPP}\left(  \lambda/\mu\right)
$. We now define $\mathbf{B}_{i}\left(  T\right)  =T^{\prime}$. Thus, a map
$\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)  \rightarrow
\operatorname*{RPP}\left(  \lambda/\mu\right)  $ is defined. We can briefly
summarize this definition as follows: For every $T\in\operatorname*{RPP}%
\left(  \lambda/\mu\right)  $, the filling $\mathbf{B}_{i}\left(  T\right)  $
is the unique $T^{\prime}\in\operatorname*{RPP}\left(  \lambda/\mu\right)  $
such that $T^{\prime}\mid_{Z}=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $ and
$T^{\prime}\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}=T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}$, where we let $Z$ be the $\left(
i,i+1\right)  $-domain of $T$. We shall refer to this fact as the
\textit{brief definition of }$\mathbf{B}_{i}\left(  T\right)  $.

\Needspace{14\baselineskip}

\begin{example}
Let us give an example of how $\mathbf{B}_{i}$ acts on an rpp. Assume for this
example that $\lambda=\left(  9,8,8,7\right)  $ and $\mu=\left(
4,3,2,1\right)  $, and let $T$ be the filling%
\[%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
%\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
%\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
%\none& 1 & 1 & 2 & 3 & 4 & 8
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
\none& 1 & 1 & 2 & 3 & 4 & 8
\end{ytableau}%
%EndExpansion
\]
(there is an invisible empty $1$-st column here). Set $i=3$. Then, the
$\left(  i,i+1\right)  $-domain $Z$ of $T$ is the set%
\[
\left\{  \left(  1,6\right)  ,\left(  1,7\right)  ,\left(  1,8\right)
,\left(  2,6\right)  ,\left(  2,7\right)  ,\left(  3,5\right)  ,\left(
3,6\right)  ,\left(  4,5\right)  ,\left(  4,6\right)  \right\}  .
\]
The rpp $T\mid_{Z}$ is%
\[%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& \none& 3 & 3 & 4 \\
%\none& \none& \none& \none& \none& 3 & 4 \\
%\none& \none& \none& \none& 3 & 3\\
%\none& \none& \none& \none& 3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& \none& 3 & 3 & 4 \\
\none& \none& \none& \none& \none& 3 & 4 \\
\none& \none& \none& \none& 3 & 3\\
\none& \none& \none& \none& 3 & 4
\end{ytableau}%
%EndExpansion
\]
(with the first four columns being empty and invisible). We have not defined
$\mathbf{B}_{Z}$ yet, but let us assume that $\mathbf{B}_{Z}$ maps this rpp
$T\mid_{Z}$ to%
\[
\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& \none& 3 & 3 & 4 \\
%\none& \none& \none& \none& \none& 3 & 4 \\
%\none& \none& \none& \none& 3 & 3 \\
%\none& \none& \none& \none& 3 & 4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& \none& 3 & 3 & 4 \\
\none& \none& \none& \none& \none& 3 & 4 \\
\none& \none& \none& \none& 3 & 3 \\
\none& \none& \none& \none& 3 & 4
\end{ytableau}%
%EndExpansion
.
\]
(This is, in fact, what the map $\mathbf{B}_{Z}$ defined below does to
$T\mid_{Z}$.) Then, $\mathbf{B}_{i}\left(  T\right)  $ is obtained from $T$ by
replacing the entries of $T\mid_{Z}$ by the respective entries of
$\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $, while leaving all other entries as
they are. Thus,%
\[
\mathbf{B}_{i}\left(  T\right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
%\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
%\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
%\none& 1 & 1 & 2 & 3 & 4 & 8
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& 1 & 3 & 3 & 4 & 5 \\
\none& \none& \none& 1 & 1 & 3 & 4 & 6 \\
\none& \none& 1 & 2 & 3 & 3 & 5 & 6 \\
\none& 1 & 1 & 2 & 3 & 4 & 8
\end{ytableau}%
%EndExpansion
.
\]

\end{example}

Let us now show that $\mathbf{B}_{i}$ is an involution. Indeed, we must prove
that $\mathbf{B}_{i}\left(  \mathbf{B}_{i}\left(  T\right)  \right)  =T$ for
every $T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  $.

So let us fix a $T\in\operatorname*{RPP}\left(  \lambda/\mu\right)  $. We need
to show that $\mathbf{B}_{i}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
=T$.

Let $Z$ be the $\left(  i,i+1\right)  $-domain of $T$. Thus, $Z=T^{-1}\left(
\left\{  i,i+1\right\}  \right)  $. In other words, $Z$ is the set of all
cells of $T$ whose entries are $i$'s and $\left(  i+1\right)  $'s.
Consequently, neither $i$'s nor $\left(  i+1\right)  $'s can occur in
$T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$.

By the brief definition of $\mathbf{B}_{i}\left(  T\right)  $, we know that
$\mathbf{B}_{i}\left(  T\right)  $ is the unique $T^{\prime}\in
\operatorname*{RPP}\left(  \lambda/\mu\right)  $ such that $T^{\prime}\mid
_{Z}=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $ and $T^{\prime}\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}=T\mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}$. Thus, $\mathbf{B}_{i}\left(  T\right)  \mid_{Z}=\mathbf{B}_{Z}\left(
T\mid_{Z}\right)  $ and $\mathbf{B}_{i}\left(  T\right)  \mid_{Y\left(
\lambda/\mu\right)  \setminus Z}=T\mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}$. Therefore, all entries of the filling $\mathbf{B}_{i}\left(  T\right)
\mid_{Z}$ are $i$'s and $\left(  i+1\right)  $'s (since $\mathbf{B}_{i}\left(
T\right)  \mid_{Z}=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  \in\mathbf{R}_{Z}%
$), whereas neither $i$'s nor $\left(  i+1\right)  $'s can occur in
$\mathbf{B}_{i}\left(  T\right)  \mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}$ (because $\mathbf{B}_{i}\left(  T\right)  \mid_{Y\left(  \lambda
/\mu\right)  \setminus Z}=T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$,
but neither $i$'s nor $\left(  i+1\right)  $'s can occur in $T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}$). Therefore,
\begin{equation}
\text{the }\left(  i,i+1\right)  \text{-domain of }\mathbf{B}_{i}\left(
T\right)  \text{ is again }Z\text{.} \label{pf.thm.BK.again-Z}%
\end{equation}
Hence, the brief definition of $\mathbf{B}_{i}\left(  \mathbf{B}_{i}\left(
T\right)  \right)  $ yields that $\mathbf{B}_{i}\left(  \mathbf{B}_{i}\left(
T\right)  \right)  $ is the unique $T^{\prime}\in\operatorname*{RPP}\left(
\lambda/\mu\right)  $ such that $T^{\prime}\mid_{Z}=\mathbf{B}_{Z}\left(
\mathbf{B}_{i}\left(  T\right)  \mid_{Z}\right)  $ and $T^{\prime}%
\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}=\mathbf{B}_{i}\left(
T\right)  \mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$. But this unique
$T^{\prime}$ is $T$ (because we have $T\mid_{Z}=\mathbf{B}_{Z}\left(
\mathbf{B}_{i}\left(  T\right)  \mid_{Z}\right)  $%
\ \ \ \ \footnote{\textit{Proof.} We have $\mathbf{B}_{i}\left(  T\right)
\mid_{Z}=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $, thus $\mathbf{B}%
_{Z}\left(  \mathbf{B}_{i}\left(  T\right)  \mid_{Z}\right)  =\mathbf{B}%
_{Z}\left(  \mathbf{B}_{Z}\left(  T\mid_{Z}\right)  \right)  =T\mid_{Z}$ (
since $\mathbf{B}_{Z}$ is an involution), qed.} and $T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}=\mathbf{B}_{i}\left(  T\right)
\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$\ \ \ \ \footnote{since
$\mathbf{B}_{i}\left(  T\right)  \mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}=T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$}). Hence, $\mathbf{B}%
_{i}\left(  \mathbf{B}_{i}\left(  T\right)  \right)  $ must be $T$. We thus
have proven $\mathbf{B}_{i}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
=T$, and so we have shown that $\mathbf{B}_{i}$ is an involution.

It remains to prove that, for every $T\in\operatorname*{RPP}\left(
\lambda/\mu\right)  $, we have (\ref{eq.thm.BK.ceq}) and
(\ref{eq.thm.BK.ircont}). So fix $T\in\operatorname*{RPP}\left(  \lambda
/\mu\right)  $. Let $Z$ be the $\left(  i,i+1\right)  $-domain of $T$. Thus,
$Z=T^{-1}\left(  \left\{  i,i+1\right\}  \right)  $. Recall that
$\mathbf{B}_{i}\left(  T\right)  $ is the unique $T^{\prime}\in
\operatorname*{RPP}\left(  \lambda/\mu\right)  $ such that $T^{\prime}\mid
_{Z}=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  $ and $T^{\prime}\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}=T\mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}$. Thus, $\mathbf{B}_{i}\left(  T\right)  \mid_{Z}=\mathbf{B}_{Z}\left(
T\mid_{Z}\right)  $ and $\mathbf{B}_{i}\left(  T\right)  \mid_{Y\left(
\lambda/\mu\right)  \setminus Z}=T\mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}$. Notice that the $\left(  i,i+1\right)  $-domain of $\mathbf{B}_{i}\left(
T\right)  $ is again $Z$.\ \ \ \ \footnote{This is proven just as we proved
(\ref{pf.thm.BK.again-Z}).}.

\textit{Proof of (\textit{\ref{eq.thm.BK.ceq}}):} We define the sum
$\alpha+\beta$ of two weak compositions $\alpha$ and $\beta$ by%
\[
\alpha+\beta=\left(  \alpha_{1}+\beta_{1},\alpha_{2}+\beta_{2},\alpha
_{3}+\beta_{3},\ldots\right)  .
\]


Recall that $Z=T^{-1}\left(  \left\{  i,i+1\right\}  \right)  $ (since $Z$ is
the $\left(  i,i+1\right)  $-domain of $T$). Hence, the entries of $T\mid_{Z}$
all belong to the set $\left\{  i,i+1\right\}  $, while the entries of
$T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$ all belong to
$\mathbb{N}_{+}\setminus\left\{  i,i+1\right\}  $. Thus, if two cells $c$ and
$d$ of $Y\left(  \lambda/\mu\right)  $ satisfy $T\left(  c\right)  =T\left(
d\right)  $, then either both $c$ and $d$ lie in $Z$ or both $c$ and $d$ lie
in $Y\left(  \lambda/\mu\right)  \setminus Z$ (depending on whether $T\left(
c\right)  =T\left(  d\right)  $ belongs to $\left\{  i,i+1\right\}  $ or to
$\mathbb{N}_{+}\setminus\left\{  i,i+1\right\}  $). Thus, the stagnant cells
of $T$ are precisely the stagnant cells of $T\mid_{Z}$ and the stagnant cells
of $T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$%
\ \ \ \ \footnote{\textit{Proof.} It is clear that all stagnant cells of
$T\mid_{Z}$ and all stagnant cells of $T\mid_{Y\left(  \lambda/\mu\right)
\setminus Z}$ are stagnant cells of $T$. It remains to prove the opposite
direction; i.e., it remains to show that each stagnant cell of $T$ is either a
stagnant cell of $T\mid_{Z}$ or a stagnant cell of $T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}$.
\par
Let $p$ be a stagnant cell of $T$. We need to prove that $p$ is either a
stagnant cell of $T\mid_{Z}$ or a stagnant cell of $T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}$.
\par
Write $p$ in the form $p=\left(  u,v\right)  $. Then, $\left(  u,v\right)  =p$
is a stagnant cell of $T$. In other words, $\left(  u+1,v\right)  $ is also a
cell of $Z$ and satisfies $T\left(  u,v\right)  =T\left(  u+1,v\right)  $
(because of the definition of a \textquotedblleft stagnant
cell\textquotedblright). Now, recall that if two cells $c$ and $d$ of
$Y\left(  \lambda/\mu\right)  $ satisfy $T\left(  c\right)  =T\left(
d\right)  $, then either both $c$ and $d$ lie in $Z$ or both $c$ and $d$ lie
in $Y\left(  \lambda/\mu\right)  \setminus Z$. Applying this to $c=\left(
u,v\right)  $ and $d=\left(  u+1,v\right)  $, we conclude that either both
$\left(  u,v\right)  $ and $\left(  u+1,v\right)  $ lie in $Z$ or both
$\left(  u,v\right)  $ and $\left(  u+1,v\right)  $ lie in $Z$. In the first
of these two cases, $\left(  u,v\right)  $ is a stagnant cell of $T\mid_{Z}$;
in the second case, $\left(  u,v\right)  $ is a stagnant cell of
$T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$. Thus, $\left(  u,v\right)
$ is either a stagnant cell of $T\mid_{Z}$ or a stagnant cell of
$T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$. In other words, $p$ is
either a stagnant cell of $T\mid_{Z}$ or a stagnant cell of $T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}$ (since $p=\left(  u,v\right)  $). This
completes our proof.}. Now, for every $p\in\mathbb{N}_{+}$, we have%
\begin{align*}
&  \left(  \operatorname*{ceq}\left(  T\right)  \right)  _{p}\\
&  =\left(  \text{the number of }j\in\mathbb{N}_{+}\text{ such that }\left(
p,j\right)  \text{ is a stagnant cell of }T\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by the definition of }\left(
\operatorname*{ceq}\left(  T\right)  \right)  _{p}\right) \\
&  =\underbrace{\left(  \text{the number of }j\in\mathbb{N}_{+}\text{ such
that }\left(  p,j\right)  \text{ is a stagnant cell of }T\mid_{Z}\right)
}_{\substack{=\left(  \operatorname*{ceq}\left(  T\mid_{Z}\right)  \right)
_{p}\\\text{(by the definition of }\left(  \operatorname*{ceq}\left(
T\mid_{Z}\right)  \right)  _{p}\text{)}}}\\
&  \ \ \ \ \ \ \ \ \ \ +\underbrace{\left(  \text{the number of }%
j\in\mathbb{N}_{+}\text{ such that }\left(  i,j\right)  \text{ is a stagnant
cell of }T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}\right)
}_{\substack{=\left(  \operatorname*{ceq}\left(  T\mid_{Y\left(  \lambda
/\mu\right)  \setminus Z}\right)  \right)  _{p}\\\text{(by the definition of
}\left(  \operatorname*{ceq}\left(  T\mid_{Y\left(  \lambda/\mu\right)
\setminus Z}\right)  \right)  _{p}\text{)}}}\\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since the stagnant cells of }T\text{ are precisely the stagnant}\\
\text{cells of }T\mid_{Z}\text{ and the stagnant cells of }T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}%
\end{array}
\right) \\
&  =\left(  \operatorname*{ceq}\left(  T\mid_{Z}\right)  \right)  _{p}+\left(
\operatorname*{ceq}\left(  T\mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}\right)  \right)  _{p}=\left(  \operatorname*{ceq}\left(  T\mid_{Z}\right)
+\operatorname*{ceq}\left(  T\mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}\right)  \right)  _{p}.
\end{align*}
Hence, $\operatorname*{ceq}\left(  T\right)  =\operatorname*{ceq}\left(
T\mid_{Z}\right)  +\operatorname*{ceq}\left(  T\mid_{Y\left(  \lambda
/\mu\right)  \setminus Z}\right)  $. The same argument (but applied to
$\mathbf{B}_{i}\left(  T\right)  $ instead of $T$) yields $\operatorname*{ceq}%
\left(  \mathbf{B}_{i}\left(  T\right)  \right)  =\operatorname*{ceq}\left(
\mathbf{B}_{i}\left(  T\right)  \mid_{Z}\right)  +\operatorname*{ceq}\left(
\mathbf{B}_{i}\left(  T\right)  \mid_{Y\left(  \lambda/\mu\right)  \setminus
Z}\right)  $ (since $Z$ is also the $\left(  i,i+1\right)  $-domain of
$\mathbf{B}_{i}\left(  T\right)  $). Hence,%
\begin{align*}
\operatorname*{ceq}\left(  \mathbf{B}_{i}\left(  T\right)  \right)   &
=\operatorname*{ceq}\left(  \underbrace{\mathbf{B}_{i}\left(  T\right)
\mid_{Z}}_{=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  }\right)
+\operatorname*{ceq}\left(  \underbrace{\mathbf{B}_{i}\left(  T\right)
\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}}_{=T\mid_{Y\left(  \lambda
/\mu\right)  \setminus Z}}\right) \\
&  =\underbrace{\operatorname*{ceq}\left(  \mathbf{B}_{Z}\left(  T\mid
_{Z}\right)  \right)  }_{\substack{=\operatorname*{ceq}\left(  T\mid
_{Z}\right)  \\\text{(by (\ref{eq.lem.BKi.ceq}), applied to }P=T\mid
_{Z}\text{)}}}+\operatorname*{ceq}\left(  T\mid_{Y\left(  \lambda/\mu\right)
\setminus Z}\right) \\
&  =\operatorname*{ceq}\left(  T\mid_{Z}\right)  +\operatorname*{ceq}\left(
T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}\right)  =\operatorname*{ceq}%
\left(  T\right)  .
\end{align*}
This proves (\ref{eq.thm.BK.ceq}).

\textit{Proof of (\ref{eq.thm.BK.ircont}):} We need to show that
$\operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
=s_{i}\cdot\operatorname*{ircont}\left(  T\right)  $. In other words, we need
to show that every $p\in\mathbb{N}_{+}$ satisfies%
\begin{equation}
\left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
\right)  _{p}=\left(  s_{i}\cdot\operatorname*{ircont}\left(  T\right)
\right)  _{p}. \label{pf.thm.BK.ircont.goal1}%
\end{equation}


So let us fix a $p\in\mathbb{N}_{+}$, and try to prove
(\ref{pf.thm.BK.ircont.goal1}).

Let us first assume that $p\notin\left\{  i,i+1\right\}  $. Then, $s_{i}%
^{-1}\left(  p\right)  =p$, so that $\left(  \operatorname*{ircont}\left(
T\right)  \right)  _{s_{i}^{-1}\left(  p\right)  }=\left(
\operatorname*{ircont}\left(  T\right)  \right)  _{p}$. Thus,%
\begin{equation}
\left(  s_{i}\cdot\operatorname*{ircont}\left(  T\right)  \right)
_{p}=\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{s_{i}%
^{-1}\left(  p\right)  }=\left(  \operatorname*{ircont}\left(  T\right)
\right)  _{p}. \label{pf.thm.BK.ircont.1}%
\end{equation}


The definition of $\left(  \operatorname*{ircont}\left(  T\right)  \right)
_{p}$ yields%
\begin{equation}
\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{p}=\left(
\text{the number of }k\in\mathbb{N}_{+}\text{ such that the }k\text{-th column
of }T\text{ contains }p\right)  . \label{pf.thm.BK.ircont.2}%
\end{equation}
But if $k\in\mathbb{N}_{+}$ is arbitrary, then the $k$-th column of $T$
contains $p$ if and only if the $k$-th column of $T\mid_{Y\left(  \lambda
/\mu\right)  \setminus Z}$ contains $p$\ \ \ \ \footnote{\textit{Proof.} Let
$k\in\mathbb{N}_{+}$. It is clear that if the $k$-th column of $T\mid
_{Y\left(  \lambda/\mu\right)  \setminus Z}$ contains $p$, then the $k$-th
column of $T$ contains $p$. It remains to prove the converse. In other words,
it remains to prove that if the $k$-th column of $T$ contains $p$, then the
$k$-th column of $T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$ contains
$p$.
\par
So, let us assume that the $k$-th column of $T$ contains $p$. In other words,
there exists a cell $c$ in the $k$-th column of $T$ such that $T\left(
c\right)  =p$. Consider this $c$. We have $T\left(  c\right)  =p\notin\left\{
i,i+1\right\}  $, hence $c\notin T^{-1}\left(  \left\{  i,i+1\right\}
\right)  $. But $T^{-1}\left(  \left\{  i,i+1\right\}  \right)  =Z$ (since $Z$
is the $\left(  i,i+1\right)  $-domain of $T$), and thus $c\notin
T^{-1}\left(  \left\{  i,i+1\right\}  \right)  =Z$, so that $c\in Y\left(
\lambda/\mu\right)  \setminus Z$. Thus, $c$ is a cell in the $k$-th column and
in $Y\left(  \lambda/\mu\right)  \setminus Z$. Since $\left(  T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}\right)  \left(  c\right)  =T\left(  c\right)
=p$, this yields that the $k$-th column of $T\mid_{Y\left(  \lambda
/\mu\right)  \setminus Z}$ contains $p$ (namely, in the cell $c$), qed.}.
Hence, (\ref{pf.thm.BK.ircont.2}) rewrites as%
\begin{align}
&  \left(  \operatorname*{ircont}\left(  T\right)  \right)  _{p}\nonumber\\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that
}\underbrace{\text{the }k\text{-th column of }T\text{ contains }%
p}_{\substack{\text{this is equivalent to}\\\left(  \text{the }k\text{-th
column of }T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}\text{ contains
}p\right)  }}\right) \nonumber\\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}\text{
contains }p\right) \nonumber\\
&  =\left(  \operatorname*{ircont}\left(  T\mid_{Y\left(  \lambda/\mu\right)
\setminus Z}\right)  \right)  _{p} \label{pf.thm.BK.ircont.4a}%
\end{align}
(since $\left(  \operatorname*{ircont}\left(  T\mid_{Y\left(  \lambda
/\mu\right)  \setminus Z}\right)  \right)  _{p}$ is defined as \newline%
$\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}\text{
contains }p\right)  $). The same argument (but applied to $\mathbf{B}%
_{i}\left(  T\right)  $ instead of $T$) shows that%
\[
\left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
\right)  _{p}=\left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(
T\right)  \mid_{Y\left(  \lambda/\mu\right)  \setminus Z}\right)  \right)
_{p}.
\]
Since $\mathbf{B}_{i}\left(  T\right)  \mid_{Y\left(  \lambda/\mu\right)
\setminus Z}=T\mid_{Y\left(  \lambda/\mu\right)  \setminus Z}$, this rewrites
as%
\begin{align*}
\left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
\right)  _{p}  &  =\left(  \operatorname*{ircont}\left(  T\mid_{Y\left(
\lambda/\mu\right)  \setminus Z}\right)  \right)  _{p}=\left(
\operatorname*{ircont}\left(  T\right)  \right)  _{p}%
\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.thm.BK.ircont.4a})}\right) \\
&  =\left(  s_{i}\cdot\operatorname*{ircont}\left(  T\right)  \right)
_{p}\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.thm.BK.ircont.1})}\right)  .
\end{align*}
Hence, (\ref{pf.thm.BK.ircont.goal1}) is proven under the assumption that
$p\notin\left\{  i,i+1\right\}  $.

It thus remains to prove (\ref{pf.thm.BK.ircont.goal1}) under the assumption
that $p\in\left\{  i,i+1\right\}  $. Let us assume that $p\in\left\{
i,i+1\right\}  $. We need to prove that $\left(  \operatorname*{ircont}\left(
\mathbf{B}_{i}\left(  T\right)  \right)  \right)  _{p}=\left(  s_{i}%
\cdot\operatorname*{ircont}\left(  T\right)  \right)  _{p}$. Let $q=s_{i}%
^{-1}\left(  p\right)  $. Then, $q\in\left\{  i,i+1\right\}  $ (since
$p\in\left\{  i,i+1\right\}  $) and%
\begin{equation}
\left(  s_{i}\cdot\operatorname*{ircont}\left(  T\right)  \right)
_{p}=\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{s_{i}%
^{-1}\left(  p\right)  }=\left(  \operatorname*{ircont}\left(  T\right)
\right)  _{q} \label{pf.thm.BK.ircont.o1}%
\end{equation}
(since $q=s_{i}^{-1}\left(  p\right)  $).

The definition of $\left(  \operatorname*{ircont}\left(  T\right)  \right)
_{q}$ yields%
\begin{equation}
\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{q}=\left(
\text{the number of }k\in\mathbb{N}_{+}\text{ such that the }k\text{-th column
of }T\text{ contains }q\right)  . \label{pf.thm.BK.ircont.o2}%
\end{equation}
But if $k\in\mathbb{N}_{+}$ is arbitrary, then the $k$-th column of $T$
contains $q$ if and only if the $k$-th column of $T\mid_{Z}$ contains
$q$\ \ \ \ \footnote{\textit{Proof.} Let $k\in\mathbb{N}_{+}$. It is clear
that if the $k$-th column of $T\mid_{Z}$ contains $q$, then the $k$-th column
of $T$ contains $q$. It remains to prove the converse. In other words, it
remains to prove that if the $k$-th column of $T$ contains $q$, then the
$k$-th column of $T\mid_{Z}$ contains $q$.
\par
So, let us assume that the $k$-th column of $T$ contains $q$. In other words,
there exists a cell $c$ in the $k$-th column of $T$ such that $T\left(
c\right)  =q$. Consider this $c$. We have $T\left(  c\right)  =q\in\left\{
i,i+1\right\}  $, hence $c\in T^{-1}\left(  \left\{  i,i+1\right\}  \right)
=Z$ (since $Z$ is the $\left(  i,i+1\right)  $-domain of $T$). Thus, $c$ is a
cell in the $k$-th column and in $Z$. Since $\left(  T\mid_{Z}\right)  \left(
c\right)  =T\left(  c\right)  =q$, this yields that the $k$-th column of
$T\mid_{Z}$ contains $q$ (namely, in the cell $c$), qed.}. Hence,
(\ref{pf.thm.BK.ircont.o2}) rewrites as%
\begin{align}
&  \left(  \operatorname*{ircont}\left(  T\right)  \right)  _{q}\nonumber\\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that
}\underbrace{\text{the }k\text{-th column of }T\text{ contains }%
q}_{\substack{\text{this is equivalent to}\\\left(  \text{the }k\text{-th
column of }T\mid_{Z}\text{ contains }q\right)  }}\right) \nonumber\\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\mid_{Z}\text{ contains }q\right) \nonumber\\
&  =\left(  \operatorname*{ircont}\left(  T\mid_{Z}\right)  \right)  _{q}
\label{pf.thm.BK.ircont.o4a}%
\end{align}
(since $\left(  \operatorname*{ircont}\left(  T\mid_{Z}\right)  \right)  _{q}$
is defined as \newline$\left(  \text{the number of }k\in\mathbb{N}_{+}\text{
such that the }k\text{-th column of }T\mid_{Z}\text{ contains }q\right)  $).
The same argument (but with $q$ and $T$ replaced by $p$ and $\mathbf{B}%
_{i}\left(  T\right)  $) yields%
\[
\left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)  \right)
\right)  _{p}=\left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(
T\right)  \mid_{Z}\right)  \right)  _{p}.
\]


This becomes%
\begin{align*}
&  \left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)
\right)  \right)  _{p}\\
&  =\left(  \operatorname*{ircont}\left(  \underbrace{\mathbf{B}_{i}\left(
T\right)  \mid_{Z}}_{=\mathbf{B}_{Z}\left(  T\mid_{Z}\right)  }\right)
\right)  _{p}=\left(  \underbrace{\operatorname*{ircont}\left(  \mathbf{B}%
_{Z}\left(  T\mid_{Z}\right)  \right)  }_{\substack{=s_{i}\cdot
\operatorname*{ircont}\left(  T\mid_{Z}\right)  \\\text{(by
(\ref{eq.lem.BKi.ircont}), applied to }P=T\mid_{Z}\text{)}}}\right)  _{p}\\
&  =\left(  s_{i}\cdot\operatorname*{ircont}\left(  T\mid_{Z}\right)  \right)
_{p}=\left(  \operatorname*{ircont}\left(  T\mid_{Z}\right)  \right)
_{s_{i}^{-1}\left(  p\right)  }=\left(  \operatorname*{ircont}\left(
T\mid_{Z}\right)  \right)  _{q}\ \ \ \ \ \ \ \ \ \ \left(  \text{since }%
s_{i}^{-1}\left(  p\right)  =q\right) \\
&  =\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{q}%
\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.thm.BK.ircont.o4a})}\right) \\
&  =\left(  s_{i}\cdot\operatorname*{ircont}\left(  T\right)  \right)
_{p}\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.thm.BK.ircont.o1})}\right)
.
\end{align*}
Thus, $\left(  \operatorname*{ircont}\left(  \mathbf{B}_{i}\left(  T\right)
\right)  \right)  _{p}=\left(  s_{i}\cdot\operatorname*{ircont}\left(
T\right)  \right)  _{p}$ is proven. This completes our proof of
(\ref{pf.thm.BK.ircont.goal1}).

Now, both (\ref{eq.thm.BK.ceq}) and (\ref{eq.thm.BK.ircont}) are proven. This
completes the proof of Theorem \ref{thm.BK} using Lemma \ref{lem.BKi}.
\end{proof}
\end{verlong}

\section{\label{sect.diamond}A diamond lemma}

\subsection{The lemma}

By now we have derived Theorem \ref{thm.BK} from Lemma \ref{lem.BKi}, and
Lemma \ref{lem.BKi} from Lemma \ref{lem.BK}. In order to complete the puzzle,
we need to prove Lemma \ref{lem.BK}. To do so, let us first state a simple lemma.

\begin{lemma}
\label{lem.diamond}Let $\mathbf{S}$ be a finite set. Let $\ell:\mathbf{S}%
\rightarrow\mathbb{N}$ be a map. Let $\Rrightarrow$ be a binary relation on
the set $\mathbf{S}$. (We shall write this relation in infix form; i.e., we
will write \textquotedblleft$a\Rrightarrow b$\textquotedblright\ to mean
\textquotedblleft$\left(  a,b\right)  $ belongs to the relation $\Rrightarrow
$\textquotedblright.)

Define a new binary relation $\overset{\ast}{\Rrightarrow}$ on $\mathbf{S}$
(also written in infix form) as follows: For two elements $a\in\mathbf{S}$ and
$b\in\mathbf{S}$, we set $a\overset{\ast}{\Rrightarrow}b$ if and only if there
exists a sequence $\left(  a_{0},a_{1},\ldots,a_{n}\right)  $ of elements of
$\mathbf{S}$ such that $a_{0}=a$ and $a_{n}=b$ and such that every
$i\in\left\{  0,1,\ldots,n-1\right\}  $ satisfies $a_{i}\Rrightarrow a_{i+1}$.
(In other words, we define $\overset{\ast}{\Rrightarrow}$ as the
reflexive-and-transitive closure of the relation $\Rrightarrow$.)

Assume that the following two hypotheses are true:

\begin{itemize}
\item The \textit{local confluence hypothesis}: If $a$, $b$ and $c$ are three
elements of $\mathbf{S}$ satisfying $a\Rrightarrow b$ and $a\Rrightarrow c$,
then there exists a $d\in\mathbf{S}$ such that $b\overset{\ast}{\Rrightarrow
}d$ and $c\overset{\ast}{\Rrightarrow}d$.

\item The \textit{length-decrease hypothesis}: If $a\in\mathbf{S}$ and
$b\in\mathbf{S}$ are two elements satisfying $a\Rrightarrow b$, then
$\ell\left(  a\right)  >\ell\left(  b\right)  $.
\end{itemize}

We say that an element $a\in\mathbf{S}$ is \textit{final} if there exists no
$b\in\mathbf{S}$ satisfying $a\Rrightarrow b$.

Then, for every $a\in\mathbf{S}$, there exists a unique final element
$b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$.
\end{lemma}

Lemma \ref{lem.diamond} is an easy particular case of what is called
\textit{Newman's lemma} (see, e.g., \cite{BezCoq}, or \cite[Lemma 2.7.2 + Fact
2.1.7]{BaaNip98}).\footnote{In the general version, the finiteness of
$\mathbf{S}$ and the length-decrease hypothesis are replaced by a requirement
that there exist no infinite sequences $\left(  a_{0},a_{1},a_{2}%
,\ldots\right)  \in\mathbf{S}^{\infty}$ such that every $i\in\mathbb{N}$
satisfies $a_{i}\Rrightarrow a_{i+1}$. The proof of this generalization is
harder than that of Lemma \ref{lem.diamond}, and not constructive. While there
is a constructive reformulation of this generalization (presented in
\cite[Lemma 3.3]{BezCoq}), we do not have a use for it in this paper.} (Some
authors refer to Newman's lemma as the \textit{diamond lemma}, but the latter
name is shared with at least one different fact.)

For the sake of completeness, we shall give the simple proof of Lemma
\ref{lem.diamond}.

\begin{vershort}
\begin{proof}
[Proof of Lemma \ref{lem.diamond}.]The relation $\overset{\ast}{\Rrightarrow}$
is the reflexive-and-transitive closure of the relation $\Rrightarrow$. This
yields the following properties (all of which are easy to check):

\begin{itemize}
\item The relation $\overset{\ast}{\Rrightarrow}$ is reflexive and transitive
and extends the relation $\Rrightarrow$.

\item If $a\in\mathbf{S}$ and $b\in\mathbf{S}$ are elements satisfying
$a\overset{\ast}{\Rrightarrow}b$ and $a\neq b$, then%
\begin{equation}
\text{there exists a }c\in\mathbf{S}\text{ such that }a\Rrightarrow c\text{
and }c\overset{\ast}{\Rrightarrow}b. \label{pf.lem.diamond.short.lem1}%
\end{equation}


\item We have%
\begin{equation}
\ell\left(  a\right)  \geq\ell\left(  b\right)  \ \ \ \ \ \ \ \ \ \ \text{for
any }a\in\mathbf{S}\text{ and }b\in\mathbf{S}\text{ satisfying }%
a\overset{\ast}{\Rrightarrow}b \label{pf.lem.diamond.short.lem2}%
\end{equation}
(because of the length-decrease hypothesis).
\end{itemize}

Now, we need to show that, for every $a\in\mathbf{S}$,
\begin{equation}
\text{there exists a unique final element }b\in\mathbf{S}\text{ such that
}a\overset{\ast}{\Rrightarrow}b\text{.} \label{pf.lem.diamond.short.goal}%
\end{equation}


\textit{Proof of (\ref{pf.lem.diamond.short.goal}):} We shall prove
(\ref{pf.lem.diamond.short.goal}) by strong induction over $\ell\left(
a\right)  $.

\textit{Induction step:} Let $N\in\mathbb{N}$. Assume (as the induction
hypothesis) that (\ref{pf.lem.diamond.short.goal}) is proven for every
$a\in\mathbf{S}$ satisfying $\ell\left(  a\right)  <N$. We need to prove that
(\ref{pf.lem.diamond.short.goal}) holds for every $a\in\mathbf{S}$ satisfying
$\ell\left(  a\right)  =N$.

Let $a\in\mathbf{S}$ be such that $\ell\left(  a\right)  =N$. We need to show
that (\ref{pf.lem.diamond.short.goal}) holds for this $a$.

If there exists no $c\in\mathbf{S}$ satisfying $a\Rrightarrow c$, then
(\ref{pf.lem.diamond.short.goal}) holds\footnote{\textit{Proof.} Assume that
there exists no $c\in\mathbf{S}$ satisfying $a\Rrightarrow c$. Then, $a$
itself is final. Hence, there exists a final element $b\in\mathbf{S}$ such
that $a\overset{\ast}{\Rrightarrow}b$ (namely, $b=a$). This $b$ is unique,
because (\ref{pf.lem.diamond.short.lem1}) shows that every $b\in\mathbf{S}$
satisfying $a\overset{\ast}{\Rrightarrow}b$ and $a\neq b$ would have to
satisfy $a\Rrightarrow c$. This proves (\ref{pf.lem.diamond.short.goal}).}.
Hence, for the rest of this proof, we WLOG assume that there exists some
$c\in\mathbf{S}$ satisfying $a\Rrightarrow c$. Let us denote this $c$ by
$c_{1}$. Thus, $c_{1}\in\mathbf{S}$ and\textbf{ }$a\Rrightarrow c_{1}$.
Applying the length-decrease hypothesis to $b=c_{1}$, we thus obtain
$\ell\left(  a\right)  >\ell\left(  c_{1}\right)  $, so that $\ell\left(
c_{1}\right)  <\ell\left(  a\right)  =N$. Thus, we can apply
(\ref{pf.lem.diamond.short.goal}) to $c_{1}$ instead of $a$ (according to the
induction hypothesis). As a result, we conclude that there exists a unique
final element $b\in\mathbf{S}$ such that $c_{1}\overset{\ast}{\Rrightarrow}b$.
Let us denote this $b$ by $b_{1}$. Thus, $b_{1}$ is a final element of
$\mathbf{S}$ such that $c_{1}\overset{\ast}{\Rrightarrow}b_{1}$.

Since $a\Rrightarrow c_{1}$, we have $a\overset{\ast}{\Rrightarrow}c_{1}$
(since the relation $\overset{\ast}{\Rrightarrow}$ extends the relation
$\Rrightarrow$). Combining this with $c_{1}\overset{\ast}{\Rrightarrow}b_{1}$,
we obtain $a\overset{\ast}{\Rrightarrow}b_{1}$ (since the relation
$\overset{\ast}{\Rrightarrow}$ is transitive). Thus, there exists a final
element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$ (namely,
$b=b_{1}$). We shall now prove that such a $b$ is unique.

Indeed, let $b_{2}$ be any final element $b\in\mathbf{S}$ such that
$a\overset{\ast}{\Rrightarrow}b$. Thus, $b_{2}$ is a final element of
$\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b_{2}$. We will prove
that $b_{2}=b_{1}$.

It is easy to see that $a\neq b_{2}$ (because $a\Rrightarrow c_{1}$ shows that
$a$ is not final, but $b_{2}$ is final). Hence,
(\ref{pf.lem.diamond.short.lem1}) (applied to $b=b_{2}$) yields that there
exists a $c\in\mathbf{S}$ such that $a\Rrightarrow c$ and $c\overset{\ast
}{\Rrightarrow}b_{2}$. Let us denote this $c$ by $c_{2}$. Then, $c_{2}$ is an
element of $\mathbf{S}$ such that $a\Rrightarrow c_{2}$ and $c_{2}%
\overset{\ast}{\Rrightarrow}b_{2}$.

The local confluence hypothesis (applied to $c_{1}$ and $c_{2}$ instead of $b$
and $c$) shows that there exists a $d\in\mathbf{S}$ such that $c_{1}%
\overset{\ast}{\Rrightarrow}d$ and $c_{2}\overset{\ast}{\Rrightarrow}d$.
Consider such a $d$. Applying (\ref{pf.lem.diamond.short.lem2}) to $c_{1}$ and
$d$ instead of $a$ and $b$, we obtain $\ell\left(  c_{1}\right)  \geq
\ell\left(  d\right)  $, so that $\ell\left(  d\right)  \leq\ell\left(
c_{1}\right)  <N$. Hence, we can apply (\ref{pf.lem.diamond.short.goal}) to
$d$ instead of $a$ (according to the induction hypothesis). As a result, we
conclude that there exists a unique final element $b\in\mathbf{S}$ such that
$d\overset{\ast}{\Rrightarrow}b$. Let us denote this $b$ by $e$. Thus, $e$ is
a final element of $\mathbf{S}$ such that $d\overset{\ast}{\Rrightarrow}e$.

We have $c_{1}\overset{\ast}{\Rrightarrow}d$ and $d\overset{\ast
}{\Rrightarrow}e$. Hence, $c_{1}\overset{\ast}{\Rrightarrow}e$ (since the
relation $\overset{\ast}{\Rrightarrow}$ is transitive). Thus, $e$ is a final
element of $\mathbf{S}$ such that $c_{1}\overset{\ast}{\Rrightarrow}e$. In
other words, $e$ is a final element $b\in\mathbf{S}$ such that $c_{1}%
\overset{\ast}{\Rrightarrow}b$. Since we already know that $b_{1}$ is the
unique such element $b$ (in fact, this how we defined $b_{1}$), this shows
that $e=b_{1}$.

We have $c_{2}\overset{\ast}{\Rrightarrow}d$ and $d\overset{\ast
}{\Rrightarrow}e$. Hence, $c_{2}\overset{\ast}{\Rrightarrow}e$ (since the
relation $\overset{\ast}{\Rrightarrow}$ is transitive). In other words,
$c_{2}\overset{\ast}{\Rrightarrow}b_{1}$ (since $e=b_{1}$). Hence, $b_{1}$ is
a final element of $\mathbf{S}$ such that $c_{2}\overset{\ast}{\Rrightarrow
}b_{1}$. In other words, $b_{1}$ is a final element $b\in\mathbf{S}$ such that
$c_{2}\overset{\ast}{\Rrightarrow}b$. Also, $b_{2}$ is a final element
$b\in\mathbf{S}$ such that $c_{2}\overset{\ast}{\Rrightarrow}b$ (since $b_{2}$
is final and since $c_{2}\overset{\ast}{\Rrightarrow}b_{2}$).

But applying the length-decrease hypothesis to $b=c_{2}$, we obtain
$\ell\left(  a\right)  >\ell\left(  c_{2}\right)  $ (since $a\Rrightarrow
c_{2}$), so that $\ell\left(  c_{2}\right)  <\ell\left(  a\right)  =N$. Thus,
we can apply (\ref{pf.lem.diamond.short.goal}) to $c_{2}$ instead of $a$
(according to the induction hypothesis). As a result, we conclude that there
exists a unique final element $b\in\mathbf{S}$ such that $c_{2}\overset{\ast
}{\Rrightarrow}b$. The \textquotedblleft uniqueness\textquotedblright\ part of
this result gives us $b_{2}=b_{1}$ (since both $b_{2}$ and $b_{1}$ are final
elements $b\in\mathbf{S}$ such that $c_{2}\overset{\ast}{\Rrightarrow}b$).

Now let us forget that we fixed $b_{2}$. We thus have shown that if $b_{2}$ is
any final element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$,
then $b_{2}=b_{1}$. Hence, there exists at most one final element
$b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$. As a consequence,
there exists a unique final element $b\in\mathbf{S}$ such that $a\overset{\ast
}{\Rrightarrow}b$ (because we already know that there exists such a $b$). In
other words, (\ref{pf.lem.diamond.short.goal}) holds. This completes the
induction step. The induction proof of (\ref{pf.lem.diamond.short.goal}) is
thus complete. In other words, Lemma \ref{lem.diamond} is proven.
\end{proof}
\end{vershort}

\begin{verlong}
\begin{proof}
[Proof of Lemma \ref{lem.diamond}.]We first notice that if $a\in\mathbf{S}$
and $b\in\mathbf{S}$ are elements satisfying $a\overset{\ast}{\Rrightarrow}b$
and $a\neq b$, then%
\begin{equation}
\text{there exists a }c\in\mathbf{S}\text{ such that }a\Rrightarrow c\text{
and }c\overset{\ast}{\Rrightarrow}b. \label{pf.lem.diamond.lem1}%
\end{equation}
\footnote{\textit{Proof of (\ref{pf.lem.diamond.lem1}):} Let $a\in\mathbf{S}$
and $b\in\mathbf{S}$ be elements satisfying $a\overset{\ast}{\Rrightarrow}b$
and $a\neq b$. We have $a\overset{\ast}{\Rrightarrow}b$. According to the
definition of the relation $\overset{\ast}{\Rrightarrow}$, this means that
there exists a sequence $\left(  a_{0},a_{1},\ldots,a_{n}\right)  $ of
elements of $\mathbf{S}$ such that $a_{0}=a$ and $a_{n}=b$ and such that every
$i\in\left\{  0,1,\ldots,n-1\right\}  $ satisfies $a_{i}\Rrightarrow a_{i+1}$.
Let us denote this sequence $\left(  a_{0},a_{1},\ldots,a_{n}\right)  $ by
$\left(  c_{0},c_{1},\ldots,c_{N}\right)  $. Then, $\left(  c_{0},c_{1}%
,\ldots,c_{N}\right)  $ is a sequence of elements of $\mathbf{S}$ such that
$c_{0}=a$ and $c_{N}=b$ and such that every $i\in\left\{  0,1,\ldots
,N-1\right\}  $ satisfies $c_{i}\Rrightarrow c_{i+1}$.
\par
We have $c_{0}=a\neq b=c_{N}$, so that $0\neq N$ and thus $N\geq1$. Hence,
$c_{1}$ is well-defined. Recall that every $i\in\left\{  0,1,\ldots
,N-1\right\}  $ satisfies $c_{i}\Rrightarrow c_{i+1}$. Applying this to $i=0$,
we obtain $c_{0}\Rrightarrow c_{1}$. Since $c_{0}=a$, this rewrites as
$a\Rrightarrow c_{1}$.
\par
Recall again that every $i\in\left\{  0,1,\ldots,N-1\right\}  $ satisfies
$c_{i}\Rrightarrow c_{i+1}$. Thus, every $i\in\left\{  0,1,\ldots,\left(
N-1\right)  -1\right\}  $ satisfies $c_{i+1}\Rrightarrow c_{\left(
i+1\right)  +1}$. Also, $c_{0+1}=c_{1}$ and $c_{\left(  N-1\right)  +1}%
=c_{N}=b$. Hence, there exists a sequence $\left(  a_{0},a_{1},\ldots
,a_{n}\right)  $ of elements of $\mathbf{S}$ such that $a_{0}=c_{1}$ and
$a_{n}=b$ and such that every $i\in\left\{  0,1,\ldots,n-1\right\}  $
satisfies $a_{i}\Rrightarrow a_{i+1}$ (namely, we can take $n=N-1$ and
$a_{i}=c_{i+1}$). According to the definition of the relation $\overset{\ast
}{\Rrightarrow}$, this means precisely that $c_{1}\overset{\ast}{\Rrightarrow
}b$. We thus have shown that $c_{1}\overset{\ast}{\Rrightarrow}b$.
\par
Thus, there exists a $c\in\mathbf{S}$ such that $a\Rrightarrow c$ and
$c\overset{\ast}{\Rrightarrow}b$ (namely, $c=c_{1}$). This proves
(\ref{pf.lem.diamond.lem1}).}

The relation $\overset{\ast}{\Rrightarrow}$ is the reflexive-and-transitive
closure of the relation $\Rrightarrow$.\ \ \ \ \footnote{Indeed, this is just
a restatement of our definition of the relation $\overset{\ast}{\Rrightarrow}%
$.} Thus, the relation $\overset{\ast}{\Rrightarrow}$ is reflexive and
transitive and extends the relation $\Rrightarrow$. Also,%
\begin{equation}
\ell\left(  a\right)  \geq\ell\left(  b\right)  \ \ \ \ \ \ \ \ \ \ \text{for
any }a\in\mathbf{S}\text{ and }b\in\mathbf{S}\text{ satisfying }%
a\overset{\ast}{\Rrightarrow}b. \label{pf.lem.diamond.lem2}%
\end{equation}
\footnote{\textit{Proof of (\ref{pf.lem.diamond.lem2}):} Let $a\in\mathbf{S}$
and $b\in\mathbf{S}$ be elements satisfying $a\overset{\ast}{\Rrightarrow}b$.
We have $a\overset{\ast}{\Rrightarrow}b$. According to the definition of the
relation $\overset{\ast}{\Rrightarrow}$, this means that there exists a
sequence $\left(  a_{0},a_{1},\ldots,a_{n}\right)  $ of elements of
$\mathbf{S}$ such that $a_{0}=a$ and $a_{n}=b$ and such that every
$i\in\left\{  0,1,\ldots,n-1\right\}  $ satisfies $a_{i}\Rrightarrow a_{i+1}$.
Consider this sequence $\left(  a_{0},a_{1},\ldots,a_{n}\right)  $. For every
$i\in\left\{  0,1,\ldots,n-1\right\}  $, we have $a_{i}\Rrightarrow a_{i+1}$
and thus $\ell\left(  a_{i}\right)  >\ell\left(  a_{i+1}\right)  $ (by the
length-decrease hypothesis, applied to $a_{i}$ and $a_{i+1}$ instead of $a$
and $b$). Hence,%
\[
\ell\left(  a_{0}\right)  >\ell\left(  a_{1}\right)  >\cdots>\ell\left(
a_{n}\right)  .
\]
Thus, $\ell\left(  a_{0}\right)  \geq\ell\left(  a_{n}\right)  $. Since
$a_{0}=a$ and $a_{n}=b$, this rewrites as $\ell\left(  a\right)  \geq
\ell\left(  b\right)  $. This proves (\ref{pf.lem.diamond.lem2}).}

We need to show that, for every $a\in\mathbf{S}$,
\begin{equation}
\text{there exists a unique final element }b\in\mathbf{S}\text{ such that
}a\overset{\ast}{\Rrightarrow}b\text{.} \label{pf.lem.diamond.goal}%
\end{equation}


\textit{Proof of (\ref{pf.lem.diamond.goal}):} We shall prove
(\ref{pf.lem.diamond.goal}) by strong induction over $\ell\left(  a\right)  $.

\textit{Induction step:} Let $N\in\mathbb{N}$. Assume (as the induction
hypothesis) that (\ref{pf.lem.diamond.goal}) is proven for every
$a\in\mathbf{S}$ satisfying $\ell\left(  a\right)  <N$. We need to prove that
(\ref{pf.lem.diamond.goal}) holds for every $a\in\mathbf{S}$ satisfying
$\ell\left(  a\right)  =N$.

Let $a\in\mathbf{S}$ be such that $\ell\left(  a\right)  =N$. We need to show
that (\ref{pf.lem.diamond.goal}) holds for this $a$.

If there exists no $c\in\mathbf{S}$ satisfying $a\Rrightarrow c$, then
(\ref{pf.lem.diamond.goal}) holds\footnote{\textit{Proof.} Assume that there
exists no $c\in\mathbf{S}$ satisfying $a\Rrightarrow c$. In other words, there
exists no $b\in\mathbf{S}$ satisfying $a\Rrightarrow b$. In other words, $a$
is final (according to the definition of \textquotedblleft
final\textquotedblright).
\par
Notice that $a\overset{\ast}{\Rrightarrow}a$ (since the relation
$\overset{\ast}{\Rrightarrow}$ is reflexive). Hence, there exists a final
element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$ (namely,
$b=a$). We shall now show that this $b$ is unique.
\par
Indeed, let $b$ be any final element of $\mathbf{S}$ such that $a\overset{\ast
}{\Rrightarrow}b$. Assume (for the sake of contradiction) that $b\neq a$.
Then, $a\neq b$. Hence, there exists a $c\in\mathbf{S}$ such that
$a\Rrightarrow c$ and $c\overset{\ast}{\Rrightarrow}b$ (according to
(\ref{pf.lem.diamond.lem1})). This contradicts the fact that there exists no
$c\in\mathbf{S}$ satisfying $a\Rrightarrow c$. Hence, our assumption (that
$b\neq a$) was wrong. Thus we must have $b=a$.
\par
Now, let us forget that we fixed $b$. We thus have shown that every final
element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$ must
satisfy $b=a$. Thus, there exists at most one final element $b\in\mathbf{S}$
such that $a\overset{\ast}{\Rrightarrow}b$. Thus, there exists a unique final
element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$ (since we
know that there exists such a $b$). In other words, (\ref{pf.lem.diamond.goal}%
) holds, qed.}. Hence, for the rest of this proof, we WLOG assume that there
exists some $c\in\mathbf{S}$ satisfying $a\Rrightarrow c$. Let us denote this
$c$ by $c_{1}$. Thus, $c_{1}$ is an element of $\mathbf{S}$ satisfying
$a\Rrightarrow c_{1}$. Applying the length-decrease hypothesis to $b=c_{1}$,
we thus obtain $\ell\left(  a\right)  >\ell\left(  c_{1}\right)  $, so that
$\ell\left(  c_{1}\right)  <\ell\left(  a\right)  =N$. Thus, we can apply
(\ref{pf.lem.diamond.goal}) to $c_{1}$ instead of $a$ (according to the
induction hypothesis). As a result, we conclude that there exists a unique
final element $b\in\mathbf{S}$ such that $c_{1}\overset{\ast}{\Rrightarrow}b$.
Let us denote this $b$ by $b_{1}$. Thus, $b_{1}$ is a final element of
$\mathbf{S}$ such that $c_{1}\overset{\ast}{\Rrightarrow}b_{1}$.

Since $a\Rrightarrow c_{1}$, we have $a\overset{\ast}{\Rrightarrow}c_{1}$
(since the relation $\overset{\ast}{\Rrightarrow}$ extends the relation
$\Rrightarrow$). Combining this with $c_{1}\overset{\ast}{\Rrightarrow}b_{1}$,
we obtain $a\overset{\ast}{\Rrightarrow}b_{1}$ (since the relation
$\overset{\ast}{\Rrightarrow}$ is transitive). Thus, there exists a final
element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$ (namely,
$b=b_{1}$). We shall now prove that such a $b$ is unique.

Indeed, let $b_{2}$ be any final element $b\in\mathbf{S}$ such that
$a\overset{\ast}{\Rrightarrow}b$. Thus, $b_{2}$ is a final element of
$\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b_{2}$. We will prove
that $b_{2}=b_{1}$.

It is easy to see that $a\neq b_{2}$\ \ \ \ \footnote{\textit{Proof.} Assume
the contrary. Then, $a=b_{2}$. Hence, $a$ is final (since $b_{2}$ is final).
In other words, there exists no $b\in\mathbf{S}$ satisfying $a\Rrightarrow b$
(according to the definition of \textquotedblleft final\textquotedblright).
This contradicts the fact that $c_{1}$ is such a $b$ (because $c_{1}%
\in\mathbf{S}$ satisfies $a\Rrightarrow c_{1}$). This contradiction proves
that our assumption was wrong, qed.}. Hence, (\ref{pf.lem.diamond.lem1})
(applied to $b=b_{2}$) yields that there exists a $c\in\mathbf{S}$ such that
$a\Rrightarrow c$ and $c\overset{\ast}{\Rrightarrow}b_{2}$. Let us denote this
$c$ by $c_{2}$. Then, $c_{2}$ is an element of $\mathbf{S}$ such that
$a\Rrightarrow c_{2}$ and $c_{2}\overset{\ast}{\Rrightarrow}b_{2}$.

The local confluence hypothesis (applied to $c_{1}$ and $c_{2}$ instead of $b$
and $c$) shows that there exists a $d\in\mathbf{S}$ such that $c_{1}%
\overset{\ast}{\Rrightarrow}d$ and $c_{2}\overset{\ast}{\Rrightarrow}d$.
Consider such a $d$. Applying (\ref{pf.lem.diamond.lem2}) to $c_{1}$ and $d$
instead of $a$ and $b$, we obtain $\ell\left(  c_{1}\right)  \geq\ell\left(
d\right)  $, so that $\ell\left(  d\right)  \leq\ell\left(  c_{1}\right)  <N$.
Hence, we can apply (\ref{pf.lem.diamond.goal}) to $d$ instead of $a$
(according to the induction hypothesis). As a result, we conclude that there
exists a unique final element $b\in\mathbf{S}$ such that $d\overset{\ast
}{\Rrightarrow}b$. Let us denote this $b$ by $e$. Thus, $e$ is a final element
of $\mathbf{S}$ such that $d\overset{\ast}{\Rrightarrow}e$.

We have $c_{1}\overset{\ast}{\Rrightarrow}d$ and $d\overset{\ast
}{\Rrightarrow}e$. Hence, $c_{1}\overset{\ast}{\Rrightarrow}e$ (since the
relation $\overset{\ast}{\Rrightarrow}$ is transitive). Thus, $e$ is a final
element of $\mathbf{S}$ such that $c_{1}\overset{\ast}{\Rrightarrow}e$. In
other words, $e$ is a final element $b\in\mathbf{S}$ such that $c_{1}%
\overset{\ast}{\Rrightarrow}b$. Since we already know that $b_{1}$ is the
unique such element $b$ (in fact, this how we defined $b_{1}$), this shows
that $e=b_{1}$.

We have $c_{2}\overset{\ast}{\Rrightarrow}d$ and $d\overset{\ast
}{\Rrightarrow}e$. Hence, $c_{2}\overset{\ast}{\Rrightarrow}e$ (since the
relation $\overset{\ast}{\Rrightarrow}$ is transitive). In other words,
$c_{2}\overset{\ast}{\Rrightarrow}b_{1}$ (since $e=b_{1}$). Hence, $b_{1}$ is
a final element of $\mathbf{S}$ such that $c_{2}\overset{\ast}{\Rrightarrow
}b_{1}$. In other words, $b_{1}$ is a final element $b\in\mathbf{S}$ such that
$c_{2}\overset{\ast}{\Rrightarrow}b$. Also, $b_{2}$ is a final element
$b\in\mathbf{S}$ such that $c_{2}\overset{\ast}{\Rrightarrow}b$ (since $b_{2}$
is final and since $c_{2}\overset{\ast}{\Rrightarrow}b_{2}$).

But applying the length-decrease hypothesis to $b=c_{2}$, we obtain
$\ell\left(  a\right)  >\ell\left(  c_{2}\right)  $ (since $a\Rrightarrow
c_{2}$), so that $\ell\left(  c_{2}\right)  <\ell\left(  a\right)  =N$. Thus,
we can apply (\ref{pf.lem.diamond.goal}) to $c_{2}$ instead of $a$ (according
to the induction hypothesis). As a result, we conclude that there exists a
unique final element $b\in\mathbf{S}$ such that $c_{2}\overset{\ast
}{\Rrightarrow}b$. Hence, if $b^{\prime}$ and $b^{\prime\prime}$ are two final
elements $b\in\mathbf{S}$ such that $c_{2}\overset{\ast}{\Rrightarrow}b$, then
$b^{\prime}=b^{\prime\prime}$. Applying this to $b^{\prime}=b_{1}$ and
$b^{\prime\prime}=b_{2}$, we obtain $b_{1}=b_{2}$. That is, $b_{2}=b_{1}$.

Now let us forget that we fixed $b_{2}$. We thus have shown that if $b_{2}$ is
any final element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$,
then $b_{2}=b_{1}$. Hence, there exists at most one final element
$b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$. As a consequence,
there exists a unique final element $b\in\mathbf{S}$ such that $a\overset{\ast
}{\Rrightarrow}b$ (because we already know that there exists such a $b$). In
other words, (\ref{pf.lem.diamond.goal}) holds. This completes the induction
step. The induction proof of (\ref{pf.lem.diamond.goal}) is thus complete. In
other words, Lemma \ref{lem.diamond} is proven.
\end{proof}
\end{verlong}

\subsection{\label{subsect.bubble}Example: Sorting $n$-tuples by local
transpositions}

Let us give a simple example of an application of Lemma \ref{lem.diamond}.
This example (which will take up the whole Subsection~\ref{subsect.bubble})
will not be used in the rest of the paper, but it serves as a kind of
prototype that our proof of Lemma \ref{lem.BK} imitates, and so might help
clarifying the latter proof.

All of the definitions and conventions that will be made in this
Subsection~\ref{subsect.bubble} are supposed to stand only for this
Subsection. (In particular, the meanings of the letter $\mathbf{S}$ and the
symbol $\Rrightarrow$ will later be used for completely different things.)

For the rest of Subsection~\ref{subsect.bubble}, we fix $n\in\mathbb{N}$, and
we fix a poset $P$.

For any $n$-tuple $z\in P^{n}$ and every $i\in\left\{  1,2,\ldots,n\right\}
$, we use the notation $z_{i}$ to denote the $i$-th entry of $z$. (Thus,
$z=\left(  z_{1},z_{2},\ldots,z_{n}\right)  $ for every $z\in P^{n}$.)

Before we go into further details, let us informally explain what we will
prove in the following. Imagine that we start with some $n$-tuple $z=\left(
z_{1},z_{2},\ldots,z_{n}\right)  $ of elements of $P$, and we want to
\textquotedblleft sort it in nondecreasing order\textquotedblright. We do
this\ by repeatedly picking an index $k\in\left\{  1,2,\ldots,n-1\right\}  $
satisfying $z_{k}>z_{k+1}$, and switching the entries $z_{k}$ and $z_{k+1}$ in
the tuple, and continuing in the same way until we can no longer find such a
$k$.\ \ \ \ \footnote{Here is an example: If $P$ is the four-element poset
$\left\{  a,b,c,d\right\}  $ with relations $a<b<d$ and $a<c<d$, if $n=6$, and
if $z=\left(  d,b,d,c,a,b\right)  $, then our sorting process can look as
follows:%
\begin{align*}
\left(  \underline{d,b},d,c,a,b\right)   &  \rightarrow\left(
b,d,\underline{d,c},a,b\right)  \rightarrow\left(  b,\underline{d,c}%
,d,a,b\right)  \rightarrow\left(  b,c,d,\underline{d,a},b\right)
\rightarrow\left(  b,c,\underline{d,a},d,b\right) \\
&  \rightarrow\left(  b,\underline{c,a},d,d,b\right)  \rightarrow\left(
\underline{b,a},c,d,d,b\right)  \rightarrow\left(  a,b,c,d,\underline{d,b}%
\right)  \rightarrow\left(  a,b,c,\underline{d,b},d\right) \\
&  \rightarrow\left(  a,b,c,b,d,d\right)
\end{align*}
(where an underline under two adjacent entries of a tuple means that these
entries are going to be switched in the nearest step). The final result
$\left(  a,b,c,b,d,d\right)  $ is \textquotedblleft sorted\textquotedblright%
\ in the sense that we can no longer find a $k\in\left\{  1,2,\ldots
,n-1\right\}  $ such that $z_{k}>z_{k+1}$.
\par
We notice that we had some freedom in performing our sorting process: e.g., we
could have started out by switching the $d$ with the $c$ in the $\left(
d,b,d,c,a,b\right)  $ rather than by switching the $d$ with the $b$.
\par
This is similar to the bubble sort algorithm, but there are two differences:
Firstly, $P$ is now a poset, not a totally ordered set (so we cannot hope to
get our $n$-tuple $z$ to satisfy $z_{1}\leq z_{2}\leq\cdots\leq z_{n}$ in the
end). Secondly, we are allowed to pick an index $k\in\left\{  1,2,\ldots
,n-1\right\}  $ satisfying $z_{k}>z_{k+1}$ arbitrarily (so our process is
nondeterministic), rather than having to scan the $n$-tuple from left to right
(in multiple passes) as in the classical bubble sort algorithm.} It is easy to
see that this process will eventually terminate, leaving behind an $n$-tuple
$z$ such that no $k\in\left\{  1,2,\ldots,n-1\right\}  $ satisfies
$z_{k}>z_{k+1}$ (although, in general, it will not satisfy $z_{1}\leq
z_{2}\leq\cdots\leq z_{n}$, as $P$ is only partially ordered). But a priori,
it is not clear whether this resulting $n$-tuple could depend on the choices
we made in the \textquotedblleft sorting\textquotedblright%
\ process\footnote{Namely, at every step of our process, we had to choose an
index $k\in\left\{  1,2,\ldots,n-1\right\}  $ satisfying $z_{k}>z_{k+1}$.
Whenever this index $k$ was not unique, we had freedom in choosing one of them
to start with. These choices have an effect on the \textquotedblleft
sorting\textquotedblright\ process, and so it would not be surprising if the
final result would depend on them too.}. It turns out that it does not, but
this is not completely trivial. We shall now formalize this fact. We prefer
not to talk about processes, nor to regard $z$ as mutable; instead, we will
introduce a binary relation on the set of all permutations of a given
$n$-tuple, which will model the idea of a \textquotedblleft
step\textquotedblright\ of our \textquotedblleft sorting\textquotedblright\ process.

For every $k\in\left\{  1,2,\ldots,n-1\right\}  $, let $s_{k}$ be the
transposition $\left(  k,k+1\right)  \in\mathfrak{S}_{n}$. The group
$\mathfrak{S}_{n}$ acts on $P^{n}$ by permuting the coordinates:%
\[
\sigma\cdot z=\left(  z_{\sigma^{-1}\left(  1\right)  },z_{\sigma^{-1}\left(
2\right)  },\ldots,z_{\sigma^{-1}\left(  n\right)  }\right)
\ \ \ \ \ \ \ \ \ \ \text{for all }\sigma\in\mathfrak{S}_{n}\text{ and }z\in
P^{n}.
\]
In particular, for each $k\in\left\{  1,2,\ldots,n-1\right\}  $ and $z\in
P^{n}$, the $n$-tuple $s_{k}\cdot z$ is obtained from $z$ by switching the
$k$-th and the $\left(  k+1\right)  $-th entries.

\begin{definition}
Fix $w\in P^{n}$. Let $\mathbf{S}$ be the set of all permutations of $w$.
Clearly, $\mathbf{S}$ is a finite set (having at most $n!$ elements).
Moreover, $\mathbf{S}$ is an $\mathfrak{S}_{n}$-subset of the $\mathfrak{S}%
_{n}$-set $P^{n}$.

Let us define a binary relation $\Rrightarrow$ on this set $\mathbf{S}$ as
follows: Let $a\in\mathbf{S}$ and $b\in\mathbf{S}$. If $k\in\left\{
1,2,\ldots,n-1\right\}  $, then we write $a\underset{k}{\Rrightarrow}b$ if and
only if $a_{k}>a_{k+1}$ and $b=s_{k}\cdot a$. We write $a\Rrightarrow b$ if
and only if there exists an $k\in\left\{  1,2,\ldots,n-1\right\}  $ such that
$a\underset{k}{\Rrightarrow}b$. (In other words, we write $a\Rrightarrow b$ if
and only if the $n$-tuple $b$ can be obtained from $a$ by switching two
adjacent entries which are out of order in $a$. Here, we say that two entries
of $a$ are \textit{out of order} if the left one is greater than the right
one.) Thus, the relation $\Rrightarrow$ is defined.
\end{definition}

For example, if $n=5$, $P=\mathbb{Z}$ and $w=\left(  3,1,6,3,5\right)  $, then
$\left(  1,6,3,5,3\right)  \underset{2}{\Rrightarrow}\left(  1,3,6,5,3\right)
$ (and thus $\left(  1,6,3,5,3\right)  \Rrightarrow\left(  1,3,6,5,3\right)
$) but not $\left(  1,6,3,5,3\right)  \underset{3}{\Rrightarrow}\left(
1,6,5,3,3\right)  $ (since we required $a_{k}>a_{k+1}$ when defining
$a\underset{k}{\Rrightarrow}b$).

We define a binary relation $\overset{\ast}{\Rrightarrow}$ on $\mathbf{S}$ as
in Lemma \ref{lem.diamond}. This relation $\overset{\ast}{\Rrightarrow}$ is
the reflexive-and-transitive closure of the relation $\Rrightarrow$. Thus, the
relation $\overset{\ast}{\Rrightarrow}$ is reflexive and transitive and
extends the relation $\Rrightarrow$.

\begin{vershort}
We also define the notion of a \textquotedblleft final\textquotedblright%
\ element of $\mathbf{S}$ as in Lemma \ref{lem.diamond}. Now, it is easy to
see that an element $u\in\mathbf{S}$ is final if and only if no $k\in\left\{
1,2,\ldots,n-1\right\}  $ satisfies $u_{k}>u_{k+1}$.
\end{vershort}

\begin{verlong}
We also define the notion of a \textquotedblleft final\textquotedblright%
\ element of $\mathbf{S}$ as in Lemma \ref{lem.diamond}. Now, it is easy to
see that an element $u\in\mathbf{S}$ is final if and only if no $k\in\left\{
1,2,\ldots,n-1\right\}  $ satisfies $u_{k}>u_{k+1}$%
.\ \ \ \ \footnote{\textit{Proof.} Let $u\in\mathbf{S}$. Assume that $u$ is
final. We want to prove that no $k\in\left\{  1,2,\ldots,n-1\right\}  $
satisfies $u_{k}>u_{k+1}$.
\par
Indeed, assume the contrary. Then, there exists some $k\in\left\{
1,2,\ldots,n-1\right\}  $ such that $u_{k}>u_{k+1}$. Consider this $k$. We
have $s_{k}\cdot u\in\mathbf{S}$ (since $\mathbf{S}$ is an $\mathfrak{S}_{n}%
$-subset of $P^{n}$) and thus $u\underset{k}{\Rrightarrow}s_{k}\cdot u$.
Hence, $u\Rrightarrow s_{k}\cdot u$.
\par
But $u$ is final. In other words, there exists no $b\in\mathbf{S}$ satisfying
$u\Rrightarrow b$ (according to the definition of \textquotedblleft
final\textquotedblright). This contradicts the fact that $s_{k}\cdot u$ is
such a $b$ (because $u\Rrightarrow s_{k}\cdot u$). This contradiction
concludes the proof that no $k\in\left\{  1,2,\ldots,n-1\right\}  $ satisfies
$u_{k}>u_{k+1}$.
\par
Now forget that we assumed $u$ to be final. We thus have shown that if $u$ is
final, then no $k\in\left\{  1,2,\ldots,n-1\right\}  $ satisfies
$u_{k}>u_{k+1}$. The proof of the converse implication is similar (essentially
we have to do the same arguments in the opposite order). Combining these
results, we conclude that $u$ is final if and only if no $k\in\left\{
1,2,\ldots,n-1\right\}  $ satisfies $u_{k}>u_{k+1}$. This is what we wanted to
prove.}
\end{verlong}

Now, we claim:

\begin{proposition}
\label{prop.diamond.example.poset}For every $a\in\mathbf{S}$, there exists a
unique final element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow
}b$.
\end{proposition}

In words, Proposition \ref{prop.diamond.example.poset} says that if we start
with some $n$-tuple $a\in\mathbf{S}$ and repeatedly switch adjacent entries of
$a$ which are out of order, then the procedure eventually terminates (i.e.,
eventually we will arrive at an $n$-tuple which has no two adjacent entries
that are out of order) and the resulting $n$-tuple does not depend on the
choices we made in the process (i.e., even if there were several choices of
adjacent entries to switch, they all lead to the same final
result).\footnote{Strictly speaking, Proposition
\ref{prop.diamond.example.poset} does not really say that the procedure
eventually terminates; but this will follow from the length-decrease
hypothesis in its proof below.} The only reason why we are working in
$\mathbf{S}$ instead of the whole set $P^{n}$ is that $\mathbf{S}$ is always
finite, which will make it easier for us to apply Lemma \ref{lem.diamond}.

\begin{remark}
It is important that we are switching adjacent entries of $a$. If we start
with some $n$-tuple $a\in\mathbf{S}$ and repeatedly switch entries of $a$
which are out of order but \textbf{not necessarily} adjacent, then the result
of this procedure (once it has terminated) might well depend on our choices.
(For instance, if $P$ is the poset $\left\{  1,2,2^{\prime}\right\}  $ with
relations $1<2$ and $1<2^{\prime}$, and if $n=3$ and $a=\left(  2,2^{\prime
},1\right)  $, then switching the first and the third entries leads to
$\left(  1,2^{\prime},2\right)  $, whereas switching the second and the third
entries and then switching the first and the second entries yields $\left(
1,2,2^{\prime}\right)  $; and these two results are both final and
nevertheless distinct.)
\end{remark}

Proposition \ref{prop.diamond.example.poset} is rather obvious in the case
when $P$ is totally ordered (indeed, in this case, the unique final element
$b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$ will simply be the
$n$-tuple obtained by rearranging $a$ in nondecreasing order). But let us
prove Proposition \ref{prop.diamond.example.poset} in the general case using
Lemma \ref{lem.diamond}.

\begin{proof}
[Proof of Proposition \ref{prop.diamond.example.poset}.]If $z\in P^{n}$, then
an \textit{inversion} of $z$ means a pair $\left(  i,j\right)  \in\left\{
1,2,\ldots,n\right\}  ^{2}$ with $i<j$ and $z_{i}>z_{j}$. For instance, if
$n=5$ and $P=\mathbb{Z}$ (as posets, where $\mathbb{Z}$ is equipped with the
usual order), then the inversions of $\left(  3,1,6,3,5\right)  $ are $\left(
1,2\right)  $, $\left(  3,4\right)  $ and $\left(  3,5\right)  $.

Define a map $\ell:P^{n}\rightarrow\mathbb{N}$ as follows: For every $z\in
P^{n}$, let $\ell\left(  z\right)  $ be the number of inversions of $z$.
Clearly, $\ell\left(  z\right)  \in\mathbb{N}$ and $\ell\left(  z\right)
\leq\dbinom{n}{2}$.

We need to show that for every $a\in\mathbf{S}$, there exists a unique final
element $b\in\mathbf{S}$ such that $a\overset{\ast}{\Rrightarrow}b$. According
to Lemma \ref{lem.diamond}, it is enough to check that the local confluence
hypothesis and the length-decrease hypothesis are satisfied\footnote{Both of
these hypotheses were stated in Lemma \ref{lem.diamond}.}.

\begin{vershort}
\textit{Proof that the length-decrease hypothesis is satisfied:} Let
$a\in\mathbf{S}$ and $b\in\mathbf{S}$ be such that $a\Rrightarrow b$. Then,
there exists a $k\in\left\{  1,2,\ldots,n-1\right\}  $ such that
$a\underset{k}{\Rrightarrow}b$ (since $a\Rrightarrow b$). Consider this $k$.
We have $a\underset{k}{\Rrightarrow}b$; in other words, $a_{k}>a_{k+1}$ and
$b=s_{k}\cdot a$. In other words, the $n$-tuple $b$ is obtained from $a$ by
switching the $k$-th and the $\left(  k+1\right)  $-th entry, which were out
of order in $a$. Thus, the pair $\left(  k,k+1\right)  $ is an inversion of
$a$, but not an inversion of $b$. Furthermore, $b_{s_{k}\left(  u\right)
}=a_{u}$ for every $u\in\left\{  1,2,\ldots,n\right\}  $ (since $b=s_{k}\cdot
a$), and furthermore, for any $\left(  i,j\right)  \in\left\{  1,2,\ldots
,n\right\}  ^{2}$ satisfying $i<j$, we have $s_{k}\left(  i\right)
<s_{k}\left(  j\right)  $ if $\left(  i,j\right)  \neq\left(  k,k+1\right)  $
(this is easy to prove by checking all possible cases). From the last two
observations, we can easily conclude that the inversions of $b$ are precisely
the pairs of the form $\left(  s_{k}\left(  i\right)  ,s_{k}\left(  j\right)
\right)  $ with $\left(  i,j\right)  $ being an inversion of $a$ satisfying
$\left(  i,j\right)  \neq\left(  k,k+1\right)  $. Thus, the number of
inversions of $b$ is one less than the number of inversions of $a$ (because
$\left(  k,k+1\right)  $ is an inversion of $a$, and thus its exclusion lowers
the count by $1$). In other words, $\ell\left(  b\right)  =\ell\left(
a\right)  -1$ (because $\ell\left(  z\right)  $ means the number of inversions
of $z$ whenever $z\in P^{n}$). Thus, $\ell\left(  a\right)  >\ell\left(
b\right)  $. Hence, the length-decrease hypothesis is proven.
\end{vershort}

\begin{verlong}
\textit{Proof that the length-decrease hypothesis is satisfied:} Let
$a\in\mathbf{S}$ and $b\in\mathbf{S}$ be such that $a\Rrightarrow b$. Then,
there exists a $k\in\left\{  1,2,\ldots,n-1\right\}  $ such that
$a\underset{k}{\Rrightarrow}b$ (since $a\Rrightarrow b$). Consider this $k$.
We have $a\underset{k}{\Rrightarrow}b$; in other words, $a_{k}>a_{k+1}$ and
$b=s_{k}\cdot a$ (since this is how $a\underset{k}{\Rrightarrow}b$ is
defined). It is then easy to see that the pair $\left(  k,k+1\right)  $ is an
inversion of $a$\ \ \ \ \footnote{\textit{Proof.} We have $k<k+1$ and
$a_{k}>a_{k+1}$. Hence, $\left(  k,k+1\right)  $ is an inversion of $a$,
qed.}, but not an inversion of $b$\ \ \ \ \footnote{\textit{Proof.} Assume the
contrary. Thus, $\left(  k,k+1\right)  $ is an inversion of $b$. Hence,
$k<k+1$ and $b_{k}>b_{k+1}$ (by the definition of an \textquotedblleft
inversion\textquotedblright). But $b=s_{k}\cdot a$ and thus $b_{k}=\left(
s_{k}\cdot a\right)  _{k}=a_{s_{k}^{-1}\left(  k\right)  }=a_{k+1}$ (since
$s_{k}^{-1}\left(  k\right)  =k+1$) and similarly $b_{k+1}=a_{k}$. Hence,
$a_{k+1}=b_{k}>b_{k+1}=a_{k}$. This contradicts $a_{k}>a_{k+1}$. This
contradiction proves that our assumption was wrong. Qed.}. Furthermore,
$b_{s_{k}\left(  u\right)  }=a_{u}$ for every $u\in\left\{  1,2,\ldots
,n\right\}  $ (since $b=s_{k}\cdot a$), and furthermore, for any $\left(
i,j\right)  \in\left\{  1,2,\ldots,n\right\}  ^{2}$ satisfying $i<j$, we have%
\begin{equation}
s_{k}\left(  i\right)  <s_{k}\left(  j\right)  \ \ \ \ \ \ \ \ \ \ \text{if
}\left(  i,j\right)  \neq\left(  k,k+1\right)
\label{pf.prop.diamond.example.poset.inversion-transform}%
\end{equation}
\footnote{\textit{Proof of
(\ref{pf.prop.diamond.example.poset.inversion-transform}):} Let $\left(
i,j\right)  \in\left\{  1,2,\ldots,n\right\}  ^{2}$ be such that $i<j$. Assume
that $\left(  i,j\right)  \neq\left(  k,k+1\right)  $. We need to prove
$s_{k}\left(  i\right)  <s_{k}\left(  j\right)  $.
\par
Assume the contrary. Thus, $s_{k}\left(  i\right)  \geq s_{k}\left(  j\right)
$. But $i<j$, thus $i\neq j$ and therefore $s_{k}\left(  i\right)  \neq
s_{k}\left(  j\right)  $ (since $s_{k}$ is injective (because $s_{k}$ is a
permutation)). Combined with $s_{k}\left(  i\right)  \geq s_{k}\left(
j\right)  $, this yields $s_{k}\left(  i\right)  >s_{k}\left(  j\right)  $.
\par
We have $i<j$, and thus $i+1\leq j$ (since $i$ and $j$ are integers).
\par
Recall that $s_{k}$ is the permutation of $\left\{  1,2,\ldots,n\right\}  $
which transposes $k$ with $k+1$ while leaving all other elements of $\left\{
1,2,\ldots,n\right\}  $ unchanged. Hence,%
\begin{equation}
s_{k}\left(  u\right)  \leq u+1\ \ \ \ \ \ \ \ \ \ \text{for every }%
u\in\left\{  1,2,\ldots,n\right\}  .
\label{pf.prop.diamond.example.poset.inversion-transform.pf.3}%
\end{equation}
(Indeed, (\ref{pf.prop.diamond.example.poset.inversion-transform.pf.3}) can be
proven by separately considering the cases $u=k$, $u=k+1$ and $u\notin\left\{
k,k+1\right\}  $.)
\par
Now, (\ref{pf.prop.diamond.example.poset.inversion-transform.pf.3}) (applied
to $u=i$) yields $s_{k}\left(  i\right)  \leq i+1$. Hence, $i+1\geq
s_{k}\left(  i\right)  >s_{k}\left(  j\right)  $, so that $i+1\geq
s_{k}\left(  j\right)  +1$ (since $i+1$ and $s_{k}\left(  j\right)  $ are
integers). In other words, $i\geq s_{k}\left(  j\right)  $. Hence,
$s_{k}\left(  j\right)  \leq i$. But
(\ref{pf.prop.diamond.example.poset.inversion-transform.pf.3}) (applied to
$u=s_{k}\left(  j\right)  $) yields $s_{k}\left(  s_{k}\left(  j\right)
\right)  \leq s_{k}\left(  j\right)  +1$. But $s_{k}$ is an involution, and
thus $s_{k}\left(  s_{k}\left(  j\right)  \right)  =j$, so that $j=s_{k}%
\left(  s_{k}\left(  j\right)  \right)  \leq\underbrace{s_{k}\left(  j\right)
}_{\leq i}+1\leq i+1$. Combined with $i+1\leq j$, this yields $j=i+1$. Hence,
$i=j-1$. Thus, if we had $j=k+1$, then we would have $i=\underbrace{j}%
_{=k+1}-1=k+1-1=k$ and thus $\left(  \underbrace{i}_{=k},\underbrace{j}%
_{=k+1}\right)  =\left(  k,k+1\right)  $, which would contradict $\left(
i,j\right)  \neq\left(  k,k+1\right)  $. Hence, we cannot have $j=k+1$. We
thus have $j\neq k+1$.
\par
Now, it is easy to see that $s_{k}\left(  u\right)  \geq u$ for every
$u\in\left\{  1,2,\ldots,n\right\}  $ satisfying $u\neq k+1$. Applying this to
$u=j$, we obtain $s_{k}\left(  j\right)  \geq j$ (since $j\neq k+1$).
\par
Now, combining $j\leq s_{k}\left(  j\right)  +1$ with $s_{k}\left(  j\right)
+1\leq i+1=j$, we obtain $j=s_{k}\left(  j\right)  +1$. In other words,
$s_{k}\left(  j\right)  =j-1$. Thus, $j-1=s_{k}\left(  j\right)  \geq j$. This
is absurd. This contradiction proves that our assumption was wrong. Hence,
(\ref{pf.prop.diamond.example.poset.inversion-transform}) is proven.}. From
the last two observations, we can easily conclude that the inversions of $b$
are precisely the pairs of the form $\left(  s_{k}\left(  i\right)
,s_{k}\left(  j\right)  \right)  $ with $\left(  i,j\right)  $ being an
inversion of $a$ satisfying $\left(  i,j\right)  \neq\left(  k,k+1\right)
$\ \ \ \ \footnote{\textit{Proof.} In order to prove this, we need to verify
the following two claims:
\par
\textit{Claim 1:} Every inversion of $b$ is a pair of the form $\left(
s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  $ with $\left(
i,j\right)  $ being an inversion of $a$ satisfying $\left(  i,j\right)
\neq\left(  k,k+1\right)  $.
\par
\textit{Claim 2:} Every pair of the form $\left(  s_{k}\left(  i\right)
,s_{k}\left(  j\right)  \right)  $ with $\left(  i,j\right)  $ being an
inversion of $a$ satisfying $\left(  i,j\right)  \neq\left(  k,k+1\right)  $
is an inversion of $b$.
\par
\textit{Proof of Claim 1:} Let $\left(  u,v\right)  $ be an inversion of $b$.
Then, $u<v$ and $b_{u}>b_{v}$ (by the definition of an \textquotedblleft
inversion\textquotedblright). Let $\alpha=s_{k}\left(  u\right)  $ and
$\beta=s_{k}\left(  v\right)  $. Recall that $s_{k}$ is an involution, so that
$s_{k}^{2}=\operatorname*{id}$. Now, $s_{k}\left(  \underbrace{\alpha}%
_{=s_{k}\left(  u\right)  }\right)  =s_{k}\left(  s_{k}\left(  u\right)
\right)  =\underbrace{s_{k}^{2}}_{=\operatorname*{id}}\left(  u\right)  =u$
and $s_{k}\left(  \underbrace{\beta}_{=s_{k}\left(  v\right)  }\right)
=s_{k}\left(  s_{k}\left(  v\right)  \right)  =\underbrace{s_{k}^{2}%
}_{=\operatorname*{id}}\left(  v\right)  =v$.
\par
We have $u<v$. Also, $\left(  u,v\right)  \neq\left(  k,k+1\right)  $ (since
$\left(  u,v\right)  $ is an inversion of $b$, but $\left(  k,k+1\right)  $ is
not an inversion of $b$). Thus,
(\ref{pf.prop.diamond.example.poset.inversion-transform}) (applied to $\left(
i,j\right)  =\left(  u,v\right)  $) shows that $s_{k}\left(  u\right)
<s_{k}\left(  v\right)  $. Thus, $\alpha=s_{k}\left(  u\right)  <s_{k}\left(
v\right)  =\beta$. Moreover, $a=s_{k}\cdot u$, so that $a_{\alpha}=\left(
s_{k}\cdot b\right)  _{\alpha}=b_{s_{k}^{-1}\left(  \alpha\right)  }=b_{u}$
(since $s_{k}^{-1}\left(  \alpha\right)  =u$ (since $\alpha=s_{k}\left(
u\right)  $)). Also, $a=s_{k}\cdot u$, so that $a_{\beta}=\left(  s_{k}\cdot
b\right)  _{\beta}=b_{s_{k}^{-1}\left(  \beta\right)  }=b_{v}$ (since
$s_{k}^{-1}\left(  \beta\right)  =v$ (since $\beta=s_{k}\left(  v\right)  $)).
Therefore, $a_{\alpha}=b_{u}>b_{v}=a_{\beta}$.
\par
Thus we have $\alpha<\beta$ and $a_{\alpha}>a_{\beta}$. In other words,
$\left(  \alpha,\beta\right)  $ is an inversion of $a$ (by the definition of
an \textquotedblleft inversion\textquotedblright). Moreover, if we had
$\left(  \alpha,\beta\right)  =\left(  k,k+1\right)  $, then we would have
$\alpha=k$ and $\beta=k+1$ and therefore also $k+1=s_{k}\left(  \underbrace{k}%
_{=\alpha}\right)  =s_{k}\left(  \alpha\right)  =u<v=s_{k}\left(
\underbrace{\beta}_{=k+1}\right)  =s_{k}\left(  k+1\right)  =k$, which is
absurd. Hence, we cannot have $\left(  \alpha,\beta\right)  =\left(
k,k+1\right)  $. We thus have $\left(  \alpha,\beta\right)  =\left(
k,k+1\right)  $. Finally, $\left(  u,v\right)  =\left(  s_{k}\left(
\alpha\right)  ,s_{k}\left(  \beta\right)  \right)  $ (since $u=s_{k}\left(
\alpha\right)  $ and $v=s_{k}\left(  \beta\right)  $). Hence, $\left(
u,v\right)  $ is a pair of the form $\left(  s_{k}\left(  i\right)
,s_{k}\left(  j\right)  \right)  $ with $\left(  i,j\right)  $ being an
inversion of $a$ satisfying $\left(  i,j\right)  \neq\left(  k,k+1\right)  $
(namely, for $\left(  i,j\right)  =\left(  \alpha,\beta\right)  $).
\par
Now, let us forget that we fixed $\left(  u,v\right)  $. We thus have shown
that every inversion $\left(  u,v\right)  $ of $b$ is a pair of the form
$\left(  s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  $ with
$\left(  i,j\right)  $ being an inversion of $a$ satisfying $\left(
i,j\right)  \neq\left(  k,k+1\right)  $. This proves Claim 1.
\par
\textit{Proof of Claim 2:} We need to prove that if $\left(  i,j\right)  $ is
an inversion of $a$ satisfying $\left(  i,j\right)  \neq\left(  k,k+1\right)
$, then $\left(  s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  $ is
an inversion of $b$.
\par
So let $\left(  i,j\right)  $ be an inversion of $a$ satisfying $\left(
i,j\right)  \neq\left(  k,k+1\right)  $. We need to prove that $\left(
s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  $ is an inversion of
$b$.
\par
Recall that $s_{k}$ is an involution. Thus, $s_{k}^{-1}=s_{k}$.
\par
We know that $\left(  i,j\right)  $ is an inversion of $a$. In other words,
$i<j$ and $a_{i}>a_{j}$ (by the definition of an \textquotedblleft
inversion\textquotedblright). Thus, $s_{k}\left(  i\right)  <s_{k}\left(
j\right)  $ (by (\ref{pf.prop.diamond.example.poset.inversion-transform})).
Now, $a=s_{k}\cdot b$, so that $a_{i}=\left(  s_{k}\cdot b\right)
_{i}=b_{s_{k}^{-1}\left(  i\right)  }=b_{s_{k}\left(  i\right)  }$ (since
$s_{k}^{-1}=s_{k}$). Similarly, $a_{j}=b_{s_{k}\left(  j\right)  }$. Hence,
$b_{s_{k}\left(  i\right)  }=a_{i}>a_{j}=b_{s_{k}\left(  j\right)  }$.
\par
Now, $\left(  s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  $ is a
pair such that $s_{k}\left(  i\right)  <s_{k}\left(  j\right)  $ and
$b_{s_{k}\left(  i\right)  }>b_{s_{k}\left(  j\right)  }$. In other words,
$\left(  s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  $ is an
inversion of $b$ (by the definition of an \textquotedblleft
inversion\textquotedblright). This completes our proof of Claim 2.
\par
Now, both Claims 1 and 2 are proven, qed.}. Thus, the inversions of $b$ are in
1-to-1 correspondence with the inversions $\left(  i,j\right)  $ of $a$ with
$\left(  i,j\right)  \neq\left(  k,k+1\right)  $. Thus,%
\begin{align*}
&  \left(  \text{the number of inversions of }b\right) \\
&  =\left(  \text{the number of inversions }\left(  i,j\right)  \text{ of
}a\text{ with }\left(  i,j\right)  \neq\left(  k,k+1\right)  \right) \\
&  =\underbrace{\left(  \text{the number of inversions }\left(  i,j\right)
\text{ of }a\right)  }_{=\ell\left(  a\right)  }-1\ \ \ \ \ \ \ \ \ \ \left(
\text{since }\left(  k,k+1\right)  \text{ is an inversion of }a\right) \\
&  =\ell\left(  a\right)  -1,
\end{align*}
so that $\ell\left(  b\right)  =\left(  \text{the number of inversions of
}b\right)  =\ell\left(  a\right)  -1$. Thus, $\ell\left(  a\right)
>\ell\left(  b\right)  $. Hence, the length-decrease hypothesis is proven.
\end{verlong}

\begin{vershort}
\textit{Proof that the local confluence hypothesis is satisfied:} Let $a$, $b$
and $c$ be three elements of $\mathbf{S}$ satisfying $a\Rrightarrow b$ and
$a\Rrightarrow c$. We need to show that there exists a $d\in\mathbf{S}$ such
that $b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast}{\Rrightarrow}d$.

We have $a\Rrightarrow b$. In other words, the $n$-tuple $b$ can be obtained
from $a$ by switching two adjacent entries which are out of order in $a$. In
other words, we can write $a$ and $b$ in the forms%
\begin{equation}
a=\left(  \ldots,p,q,\ldots\right)  \ \ \ \ \ \ \ \ \ \ \text{and}%
\ \ \ \ \ \ \ \ \ \ b=\left(  \ldots,q,p,\ldots\right)
\label{pf.prop.diamond.example.poset.short.a-b}%
\end{equation}
for some $p\in P$ and $q\in P$ satisfying $p>q$, where the \textquotedblleft%
$\ldots$\textquotedblright\ stand for strings\footnote{These strings are
allowed to be empty.} of entries of $a$ that appear unchanged in $b$.
Similarly, we can write $a$ and $c$ in the forms%
\begin{equation}
a=\left(  \ldots,r,t,\ldots\right)  \ \ \ \ \ \ \ \ \ \ \text{and}%
\ \ \ \ \ \ \ \ \ \ c=\left(  \ldots,t,r,\ldots\right)
\label{pf.prop.diamond.example.poset.short.a-c}%
\end{equation}
for some $r\in P$ and $t\in P$ satisfying $r>t$, where the \textquotedblleft%
$\ldots$\textquotedblright\ stand for strings of entries of $a$ that appear
unchanged in $c$. Consider the $p$ and $q$ from
(\ref{pf.prop.diamond.example.poset.short.a-b}), and the $r$ and $t$ from
(\ref{pf.prop.diamond.example.poset.short.a-c}). Also, let $u$ and $u+1$ be
the positions of $p$ and $q$ in $a$ in
(\ref{pf.prop.diamond.example.poset.short.a-b}). Furthermore, let $v$ and
$v+1$ be the positions of $r$ and $t$ in $a$ in
(\ref{pf.prop.diamond.example.poset.short.a-c}).

We WLOG assume that $u\leq v$, because otherwise we can simply switch $b$ with
$c$ (thus forcing $u$ to switch with $v$). Moreover, we can WLOG assume that
$u\neq v$ (because if $u=v$, then finding a $d\in\mathbf{S}$ such that
$b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast}{\Rrightarrow}d$ is
trivial\footnote{\textit{Proof.} Assume that $u=v$. Thus, the $p$ and $q$ in
(\ref{pf.prop.diamond.example.poset.short.a-b}) appear in the same positions
as the $r$ and $t$ in (\ref{pf.prop.diamond.example.poset.short.a-c}). Hence,
both $b$ and $c$ are obtained from $a$ in one and the same way (namely, by
switching the entries in these positions). Hence, $b=c$. Thus, we can find a
$d\in\mathbf{S}$ such that $b\overset{\ast}{\Rrightarrow}d$ and
$c\overset{\ast}{\Rrightarrow}d$ just by setting $d=b=c$, qed.}). Thus, $u<v$
(since $u\leq v$).

Let us now try to combine the representations
(\ref{pf.prop.diamond.example.poset.short.a-b}) for $a$ and $b$ with the
representations (\ref{pf.prop.diamond.example.poset.short.a-c}) for $a$ and
$c$ into a set of representations for $a$, $b$ and $c$ in which both the
changes from $a$ to $b$ and the changes from $a$ to $c$ are visible at the
same time. We must be in one of the following two cases:

\textit{Case 1:} We have $u<v-1$.

\textit{Case 2:} We have $u=v-1$.

Let us first consider Case 1. In this case, we can merge the representations
(\ref{pf.prop.diamond.example.poset.short.a-b}) and
(\ref{pf.prop.diamond.example.poset.short.a-c}) as follows:%
\[
a=\left(  \ldots,p,q,\ldots,r,t,\ldots\right)  ,\ \ \ \ \ \ \ \ \ \ b=\left(
\ldots,q,p,\ldots,r,t,\ldots\right)  ,\ \ \ \ \ \ \ \ \ \ c=\left(
\ldots,p,q,\ldots,t,r,\ldots\right)  ,
\]
where the \textquotedblleft$\ldots$\textquotedblright\ stand for strings of
entries of $a$ that appear unchanged in both $b$ and $c$. Thus, we can find a
$d\in\mathbf{S}$ such that $b\overset{\ast}{\Rrightarrow}d$ and
$c\overset{\ast}{\Rrightarrow}d$: namely, set%
\[
d=\left(  \ldots,q,p,\ldots,t,r,\ldots\right)
\]
(where the \textquotedblleft$\ldots$\textquotedblright\ have the same meaning
as before). Thus, the local confluence hypothesis is proven in Case 1.

Let us now consider Case 2. In this case, $u=v-1$. Hence, $u+1=v$. Now, $q$ is
the $\left(  u+1\right)  $-th entry of $a$, that is, the $v$-th entry of $a$
(since $u+1=v$); but $r$ is also the $v$-th entry of $a$. Hence, $q=r$, so
that $p>q=r>t$. Now, we can merge the representations
(\ref{pf.prop.diamond.example.poset.short.a-b}) and
(\ref{pf.prop.diamond.example.poset.short.a-c}) as follows:%
\[
a=\left(  \ldots,p,q,t,\ldots\right)  ,\ \ \ \ \ \ \ \ \ \ b=\left(
\ldots,q,p,t,\ldots\right)  ,\ \ \ \ \ \ \ \ \ \ c=\left(  \ldots
,p,t,q,\ldots\right)  ,
\]
where the \textquotedblleft$\ldots$\textquotedblright\ stand for strings of
entries of $a$ that appear unchanged in both $b$ and $c$. Let us now set%
\[
e=\left(  \ldots,q,t,p,\ldots\right)  ,\ \ \ \ \ \ \ \ \ \ f=\left(
\ldots,t,p,q,\ldots\right)  ,\ \ \ \ \ \ \ \ \ \ d=\left(  \ldots
,t,q,p,\ldots\right)
\]
(where the \textquotedblleft$\ldots$\textquotedblright\ have the same meaning
as before). Then, $b\Rrightarrow e$ and $e\Rrightarrow d$; thus,
$b\overset{\ast}{\Rrightarrow}d$ (since $\overset{\ast}{\Rrightarrow}$ is the
reflexive-and-transitive closure of $\Rrightarrow$). Also, $c\Rrightarrow f$
and $f\Rrightarrow d$; thus, $c\overset{\ast}{\Rrightarrow}d$ (since
$\overset{\ast}{\Rrightarrow}$ is the reflexive-and-transitive closure of
$\Rrightarrow$). Hence, we have found a $d\in\mathbf{S}$ such that
$b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast}{\Rrightarrow}d$. Thus,
the local confluence hypothesis is proven in Case 2 as well.

The local confluence hypothesis thus holds (because it is proven in both Cases
1 and 2).
\end{vershort}

\begin{verlong}
\textit{Proof that the local confluence hypothesis is satisfied:} Let $a$, $b$
and $c$ be three elements of $\mathbf{S}$ satisfying $a\Rrightarrow b$ and
$a\Rrightarrow c$. We need to show that there exists a $d\in\mathbf{S}$ such
that $b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast}{\Rrightarrow}d$.

If $b=c$, then this is obvious\footnote{\textit{Proof.} Assume that $b=c$.
Then, $b\overset{\ast}{\Rrightarrow}b$ (since the relation $\overset{\ast
}{\Rrightarrow}$ is reflexive). In other words, $b\overset{\ast}{\Rrightarrow
}c$ (since $b=c$). Also, $c\overset{\ast}{\Rrightarrow}c$ (since the relation
$\overset{\ast}{\Rrightarrow}$ is reflexive). Hence, there exists a
$d\in\mathbf{S}$ such that $b\overset{\ast}{\Rrightarrow}d$ and
$c\overset{\ast}{\Rrightarrow}d$ (namely, $d=c$). Qed.}. Hence, for the rest
of this proof, we WLOG assume that $b\neq c$.

We have $a\Rrightarrow b$. Thus, there exists some $k\in\left\{
1,2,\ldots,n-1\right\}  $ such that $a\underset{k}{\Rrightarrow}b$. Let us
denote this $k$ by $u$. Thus, $a\underset{u}{\Rrightarrow}b$. In other words,
$a_{u}>a_{u+1}$ and $b=s_{u}\cdot a$.

We have $a\Rrightarrow c$. Thus, there exists some $k\in\left\{
1,2,\ldots,n-1\right\}  $ such that $a\underset{k}{\Rrightarrow}c$. Let us
denote this $k$ by $v$. Thus, $a\underset{v}{\Rrightarrow}c$. In other words,
$a_{v}>a_{v+1}$ and $c=s_{v}\cdot a$.

We have $s_{u}\cdot a=b\neq c=s_{v}\cdot a$ and thus $u\neq v$. Thus, either
$u<v$ or $v<u$. We can WLOG assume that $u<v$ (since otherwise, we can simply
switch $b$ with $c$). Assume this. Then, we must be in one of the following
two cases:

\textit{Case 1:} We have $u=v-1$.

\textit{Case 2:} We have $u<v-1$.

Let us consider Case 2 first. In this case, we have $u<v-1$. Hence,
$s_{u}s_{v}=s_{v}s_{u}$ in $\mathfrak{S}_{n}$. Also, $u+1<v$ (since $u<v-1$).
Now,%
\[
s_{v}\cdot\underbrace{b}_{=s_{u}\cdot a}=s_{v}\cdot\left(  s_{u}\cdot
a\right)  =\underbrace{\left(  s_{v}s_{u}\right)  }_{=s_{u}s_{v}}\cdot
a=\left(  s_{u}s_{v}\right)  \cdot a=s_{u}\cdot\underbrace{\left(  s_{v}\cdot
a\right)  }_{=c}=s_{u}\cdot c.
\]
We can thus define a $d\in\mathbf{S}$ by $d=s_{v}\cdot b=s_{u}\cdot c$. (This
is indeed an element of $\mathbf{S}$ because $\mathbf{S}$ is an $\mathfrak{S}%
_{n}$-set.)

Now, from $b=s_{u}\cdot a$, we obtain $b_{v}=\left(  s_{u}\cdot a\right)
_{v}=a_{s_{u}^{-1}\left(  v\right)  }=a_{v}$ (since $s_{u}^{-1}\left(
v\right)  =v$ (since $u<v-1$)) and $b_{v+1}=\left(  s_{u}\cdot a\right)
_{v+1}=a_{s_{u}^{-1}\left(  v+1\right)  }=a_{v+1}$ (since $s_{u}^{-1}\left(
v+1\right)  =v+1$ (since $u<v-1<\left(  v+1\right)  -1$)). Thus, $b_{v}%
=a_{v}>a_{v+1}=b_{v+1}$. Combined with $d=s_{v}\cdot b$, this yields
$b\underset{v}{\Rrightarrow}d$ (by the definition of \textquotedblleft%
$b\underset{v}{\Rrightarrow}d$\textquotedblright). Thus, $b\Rrightarrow d$, so
that $b\overset{\ast}{\Rrightarrow}d$ (since $\overset{\ast}{\Rrightarrow}$
extends the relation $\Rrightarrow$).

Also, from $c=s_{v}\cdot b$, we obtain $c_{u}=\left(  s_{v}\cdot b\right)
_{u}=a_{s_{v}^{-1}\left(  u\right)  }=a_{u}$ (since $s_{v}^{-1}\left(
u\right)  =u$ (since $u<v-1<v$)) and $c_{u+1}=\left(  s_{v}\cdot b\right)
_{u+1}=b_{s_{v}^{-1}\left(  u+1\right)  }=b_{u+1}$ (since $s_{v}^{-1}\left(
u+1\right)  =u+1$ (since $u+1<v$)). Thus, $c_{u}=a_{u}>a_{u+1}=b_{u+1}$.
Combined with $d=s_{u}\cdot c$, this yields $c\underset{u}{\Rrightarrow}d$ (by
the definition of \textquotedblleft$c\underset{u}{\Rrightarrow}d$%
\textquotedblright). Thus, $c\Rrightarrow d$, so that $c\overset{\ast
}{\Rrightarrow}d$ (since $\overset{\ast}{\Rrightarrow}$ extends the relation
$\Rrightarrow$).

Hence, we have shown that there exists a $d\in\mathbf{S}$ such that
$b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast}{\Rrightarrow}d$. The
proof is thus complete in Case 2.

Let us now consider Case 1. In this case, we have $u=v-1$. But recall that
$a_{u}>a_{u+1}$. Due to $u=v-1$, this rewrites as $a_{v-1}>a_{v}$. Thus,
$a_{v-1}>a_{v}>a_{v+1}$.

Recall also that $b=s_{u}\cdot a=s_{v-1}\cdot a$ (since $u=v-1$) and
$c=s_{v}\cdot a$.

Now, it is well-known (and easy to check) that $s_{v-1}s_{v}s_{v-1}%
=s_{v}s_{v-1}s_{v}$ in $\mathfrak{S}_{n}$. We can thus define a $d\in
\mathbf{S}$ by%
\[
d=\left(  s_{v-1}s_{v}s_{v-1}\right)  \cdot a=\left(  s_{v}s_{v-1}%
s_{v}\right)  \cdot a
\]
(because $\mathbf{S}$ is an $\mathfrak{S}_{n}$-set). Consider this $d$. In
order to complete this proof in Case 1, we now need to show that
$b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast}{\Rrightarrow}d$. So our
goal is now to prove that $b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast
}{\Rrightarrow}d$.

We have the four relations%
\begin{align}
s_{v-1}\cdot a  &  \underset{v}{\Rrightarrow}\left(  s_{v}s_{v-1}\right)
\cdot a;\label{pf.prop.diamond.example.poset.four1}\\
\left(  s_{v}s_{v-1}\right)  \cdot a  &  \underset{u}{\Rrightarrow}\left(
s_{v-1}s_{v}s_{v-1}\right)  \cdot
a;\label{pf.prop.diamond.example.poset.four2}\\
s_{v}\cdot a  &  \underset{u}{\Rrightarrow}\left(  s_{v-1}s_{v}\right)  \cdot
a;\label{pf.prop.diamond.example.poset.four3}\\
\left(  s_{v-1}s_{v}\right)  \cdot a  &  \underset{v}{\Rrightarrow}\left(
s_{v}s_{v-1}s_{v}\right)  \cdot a. \label{pf.prop.diamond.example.poset.four4}%
\end{align}
\textit{Proof of (\ref{pf.prop.diamond.example.poset.four1}):} We have
$\left(  s_{v-1}\cdot a\right)  _{v}=a_{s_{v-1}^{-1}\left(  v\right)
}=a_{v-1}$ (since $s_{v-1}^{-1}\left(  v\right)  =v-1$) and $\left(
s_{v-1}\cdot a\right)  _{v+1}=a_{s_{v-1}^{-1}\left(  v+1\right)  }=a_{v+1}$
(since $s_{v-1}^{-1}\left(  v+1\right)  =v+1$). Thus, $\left(  s_{v-1}\cdot
a\right)  _{v}=a_{v-1}>a_{v+1}=\left(  s_{v-1}\cdot a\right)  _{v+1}$. This,
combined with $\left(  s_{v}s_{v-1}\right)  \cdot a=s_{v}\cdot\left(
s_{v-1}\cdot a\right)  $, shows that $s_{v-1}\cdot a\underset{v}{\Rrightarrow
}\left(  s_{v}s_{v-1}\right)  \cdot a$ (by the definition of the notation
$s_{v-1}\cdot a\underset{v}{\Rrightarrow}\left(  s_{v}s_{v-1}\right)  \cdot
a$). Thus, the relation (\ref{pf.prop.diamond.example.poset.four1}) is proven.

\textit{Proof of (\ref{pf.prop.diamond.example.poset.four2}):} We have
$\left(  s_{v}s_{v-1}\right)  \left(  v+1\right)  =s_{v}\left(
\underbrace{s_{v-1}\left(  v+1\right)  }_{=v+1}\right)  =s_{v}\left(
v+1\right)  =v$, and thus $\left(  s_{v}s_{v-1}\right)  ^{-1}\left(  v\right)
=v+1$. Also, we have $\left(  s_{v}s_{v-1}\right)  \left(  v\right)
=s_{v}\left(  \underbrace{s_{v-1}\left(  v\right)  }_{=v-1}\right)
=s_{v}\left(  v-1\right)  =v-1$, and thus $\left(  s_{v}s_{v-1}\right)
^{-1}\left(  v-1\right)  =v$.

Now, $\left(  \left(  s_{v}s_{v-1}\right)  \cdot a\right)  _{v}=a_{\left(
s_{v}s_{v-1}\right)  ^{-1}\left(  v\right)  }=a_{v+1}$ (since $\left(
s_{v}s_{v-1}\right)  ^{-1}\left(  v\right)  =v+1$) and $\left(  \left(
s_{v}s_{v-1}\right)  \cdot a\right)  _{v-1}=a_{\left(  s_{v}s_{v-1}\right)
^{-1}\left(  v-1\right)  }=a_{v}$ (since $\left(  s_{v}s_{v-1}\right)
^{-1}\left(  v-1\right)  =v$). Thus, $\left(  \left(  s_{v}s_{v-1}\right)
\cdot a\right)  _{v-1}=a_{v}>a_{v+1}=\left(  \left(  s_{v}s_{v-1}\right)
\cdot a\right)  _{v}=\left(  \left(  s_{v}s_{v-1}\right)  \cdot a\right)
_{\left(  v-1\right)  +1}$. This, combined with $\left(  s_{v-1}s_{v}%
s_{v-1}\right)  \cdot a=s_{v-1}\cdot\left(  \left(  s_{v}s_{v-1}\right)  \cdot
a\right)  $, shows that $\left(  s_{v}s_{v-1}\right)  \cdot
a\underset{v-1}{\Rrightarrow}\left(  s_{v-1}s_{v}s_{v-1}\right)  \cdot a$ (by
the definition of the notation $\left(  s_{v}s_{v-1}\right)  \cdot
a\underset{v-1}{\Rrightarrow}\left(  s_{v-1}s_{v}s_{v-1}\right)  \cdot a$). In
other words, $\left(  s_{v}s_{v-1}\right)  \cdot a\underset{v-1}{\Rrightarrow
}\left(  s_{v-1}s_{v}s_{v-1}\right)  \cdot a$ (since $u=v-1$). Thus, the
relation (\ref{pf.prop.diamond.example.poset.four2}) is proven.

\textit{Proof of (\ref{pf.prop.diamond.example.poset.four3}):} We have
$\left(  s_{v}\cdot a\right)  _{v-1}=a_{s_{v}^{-1}\left(  v-1\right)
}=a_{v-1}$ (since $s_{v}^{-1}\left(  v-1\right)  =v-1$) and $\left(
s_{v}\cdot a\right)  _{v}=a_{s_{v}^{-1}\left(  v\right)  }=a_{v+1}$ (since
$s_{v}^{-1}\left(  v\right)  =v+1$). Thus, $\left(  s_{v}\cdot a\right)
_{v-1}=a_{v-1}>a_{v+1}=\left(  s_{v}\cdot a\right)  _{v}$. This, combined with
$\left(  s_{v-1}s_{v}\right)  \cdot a=s_{v-1}\cdot\left(  s_{v}\cdot a\right)
$, shows that $s_{v}\cdot a\underset{v-1}{\Rrightarrow}\left(  s_{v-1}%
s_{v}\right)  \cdot a$ (by the definition of the notation $s_{v}\cdot
a\underset{v-1}{\Rrightarrow}\left(  s_{v-1}s_{v}\right)  \cdot a$). In other
words, $s_{v}\cdot a\underset{u}{\Rrightarrow}\left(  s_{v-1}s_{v}\right)
\cdot a$ (since $u=v-1$). Thus, the relation
(\ref{pf.prop.diamond.example.poset.four3}) is proven.

\textit{Proof of (\ref{pf.prop.diamond.example.poset.four4}):} We have
$\left(  s_{v-1}s_{v}\right)  \left(  v-1\right)  =s_{v-1}\left(
\underbrace{s_{v}\left(  v-1\right)  }_{=v-1}\right)  =s_{v-1}\left(
v-1\right)  =v$, and thus $\left(  s_{v-1}s_{v}\right)  ^{-1}\left(  v\right)
=v-1$. Also, we have $\left(  s_{v-1}s_{v}\right)  \left(  v\right)
=s_{v-1}\left(  \underbrace{s_{v}\left(  v\right)  }_{=v+1}\right)
=s_{v-1}\left(  v+1\right)  =v+1$, and thus $\left(  s_{v-1}s_{v}\right)
^{-1}\left(  v+1\right)  =v$.

Now, $\left(  \left(  s_{v-1}s_{v}\right)  \cdot a\right)  _{v}=a_{\left(
s_{v-1}s_{v}\right)  ^{-1}\left(  v\right)  }=a_{v-1}$ (since $\left(
s_{v-1}s_{v}\right)  ^{-1}\left(  v\right)  =v-1$) and $\left(  \left(
s_{v-1}s_{v}\right)  \cdot a\right)  _{v+1}=a_{\left(  s_{v-1}s_{v}\right)
^{-1}\left(  v+1\right)  }=a_{v}$ (since $\left(  s_{v-1}s_{v}\right)
^{-1}\left(  v+1\right)  =v$). Thus, $\left(  \left(  s_{v-1}s_{v}\right)
\cdot a\right)  _{v}=a_{v-1}>a_{v}=\left(  \left(  s_{v-1}s_{v}\right)  \cdot
a\right)  _{v+1}$. This, combined with $\left(  s_{v}s_{v-1}s_{v}\right)
\cdot a=s_{v}\cdot\left(  \left(  s_{v-1}s_{v}\right)  \cdot a\right)  $,
shows that $\left(  s_{v-1}s_{v}\right)  \cdot a\underset{v}{\Rrightarrow
}\left(  s_{v}s_{v-1}s_{v}\right)  \cdot a$ (by the definition of the notation
$\left(  s_{v-1}s_{v}\right)  \cdot a\underset{v}{\Rrightarrow}\left(
s_{v}s_{v-1}s_{v}\right)  \cdot a$). Thus, the relation
(\ref{pf.prop.diamond.example.poset.four4}) is proven.

Now, from (\ref{pf.prop.diamond.example.poset.four1}), we obtain $s_{v-1}\cdot
a\Rrightarrow\left(  s_{v}s_{v-1}\right)  \cdot a$, and therefore we have
$s_{v-1}\cdot a\overset{\ast}{\Rrightarrow}\left(  s_{v}s_{v-1}\right)  \cdot
a$ (since the relation $\overset{\ast}{\Rrightarrow}$ extends the relation
$\Rrightarrow$). Also, from (\ref{pf.prop.diamond.example.poset.four2}), we
obtain $\left(  s_{v}s_{v-1}\right)  \cdot a\Rrightarrow\left(  s_{v-1}%
s_{v}s_{v-1}\right)  \cdot a$, and therefore we have $\left(  s_{v}%
s_{v-1}\right)  \cdot a\overset{\ast}{\Rrightarrow}\left(  s_{v-1}s_{v}%
s_{v-1}\right)  \cdot a$ (since the relation $\overset{\ast}{\Rrightarrow}$
extends the relation $\Rrightarrow$). From $s_{v-1}\cdot a\overset{\ast
}{\Rrightarrow}\left(  s_{v}s_{v-1}\right)  \cdot a$ and $\left(  s_{v}%
s_{v-1}\right)  \cdot a\overset{\ast}{\Rrightarrow}\left(  s_{v-1}s_{v}%
s_{v-1}\right)  \cdot a$, we obtain $s_{v-1}\cdot a\overset{\ast
}{\Rrightarrow}\left(  s_{v-1}s_{v}s_{v-1}\right)  \cdot a$ (since the
relation $\overset{\ast}{\Rrightarrow}$ is transitive). In other words,
$b\overset{\ast}{\Rrightarrow}d$ (since $b=s_{v-1}\cdot a$ and $d=\left(
s_{v-1}s_{v}s_{v-1}\right)  \cdot a$).

Next, from (\ref{pf.prop.diamond.example.poset.four3}), we obtain $s_{v}\cdot
a\Rrightarrow\left(  s_{v-1}s_{v}\right)  \cdot a$, and therefore we have
$s_{v}\cdot a\overset{\ast}{\Rrightarrow}\left(  s_{v-1}s_{v}\right)  \cdot a$
(since the relation $\overset{\ast}{\Rrightarrow}$ extends the relation
$\Rrightarrow$). Also, from (\ref{pf.prop.diamond.example.poset.four4}), we
obtain $\left(  s_{v-1}s_{v}\right)  \cdot a\Rrightarrow\left(  s_{v}%
s_{v-1}s_{v}\right)  \cdot a$, and therefore we have $\left(  s_{v-1}%
s_{v}\right)  \cdot a\overset{\ast}{\Rrightarrow}\left(  s_{v}s_{v-1}%
s_{v}\right)  \cdot a$ (since the relation $\overset{\ast}{\Rrightarrow}$
extends the relation $\Rrightarrow$). From $s_{v}\cdot a\overset{\ast
}{\Rrightarrow}\left(  s_{v-1}s_{v}\right)  \cdot a$ and $\left(  s_{v-1}%
s_{v}\right)  \cdot a\overset{\ast}{\Rrightarrow}\left(  s_{v}s_{v-1}%
s_{v}\right)  \cdot a$, we obtain $s_{v}\cdot a\overset{\ast}{\Rrightarrow
}\left(  s_{v}s_{v-1}s_{v}\right)  \cdot a$ (since the relation $\overset{\ast
}{\Rrightarrow}$ is transitive). In other words, $c\overset{\ast
}{\Rrightarrow}d$ (since $b=s_{v}\cdot a$ and $d=\left(  s_{v}s_{v-1}%
s_{v}\right)  \cdot a$).

Altogether, we now know that $b\overset{\ast}{\Rrightarrow}d$ and
$c\overset{\ast}{\Rrightarrow}d$. Hence, we have shown that there exists a
$d\in\mathbf{S}$ such that $b\overset{\ast}{\Rrightarrow}d$ and
$c\overset{\ast}{\Rrightarrow}d$. The proof is thus complete in Case 1.

We have thus completed the proof in both Cases 1 and 2. Thus we are done
proving that the local confluence hypothesis is satisfied.
\end{verlong}

We now know that both the local confluence hypothesis and the length-decrease
hypothesis are satisfied. This completes the proof of Proposition
\ref{prop.diamond.example.poset}.
\end{proof}

\section{\label{sect.proof}Proof of Lemma \ref{lem.BK}}

We now come to the actual proof of Lemma \ref{lem.BK}.

\subsection{\label{subsect.fourtypes}12-tables and the four types of their
columns}

Let $Z$ be a finite convex subset of $\mathbb{N}_{+}^{2}$. Let $\mathbf{R}$
denote the set of all 12-rpps of shape $Z$.

A \textit{12-table} will mean a map $T:Z\rightarrow\left\{  1,2\right\}  $
such that the entries of $T$ are weakly increasing down columns. (We do not
require them to be weakly increasing along rows.) Every column of a 12-table
is a sequence of the form $\left(  \underbrace{1,1,\ldots,1}_{u\text{ times
}1},\underbrace{2,2,\ldots,2}_{v\text{ times }2}\right)  $ with $u\in
\mathbb{N}$ and $v\in\mathbb{N}$. We say that such a sequence is

\begin{itemize}
\item \textit{1-pure} if it is nonempty and consists purely of $1$'s (that is,
$u>0$ and $v=0$);

\item \textit{2-pure} if it is nonempty and consists purely of $2$'s (that is,
$u=0$ and $v>0$);

\item \textit{mixed} if it contains both $1$'s and $2$'s (that is, $u>0$ and
$v>0$).
\end{itemize}

Consequently, every column of a 12-table is either empty or 1-pure or 2-pure
or mixed (and these four cases do not overlap).

Also, if $s$ is a sequence of the form $\left(  \underbrace{1,1,\ldots
,1}_{u\text{ times }1},\underbrace{2,2,\ldots,2}_{v\text{ times }2}\right)  $
with $u\in\mathbb{N}$ and $v\in\mathbb{N}$, then we define the
\textit{signature} of $s$ to be the nonnegative integer $\left\{
\begin{array}
[c]{c}%
0,\text{ if }s\text{ is 2-pure or empty;}\\
1,\text{ if }s\text{ is mixed;}\\
2,\text{ if }s\text{ is 1-pure}%
\end{array}
\right.  $. We denote this signature by $\operatorname*{sig}\left(  s\right)
$. For any 12-table $T$, we define a nonnegative integer $\ell\left(
T\right)  $ by%
\[
\ell\left(  T\right)  =\sum_{h\in\mathbb{N}_{+}}h\cdot\operatorname*{sig}%
\left(  \text{the }h\text{-th column of }T\right)  .
\]
\footnote{This is well-defined, because all but finitely many $h\in
\mathbb{N}_{+}$ satisfy $\operatorname*{sig}\left(  \text{the }h\text{-th
column of }T\right)  =0$ (since for all but finitely many $h\in\mathbb{N}_{+}%
$, the $h$-th column of $T$ is empty).} For instance, if $T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 1 & 2 \\
%\none& 1 & 1 & 2 \\
%2 & 1 & 1 & 2 \\
%2 & 2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 1 & 2 \\
\none& 1 & 1 & 2 \\
2 & 1 & 1 & 2 \\
2 & 2
\end{ytableau}%
%EndExpansion
$, then $\ell\left(  T\right)  =1\cdot0+2\cdot1+3\cdot2+4\cdot0+5\cdot
2+6\cdot0+7\cdot0+8\cdot0+\cdots=18$.

\subsection{Conflicts of 12-tables}

If $T$ is a 12-table, then we define a \textit{conflict} of $T$ to be a pair
$\left(  i,j\right)  $ of positive integers satisfying $i<j$ such that there
exists an $r\in\mathbb{N}_{+}$ satisfying $\left(  r,i\right)  \in Z$,
$\left(  r,j\right)  \in Z$, $T\left(  r,i\right)  =2$ and $T\left(
r,j\right)  =1$. (Speaking visually, a conflict of $T$ is a pair $\left(
i,j\right)  $ of positive integers such that the filling $T$ has an entry $2$
in column $i$ lying due west of an entry $1$ in column $j$.) For instance, the
conflicts of the 12-table $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 1 & 2 \\
%\none& 1 & 1 & 2 \\
%2 & 1 & 1 & 2 \\
%2 & 2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 1 & 2 \\
\none& 1 & 1 & 2 \\
2 & 1 & 1 & 2 \\
2 & 2
\end{ytableau}%
%EndExpansion
$ are $\left(  1,2\right)  $, $\left(  1,3\right)  $ and $\left(  4,5\right)
$.

(The notion of a conflict of $T$ is in some sense analogous to that of an
inversion of $z$ in Subsection \ref{subsect.bubble}.)

It is clear that%
\begin{equation}
\text{a 12-rpp of shape }Z\text{ is the same as a 12-table which has no
conflicts.} \label{pf.lem.BK.no-conflicts}%
\end{equation}
\footnote{Indeed, if a 12-table has no conflicts, then each of its rows is a
weakly increasing sequence (because each of its rows consists of $1$'s and
$2$'s, and each of the $1$'s must be left of each of the $2$'s or else we
would incur a conflict), i.e., the entries of the 12-table are weakly
increasing along rows, and thus it is a 12-rpp. The converse is just as
obvious.}

We notice a simple fact which we will not use until much later:

\begin{proposition}
\label{prop.conflict.transitive}Let $T$ be a 12-table. Let $a$, $b$ and $c$ be
positive integers such that $\left(  a,b\right)  $ and $\left(  b,c\right)  $
are conflicts of $T$. Then, $\left(  a,c\right)  $ also is a conflict of $T$.
\end{proposition}

\begin{example}
If $T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 \\
%2 & 1 & 1 \\
%2 & 2 & 1
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 \\
2 & 1 & 1 \\
2 & 2 & 1
\end{ytableau}%
%EndExpansion
$, then $\left(  1,2\right)  $ and $\left(  2,3\right)  $ are conflicts of
$T$, and so is $\left(  1,3\right)  $. One can notice that every row which
\textquotedblleft witnesses\textquotedblright\ the conflict $\left(
1,2\right)  $ will also \textquotedblleft witness\textquotedblright\ the
conflict $\left(  1,3\right)  $ (where we say that the $r$-th row
\textit{witnesses} a conflict $\left(  i,j\right)  $ if and only if $\left(
r,i\right)  \in Z$, $\left(  r,j\right)  \in Z$, $T\left(  r,i\right)  =2$ and
$T\left(  r,j\right)  =1$). This is the main idea of the proof that will follow.
\end{example}

\begin{proof}
[Proof of Proposition \ref{prop.conflict.transitive}.]We know that $\left(
b,c\right)  $ is a conflict of $T$. In other words, $\left(  b,c\right)  $ is
a pair of positive integers such that $b<c$ and such that there exists an
$r\in\mathbb{N}_{+}$ satisfying $\left(  r,b\right)  \in Z$, $\left(
r,c\right)  \in Z$, $T\left(  r,b\right)  =2$ and $T\left(  r,c\right)  =1$
(due to the definition of a \textquotedblleft conflict\textquotedblright). Let
us denote this $r$ by $q$. Thus, $\left(  q,b\right)  \in Z$, $\left(
q,c\right)  \in Z$, $T\left(  q,b\right)  =2$ and $T\left(  q,c\right)  =1$.

Also, $\left(  a,b\right)  $ is a conflict of $T$. In other words, $\left(
a,b\right)  $ is a pair of positive integers such that $a<b$ and such that
there exists an $r\in\mathbb{N}_{+}$ satisfying $\left(  r,a\right)  \in Z$,
$\left(  r,b\right)  \in Z$, $T\left(  r,a\right)  =2$ and $T\left(
r,b\right)  =1$. Consider this $r$. Clearly, $a<b<c$.

If $q\leq r$, then
\begin{align*}
2  &  =T\left(  q,b\right)  \leq T\left(  r,b\right)
\ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since }q\leq r\text{, and since the entries of }T\text{ are}\\
\text{weakly increasing down columns}%
\end{array}
\right) \\
&  =1,
\end{align*}
which contradicts $2>1$. Hence, we cannot have $q\leq r$. We thus have $r<q$.
Now, the set $Z$ is convex and we have $\left(  r,a\right)  \in Z$ and
$\left(  q,c\right)  \in Z$ and $r\leq r\leq q$ and $a\leq c\leq c$. Thus, we
find $\left(  r,c\right)  \in Z$ (by (\ref{eq.convex}), applied to $r$, $r$,
$q$, $a$, $c$ and $c$ instead of $i$, $i^{\prime}$, $i^{\prime\prime}$, $j$,
$j^{\prime}$ and $j^{\prime\prime}$). Now,%
\begin{align*}
T\left(  r,c\right)   &  \leq T\left(  q,c\right)  \ \ \ \ \ \ \ \ \ \ \left(
%
\begin{array}
[c]{c}%
\text{since }r<q\text{, and since the entries of }T\text{ are}\\
\text{weakly increasing down columns}%
\end{array}
\right) \\
&  =1,
\end{align*}
so that $T\left(  r,c\right)  =1$ (since $T\left(  r,c\right)  $ is either $1$
or $2$). Now, we know that $\left(  r,a\right)  \in Z$, $\left(  r,c\right)
\in Z$, $T\left(  r,a\right)  =2$ and $T\left(  r,c\right)  =1$. Hence,
$\left(  a,c\right)  $ is a conflict of $T$. This proves Proposition
\ref{prop.conflict.transitive}.
\end{proof}

\begin{remark}
\label{rmk.conflict.transitive.anti}Proposition \ref{prop.conflict.transitive}
has an analogue for \textquotedblleft non-conflicts\textquotedblright: Let $T$
be a 12-table. Let $a$, $b$ and $c$ be positive integers such that $\left(
a,c\right)  $ is a conflict of $T$ and such that $a<b<c$. Then, at least one
of the pairs $\left(  a,b\right)  $ and $\left(  b,c\right)  $ is a conflict
of $T$. We shall not use this fact, however.
\end{remark}

\begin{todo}
Proposition \ref{prop.conflict.transitive} shows that every 12-table $T$ gives
rise to a \textit{conflict poset}: the set $\mathbb{N}_{+}$ can be endowed
with a partial order whose smaller relation $\prec$ is given by%
\[
\left(  i\prec j\right)  \ \Longleftrightarrow\ \left(  \left(  i,j\right)
\text{ is a conflict of }T\right)  .
\]
Does this have any interesting properties? What exactly happens to this poset
when we resolve a conflict? What kinds of posets can be obtained this way?

Viviane Pons says that Proposition \ref{prop.conflict.transitive} and Remark
\ref{rmk.conflict.transitive.anti} yield that there exists a permutation
$\sigma\in\mathfrak{S}_{\left(  \infty\right)  }$ such that $\left(
i,j\right)  $ is a conflict of $T$ if and only if $\left(  i<j\text{ and
}\sigma\left(  i\right)  >\sigma\left(  j\right)  \right)  $. This, I think,
is not hard to prove by induction. Conversely, inversion posets of
permutations in $\mathfrak{S}_{\left(  \infty\right)  }$ can be represented as
conflict posets of 12-tables (though not necessarily benign 12-tables).

I am wondering: What permutations in $\mathfrak{S}_{\left(  \infty\right)  }$
have the property that their inversion poset can be written as a conflict
poset of a benign 12-table?
\end{todo}

\subsection{Benign 12-tables and separators}

We say that a 12-table $T$ is \textit{benign} if there exists no conflict
$\left(  i,j\right)  $ of $T$ such that the $i$-th column of $T$ and the
$j$-th column of $T$ both are mixed. (Remember that columns are sequences.)
For instance, the 12-table $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 1 & 1 & 2 & 1 \\
%1 & 1 & 1 \\
%1 & 2 & 1 \\
%1 & 2 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 1 & 1 & 2 & 1 \\
1 & 1 & 1 \\
1 & 2 & 1 \\
1 & 2 \\
2
\end{ytableau}%
%EndExpansion
$ is benign (despite having $\left(  2,3\right)  $ and $\left(  4,5\right)  $
as conflicts), while the 12-table $%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 1 & 1 & 2 & 1 \\
%1 & 1 & 1 \\
%1 & 2 & 1 \\
%1 & 2 & 2\\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 1 & 1 & 2 & 1 \\
1 & 1 & 1 \\
1 & 2 & 1 \\
1 & 2 & 2\\
2
\end{ytableau}%
%EndExpansion
$ is not (its conflict $\left(  2,3\right)  $ has the property that the $2$-nd
column and the $3$-rd column both are mixed). Notice that 12-rpps are benign
12-tables, but the converse is not true.

Let us give an alternative description of benign 12-tables. Namely, if $T$ is
a 12-table, and if $k\in\mathbb{N}_{+}$ is such that the $k$-th column of $T$
is mixed, then we define $\operatorname*{sep}\nolimits_{k}T$ to be the
smallest $r\in\mathbb{N}_{+}$ such that $\left(  r,k\right)  \in Z$ and
$T\left(  r,k\right)  =2$.\ \ \ \ \footnote{Such an $r$ exists since the
$k$-th column of $T$ contains at least one $2$ (in fact, it is mixed).}
(Speaking visually, the integer $\operatorname*{sep}\nolimits_{k}T$ tells us
at what row the $1$'s end and the $2$'s begin in the $k$-th column of $T$. Or,
more sloppily said, it separates the $1$'s from the $2$'s in the $k$-th column
of $T$; this is why we call it $\operatorname*{sep}\nolimits_{k}T$.) Thus,
every 12-table, every $r\in\mathbb{N}_{+}$ and every $k\in\mathbb{N}_{+}$ such
that the $k$-th column of $T$ is mixed and such that $\left(  r,k\right)  \in
Z$ satisfy%
\begin{equation}
T\left(  r,k\right)  =\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }r<\operatorname*{sep}\nolimits_{k}T;\\
2,\ \ \ \ \ \ \ \ \ \ \text{if }r\geq\operatorname*{sep}\nolimits_{k}T
\end{array}
\right.  . \label{pf.lem.BK.Tsep}%
\end{equation}


We let $\operatorname*{seplist}T$ denote the list of all values
$\operatorname*{sep}\nolimits_{k}T$ (in the order of increasing $k$), where
$k$ ranges over all positive integers for which the $k$-th column of $T$ is
mixed. For instance, if $T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 1 & 1 \\
%\none& 2 & 1 & 1 & 2 \\
%1 & 2 & 1 \\
%2 & 2 & 2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 1 & 1 \\
\none& 2 & 1 & 1 & 2 \\
1 & 2 & 1 \\
2 & 2 & 2
\end{ytableau}%
%EndExpansion
$, then $\operatorname*{sep}\nolimits_{1}T=4$ (since $T\left(  1,4\right)  =2$
and $T\left(  1,3\right)  =1$), and $\operatorname*{sep}\nolimits_{3}T=4$, and
$\operatorname*{sep}\nolimits_{5}T=2$ (and there are no other $k\in
\mathbb{N}_{+}$ for which $\operatorname*{sep}\nolimits_{k}T$ is defined), so
that $\operatorname*{seplist}T=\left(  4,4,2\right)  $.

What do the numbers $\operatorname*{sep}\nolimits_{k}T$ have to do with being
benign? It is easy to see that if $T$ is a 12-table, and $i$ and $j$ are two
positive integers such that the $i$-th column of $T$ and the $j$-th column of
$T$ both are mixed, then $\left(  i,j\right)  $ is a conflict of $T$ if and
only if we have $i<j$ and $\operatorname*{sep}\nolimits_{i}%
T>\operatorname*{sep}\nolimits_{j}T$. Hence, the definition of a
\textquotedblleft benign\textquotedblright\ 12-table rewrites as follows: A
12-table $T$ is benign if and only if there exists no pair $\left(
i,j\right)  $ of positive integers such that the $i$-th column of $T$ and the
$j$-th column of $T$ both are mixed and such that $i<j$ and
$\operatorname*{sep}\nolimits_{i}T>\operatorname*{sep}\nolimits_{j}T$. In
other words, a 12-table $T$ is benign if and only if the list
$\operatorname*{seplist}T$ is weakly increasing. We will refer to this fact as
the \textquotedblleft separational definition of benignity\textquotedblright.

Let $\mathbf{S}$ denote the set of all benign 12-tables.\footnote{We recall
that $Z$ is fixed, and all 12-tables have to have $Z$ as their domain.} Then,
$\mathbf{S}$ is a finite set (since there are only finitely many ways to
assign either $1$ or $2$ to each cell in $Z$) and we have $\mathbf{R}%
\subseteq\mathbf{S}$\ \ \ \ \footnote{\textit{Proof.} Let $T\in\mathbf{R}$.
Then, $T$ is a 12-rpp of shape $Z$ (since $\mathbf{R}$ is the set of all
12-rpps of shape $Z$). Thus, $T$ is a 12-table which has no conflicts
(according to (\ref{pf.lem.BK.no-conflicts})), and therefore a benign
12-table. In other words, $T\in\mathbf{S}$.
\par
Now, let us forget that we fixed $T$. We thus have shown that $T\in\mathbf{S}$
for every $T\in\mathbf{R}$. In other words, $\mathbf{R}\subseteq\mathbf{S}$,
qed.}.

\subsection{The $\operatorname*{flip}$ map on benign 12-tables}

We can define a map $\operatorname*{flip}:\mathbf{S}\rightarrow\mathbf{S}$ as
follows: Let $T\in\mathbf{S}$; that is, let $T$ be a benign 12-table. For
every $k\in\mathbb{N}_{+}$ for which the $k$-th column of $T$ is nonempty, we
transform the $k$-th column of $T$ as follows:

\begin{itemize}
\item If this column is 1-pure, we replace all its entries by $2$'s (so that
it becomes 2-pure).

\item If this column is 2-pure, we replace all its entries by $1$'s (so that
it becomes 1-pure).

\item Otherwise (i.e., if this column is mixed), we do not change it.
\end{itemize}

(These three steps, of course, are done simultaneously, not successively; so
the column changes at most once.)

Once these transformations are made for all $k$, the resulting filling of $Z$
is a 12-table which is still benign (because its mixed columns are precisely
the mixed columns of the original $T$). We define $\operatorname*{flip}\left(
T\right)  $ to be this resulting benign 12-table. Thus, the map
$\operatorname*{flip}:\mathbf{S}\rightarrow\mathbf{S}$ is defined.

For example, if $T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 1 & 1 & 2 & 1 \\
%1 & 1 & 1 \\
%1 & 2 & 1 \\
%1 & 2 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 1 & 1 & 2 & 1 \\
1 & 1 & 1 \\
1 & 2 & 1 \\
1 & 2 \\
2
\end{ytableau}%
%EndExpansion
$, then $\operatorname*{flip}\left(  T\right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 1 & 2 & 1 & 2 \\
%1 & 1 & 2 \\
%1 & 2 & 2 \\
%1 & 2 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 1 & 2 & 1 & 2 \\
1 & 1 & 2 \\
1 & 2 & 2 \\
1 & 2 \\
2
\end{ytableau}%
%EndExpansion
$.

The following proposition gathers some easy properties of
$\operatorname*{flip}$:

\begin{proposition}
\label{prop.flip}\textbf{(a)} We have $\operatorname*{flip}\circ
\operatorname*{flip}=\operatorname*{id}$ (that is, the map
$\operatorname*{flip}$ is an involution).

\textbf{(b)} Let $T$ be a benign 12-table. When $T$ is transformed into
$\operatorname*{flip}\left(  T\right)  $, the 1-pure columns of $T$ become
2-pure columns of $\operatorname*{flip}\left(  T\right)  $, and the 2-pure
columns of $T$ become 1-pure columns of $\operatorname*{flip}\left(  T\right)
$, while the mixed columns and the empty columns do not change.

\textbf{(c)} For every benign 12-table $T$, we have%
\begin{equation}
\operatorname*{ceq}\left(  \operatorname*{flip}\left(  T\right)  \right)
=\operatorname*{ceq}\left(  T\right)  \label{pf.lem.BK.flip.ceq}%
\end{equation}
and%
\begin{equation}
\operatorname*{ircont}\left(  \operatorname*{flip}\left(  T\right)  \right)
=s_{1}\cdot\operatorname*{ircont}\left(  T\right)  .
\label{pf.lem.BK.flip.ircont}%
\end{equation}

\end{proposition}

\begin{proof}
[Proof of Proposition \ref{prop.flip}.]\textbf{(b)} Proposition
\ref{prop.flip} \textbf{(b)} follows immediately from the definition of
$\operatorname*{flip}$.

\textbf{(a)} It is clearly enough to show that $\left(  \operatorname*{flip}%
\circ\operatorname*{flip}\right)  \left(  T\right)  =T$ for every
$T\in\mathbf{S}$. So let us fix $T\in\mathbf{S}$. We need to show that
$\left(  \operatorname*{flip}\circ\operatorname*{flip}\right)  \left(
T\right)  =T$.

To obtain $\left(  \operatorname*{flip}\circ\operatorname*{flip}\right)
\left(  T\right)  $, we need to apply the map $\operatorname*{flip}$ to $T$
once, and then apply $\operatorname*{flip}$ again to the result. When we apply
the map $\operatorname*{flip}$ to $T$ once, every 1-pure column of $T$ becomes
a 2-pure column (due to Proposition \ref{prop.flip} \textbf{(b)}). A second,
subsequent application of $\operatorname*{flip}$ then turns this 2-pure column
back into a 1-pure column (due to Proposition \ref{prop.flip} \textbf{(b)}),
which is exactly how it was in $T$. Hence, every 1-pure column of $T$ appears
unchanged in $\left(  \operatorname*{flip}\circ\operatorname*{flip}\right)
\left(  T\right)  $. Similarly, we can prove the same for 2-pure columns and
mixed columns (and, of course, empty columns). Thus, every column of $T$
appears unchanged in $\left(  \operatorname*{flip}\circ\operatorname*{flip}%
\right)  \left(  T\right)  $. Hence, $\left(  \operatorname*{flip}%
\circ\operatorname*{flip}\right)  \left(  T\right)  =T$. This proves
Proposition \ref{prop.flip} \textbf{(a)}.

\textbf{(c)} Let $T$ be a benign 12-table. It is easy to see that the stagnant
cells of $\operatorname*{flip}\left(  T\right)  $ are precisely the stagnant
cells of $T$. This yields $\left(  \operatorname*{ceq}\left(
\operatorname*{flip}\left(  T\right)  \right)  \right)  _{i}=\left(
\operatorname*{ceq}\left(  T\right)  \right)  _{i}$ for every $i\in
\mathbb{N}_{+}$ (due to how $\left(  \operatorname*{ceq}\left(
\operatorname*{flip}\left(  T\right)  \right)  \right)  _{i}$ and $\left(
\operatorname*{ceq}\left(  T\right)  \right)  _{i}$ were defined in terms of
stagnant cells). In other words, $\operatorname*{ceq}\left(
\operatorname*{flip}\left(  T\right)  \right)  =\operatorname*{ceq}\left(
T\right)  $. This proves (\ref{pf.lem.BK.flip.ceq}).

It remains to prove (\ref{pf.lem.BK.flip.ircont}). First, we notice that (as a
consequence of Proposition \ref{prop.flip} \textbf{(b)}) we have
\begin{align*}
&  \left(  \text{the set of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ is
1-pure}\right) \\
&  =\left(  \text{the set of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is 2-pure}\right)  ,
\end{align*}%
\begin{align*}
&  \left(  \text{the set of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ is
2-pure}\right) \\
&  =\left(  \text{the set of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is 1-pure}\right)  ,
\end{align*}
and%
\begin{align*}
&  \left(  \text{the set of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ is
mixed}\right) \\
&  =\left(  \text{the set of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is mixed}\right)  .
\end{align*}
Of course, we can replace \textquotedblleft set\textquotedblright\ by
\textquotedblleft number\textquotedblright\ in these three equalities, and
thus obtain%
\begin{align*}
&  \left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ is
1-pure}\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is 2-pure}\right)  ,
\end{align*}%
\begin{align*}
&  \left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ is
2-pure}\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is 1-pure}\right)  ,
\end{align*}
and%
\begin{align*}
&  \left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ is
mixed}\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is mixed}\right)  .
\end{align*}


Now, we shall show that every $i\in\mathbb{N}_{+}$ satisfies%
\begin{equation}
\left(  \operatorname*{ircont}\left(  \operatorname*{flip}\left(  T\right)
\right)  \right)  _{i}=\left(  s_{1}\cdot\operatorname*{ircont}\left(
T\right)  \right)  _{i}. \label{pf.lem.BK.flip.conts}%
\end{equation}


\textit{Proof of (\ref{pf.lem.BK.flip.conts}):} Fix $i\in\mathbb{N}_{+}$. We
must be in one of the following three cases:

\textit{Case 1:} We have $i=1$.

\textit{Case 2:} We have $i=2$.

\textit{Case 3:} We have $i\notin\left\{  1,2\right\}  $.

Let us first consider Case 1. In this case, we have $i=1$. Thus, $s_{1}%
^{-1}\left(  i\right)  =2$. Now, from $i=1$, we obtain%
\begin{align*}
&  \left(  \operatorname*{ircont}\left(  \operatorname*{flip}\left(  T\right)
\right)  \right)  _{i}\\
&  =\left(  \operatorname*{ircont}\left(  \operatorname*{flip}\left(
T\right)  \right)  \right)  _{1}\\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ contains
}1\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by the definition of }\left(
\operatorname*{ircont}\left(  \operatorname*{flip}\left(  T\right)  \right)
\right)  _{1}\right) \\
&  =\underbrace{\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such
that the }k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{
is 1-pure}\right)  }_{=\left(  \text{the number of }k\in\mathbb{N}_{+}\text{
such that the }k\text{-th column of }T\text{ is 2-pure}\right)  }\\
&  \ \ \ \ \ \ \ \ \ \ +\underbrace{\left(  \text{the number of }%
k\in\mathbb{N}_{+}\text{ such that the }k\text{-th column of }%
\operatorname*{flip}\left(  T\right)  \text{ is mixed}\right)  }_{=\left(
\text{the number of }k\in\mathbb{N}_{+}\text{ such that the }k\text{-th column
of }T\text{ is mixed}\right)  }\\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{because the columns of }\operatorname*{flip}\left(  T\right)  \text{
containing }1\text{ are}\\
\text{precisely the 1-pure and the mixed columns}%
\end{array}
\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is 2-pure}\right) \\
&  \ \ \ \ \ \ \ \ \ \ +\left(  \text{the number of }k\in\mathbb{N}_{+}\text{
such that the }k\text{-th column of }T\text{ is mixed}\right)  .
\end{align*}
Compared with%
\begin{align*}
&  \left(  s_{1}\cdot\operatorname*{ircont}\left(  T\right)  \right)  _{i}\\
&  =\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{s_{1}%
^{-1}\left(  i\right)  }=\left(  \operatorname*{ircont}\left(  T\right)
\right)  _{2}\ \ \ \ \ \ \ \ \ \ \left(  \text{since }s_{1}^{-1}\left(
i\right)  =2\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ contains }2\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by the definition of }\left(
\operatorname*{ircont}\left(  T\right)  \right)  _{2}\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ is 2-pure}\right) \\
&  \ \ \ \ \ \ \ \ \ \ +\left(  \text{the number of }k\in\mathbb{N}_{+}\text{
such that the }k\text{-th column of }T\text{ is mixed}\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{because the columns of }T\text{ containing }2\text{ are}\\
\text{precisely the 2-pure and the mixed columns}%
\end{array}
\right)  ,
\end{align*}
this yields $\left(  \operatorname*{ircont}\left(  \operatorname*{flip}\left(
T\right)  \right)  \right)  _{i}=\left(  s_{1}\cdot\operatorname*{ircont}%
\left(  T\right)  \right)  _{i}$. Hence, (\ref{pf.lem.BK.flip.conts}) is
proven in Case 1.

We leave the proof of (\ref{pf.lem.BK.flip.conts}) in Case 2 to the reader.
(It is completely analogous to the proof in Case 1.)

Let us now consider Case 3. In this case, we have $i\notin\left\{
1,2\right\}  $. Thus, no entry of $T$ equals $i$ (since all entries of $T$ are
$1$'s and $2$'s). Hence, no column of $T$ contains $i$. The same argument (but
applied to $\operatorname*{flip}\left(  T\right)  $ instead of $T$) shows that
no column of $\operatorname*{flip}\left(  T\right)  $ contains $i$. Now,%
\begin{align*}
&  \left(  \operatorname*{ircont}\left(  \operatorname*{flip}\left(  T\right)
\right)  \right)  _{i}\\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }\operatorname*{flip}\left(  T\right)  \text{ contains
}i\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by the definition of }\left(
\operatorname*{ircont}\left(  \operatorname*{flip}\left(  T\right)  \right)
\right)  _{i}\right) \\
&  =0\ \ \ \ \ \ \ \ \ \ \left(  \text{since no column of }%
\operatorname*{flip}\left(  T\right)  \text{ contains }i\right)  .
\end{align*}
Compared with%
\begin{align*}
\left(  s_{1}\cdot\operatorname*{ircont}\left(  T\right)  \right)  _{i}  &
=\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{s_{1}^{-1}\left(
i\right)  }=\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{i}\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }s_{1}^{-1}\left(  i\right)
=i\text{ (since }i\notin\left\{  1,2\right\}  \text{)}\right) \\
&  =\left(  \text{the number of }k\in\mathbb{N}_{+}\text{ such that the
}k\text{-th column of }T\text{ contains }i\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by the definition of }\left(
\operatorname*{ircont}\left(  T\right)  \right)  _{i}\right) \\
&  =0\ \ \ \ \ \ \ \ \ \ \left(  \text{since no column of }T\text{ contains
}i\right)  ,
\end{align*}
this yields $\left(  \operatorname*{ircont}\left(  \operatorname*{flip}\left(
T\right)  \right)  \right)  _{i}=\left(  s_{1}\cdot\operatorname*{ircont}%
\left(  T\right)  \right)  _{i}$. Hence, (\ref{pf.lem.BK.flip.conts}) is
proven in Case 3.

We have now proven (\ref{pf.lem.BK.flip.conts}) in Cases 1, 2 and 3. Since
these Cases cover all possibilities, this shows that
(\ref{pf.lem.BK.flip.conts}) always holds.

Now, having proven (\ref{pf.lem.BK.flip.conts}), we can immediately conclude
that $\operatorname*{ircont}\left(  \operatorname*{flip}\left(  T\right)
\right)  =s_{1}\cdot\operatorname*{ircont}\left(  T\right)  $. In other words,
(\ref{pf.lem.BK.flip.ircont}) holds. The proof of Proposition \ref{prop.flip}
\textbf{(c)} is thus complete.
\end{proof}

We notice that, when the map $\operatorname*{flip}$ acts on a benign 12-table
$T$, it transforms every column of $T$ independently. Thus, we have the following:

\begin{remark}
\label{rmk.flip.independent}If $P$ and $Q$ are two benign 12-tables, and if
$i\in\mathbb{N}_{+}$ is such that%
\[
\left(  \text{the }i\text{-th column of }P\right)  =\left(  \text{the
}i\text{-th column of }Q\right)  ,
\]
then%
\[
\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(  P\right)
\right)  =\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
Q\right)  \right)  .
\]

\end{remark}

\subsection{Plan of the proof}

Let us now briefly sketch the ideas behind the rest of the proof before we go
into them in detail. The map $\operatorname*{flip}:\mathbf{S}\rightarrow
\mathbf{S}$ does not generally send 12-rpps to 12-rpps (i.e., it does not
restrict to a map $\mathbf{R}\rightarrow\mathbf{R}$). However, we shall amend
this by defining a way to transform any benign 12-table into a 12-rpp by what
we call \textquotedblleft resolving conflicts\textquotedblright. The process
of \textquotedblleft resolving conflicts\textquotedblright\ will be a stepwise
process, and will be formalized in terms of a binary relation $\Rrightarrow$
on the set $\mathbf{S}$ which we will soon introduce. The intuition behind
saying \textquotedblleft$P\Rrightarrow Q$\textquotedblright\ is that the
benign 12-table $P$ has a \textquotedblleft resolvable\textquotedblright%
\ conflict, resolving which yields the benign 12-table $Q$. By
\textquotedblleft resolvable conflict\textquotedblright, we mean a conflict
$\left(  i,j\right)  $ with $j=i+1$. (The relation $\Rrightarrow$ is similar
to the relation $\Rrightarrow$ from Subsection \ref{subsect.bubble}.
\textquotedblleft Resolving\textquotedblright\ a resolvable conflict in a
benign 12-table $P$ is an analogue of switching two adjacent entries of an
$n$-tuple $z$ which are out of order.) Starting with a benign 12-table $P$, we
can repeatedly resolve \textquotedblleft resolvable\textquotedblright%
\ conflicts until this is no longer possible (because we will show that if
\textquotedblleft resolving\textquotedblright\ a conflict in $P$ yields a new
12-table $Q$, then $\ell\left(  P\right)  >\ell\left(  Q\right)  $ using the
notations of Subsection \ref{subsect.fourtypes}; the function $\ell$ thus
plays the same role as the function $\ell$ in Subsection \ref{subsect.bubble}%
). We have some freedom in performing this process, because at any step there
can be a choice of several resolvable conflicts to resolve; but we will see
(using Lemma \ref{lem.diamond}) that the final result does not depend on the
process. Hence, the final result can be a function of $P$. We will denote it
by $\operatorname*{norm}P$, and we will see that it is a 12-rpp. We will then
define a map $\mathbf{B}:\mathbf{R}\rightarrow\mathbf{R}$ by $\mathbf{B}%
\left(  T\right)  =\operatorname*{norm}\left(  \operatorname*{flip}T\right)
$, and show that it is an involution satisfying the properties that we want it
to satisfy.

\subsection{Resolving conflicts}

Now we come to the details.

Let $k\in\mathbb{N}_{+}$. Let $P\in\mathbf{S}$. Thus, $P$ is a benign
12-table. Assume that $\left(  k,k+1\right)  $ is a conflict of $P$. In this
case, we say that $\left(  k,k+1\right)  $ is a \textit{resolvable conflict}
of $P$ (and, in a moment, we will explain what it means to \textquotedblleft
resolve\textquotedblright\ it). Since $\left(  k,k+1\right)  $ is a conflict
of $P$, it is clear that the $k$-th column of $P$ must contain at least one
$2$. Hence, the $k$-th column of $P$ is either mixed or 2-pure. Similarly, the
$\left(  k+1\right)  $-st column of $P$ is either mixed or 1-pure. Thus, we
must be in one of the following four cases:

\textit{Case 1:} The $k$-th column of $P$ is mixed, and the $\left(
k+1\right)  $-th column of $P$ is mixed.

\textit{Case 2:} The $k$-th column of $P$ is mixed, and the $\left(
k+1\right)  $-th column of $P$ is 1-pure.

\textit{Case 3:} The $k$-th column of $P$ is 2-pure, and the $\left(
k+1\right)  $-th column of $P$ is mixed.

\textit{Case 4:} The $k$-th column of $P$ is 2-pure, and the $\left(
k+1\right)  $-th column of $P$ is 1-pure.

But Case 1 is impossible\footnote{because there exists no conflict $\left(
i,j\right)  $ of $P$ such that the $i$-th column of $P$ and the $j$-th column
of $P$ both are mixed (since $P$ is benign), but in Case 1 the pair $\left(
k,k+1\right)  $ would be such a conflict}. Thus, we must be in one of the
three Cases 2, 3 and 4. Let us introduce a notation to signify in which of
these three cases we are:

\begin{itemize}
\item We say that the 12-table $P$ has $k$\textit{-type M1} if we are in Case
2. (In other words, $P$ has $k$-type M1 if the $k$-th column of $P$ is mixed
and the $\left(  k+1\right)  $-th column of $P$ is 1-pure.)

\item We say that the 12-table $P$ has $k$\textit{-type 2M} if we are in Case
3. (In other words, $P$ has $k$-type 2M if the $k$-th column of $P$ is 2-pure
and the $\left(  k+1\right)  $-th column of $P$ is mixed.)

\item We say that the 12-table $P$ has $k$\textit{-type 21} if we are in Case
4. (In other words, $P$ has $k$-type 21 if the $k$-th column of $P$ is 2-pure
and the $\left(  k+1\right)  $-th column of $P$ is 1-pure.)
\end{itemize}

Thus, the 12-table $P$ always either has $k$-type M1, or has $k$-type 2M, or
has $k$-type 21 (because we must always be in one of the three Cases 2, 3 and 4).

(Of course, the names \textquotedblleft M1\textquotedblright,
\textquotedblleft2M\textquotedblright, \textquotedblleft21\textquotedblright%
\ have been chosen to match the types of the columns: e.g., \textquotedblleft%
2M\textquotedblright\ stands for \textquotedblleft\textbf{2}-pure and
\textbf{M}ixed\textquotedblright.)

Now, we define a new 12-table $\operatorname*{res}\nolimits_{k}P$ as follows:

\begin{itemize}
\item If $P$ has $k$-type M1, then we let $\operatorname*{res}_{k}P$ be the
12-table which differs from $P$ in that the $k$-th column of
$\operatorname*{res}_{k}P$ is 1-pure (i.e., it is filled with $1$'s), whereas
the $\left(  k+1\right)  $-th column of $\operatorname*{res}\nolimits_{k}P$ is
mixed and satisfies $\operatorname*{sep}\nolimits_{k+1}\left(
\operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{sep}\nolimits_{k}%
P$.\ \ \ \ \footnote{Let us prove that this is a legitimate definition for
$\operatorname*{res}_{k}P$.
\par
First of all, the requirements that we are imposing on $\operatorname*{res}%
_{k}P$ determine the 12-table $\operatorname*{res}_{k}P$ uniquely: In fact,
its $k$-th column is uniquely determined by the requirement that it be 1-pure;
its $\left(  k+1\right)  $-th column is uniquely determined by the requirement
that it be mixed and that $\operatorname*{sep}\nolimits_{k+1}\left(
\operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{sep}\nolimits_{k}P$;
all its other columns are copied from $P$ unchanged.
\par
But it is not immediately that there exists a 12-table $\operatorname*{res}%
\nolimits_{k}P$ which meets these requirements. What can go wrong is the
requirement that the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ be mixed and satisfy $\operatorname*{sep}\nolimits_{k+1}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{sep}%
\nolimits_{k}P$. We can try to achieve this by setting
\begin{align}
\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,k+1\right)   &
=\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }r<\operatorname*{sep}\nolimits_{k}P;\\
2,\ \ \ \ \ \ \ \ \ \ \text{if }r\geq\operatorname*{sep}\nolimits_{k}P
\end{array}
\right. \label{eq.def.res.check2}\\
&  \ \ \ \ \ \ \ \ \ \ \text{for all }h\in\mathbb{N}_{+}\text{ for which
}\left(  r,k+1\right)  \in Z.\nonumber
\end{align}
This (together with the requirements on the other columns) defines a 12-table
$\operatorname*{res}\nolimits_{k}P$, but we still need to check that the thus
resulting $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ is actually mixed.
\par
Let us denote $\operatorname*{sep}\nolimits_{k}P$ by $s$. We recall that
$\operatorname*{sep}\nolimits_{k}P$ is the smallest $r\in\mathbb{N}_{+}$ such
that $\left(  r,k\right)  \in Z$ and $P\left(  r,k\right)  =2$. Hence,
$\left(  \operatorname*{sep}\nolimits_{k}P,k\right)  \in Z$ and $P\left(
\operatorname*{sep}\nolimits_{k}P,k\right)  =2$. In other words, $\left(
s,k\right)  \in Z$ and $P\left(  s,k\right)  =2$ (since $s=\operatorname*{sep}%
\nolimits_{k}P$).
\par
We also recall that the $k$-th column of $P$ is mixed, and thus contains a
$1$. In other words, there exists a $w\in\mathbb{N}_{+}$ such that $\left(
w,k\right)  \in Z$ and $P\left(  w,k\right)  =1$. Consider this $w$.
\par
If $s\leq w$, then%
\begin{align*}
2  &  =P\left(  s,k\right)  \leq P\left(  w,k\right)
\ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since }s\leq w\text{, and since the entries of }P\\
\text{are weakly increasing down columns}%
\end{array}
\right) \\
&  =1,
\end{align*}
which contradicts $2>1$. Hence, we cannot have $s\leq w$. Thus, $w<s$.
\par
But recall that $\left(  k,k+1\right)  $ is a conflict of $P$. Thus, there
exists a $q\in\mathbb{N}_{+}$ satisfying $\left(  q,k\right)  \in Z$, $\left(
q,k+1\right)  \in Z$, $P\left(  q,k\right)  =2$ and $P\left(  q,k+1\right)
=1$. Consider this $q$. Clearly, $q$ is an $r\in\mathbb{N}_{+}$ such that
$\left(  r,k\right)  \in Z$ and $P\left(  r,k\right)  =2$. Since
$\operatorname*{sep}\nolimits_{k}P$ is the \textbf{smallest} such $r$, we thus
have $q\geq\operatorname*{sep}\nolimits_{k}P$. In other words, $q\geq s$
(since $s=\operatorname*{sep}\nolimits_{k}P$), so that $s\leq q$. Thus,
$w<s\leq q$.
\par
Now, the set $Z$ is convex, and we have $\left(  w,k\right)  \in Z$ and
$\left(  q,k+1\right)  \in Z$. Hence, $\left(  q,k+1\right)  \in Z$ (by
(\ref{eq.convex}), applied to $w$, $q$, $q$, $k$, $k+1$ and $k+1$ instead of
$i$, $i^{\prime}$, $i^{\prime\prime}$, $j$, $j^{\prime}$ and $j^{\prime\prime
}$). Hence, $\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(
q,k+1\right)  $ is well-defined. Moreover, (\ref{eq.def.res.check2}) (applied
to $r=q$) yields
\[
\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  q,k+1\right)
=\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }q<\operatorname*{sep}\nolimits_{k}P;\\
2,\ \ \ \ \ \ \ \ \ \ \text{if }q\geq\operatorname*{sep}\nolimits_{k}P
\end{array}
\right.  =2\ \ \ \ \ \ \ \ \ \ \left(  \text{since }q\geq
s=\operatorname*{sep}\nolimits_{k}P\right)  .
\]
Thus, the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ contains at least one $2$.
\par
On the other hand, the set $Z$ is convex, and we have $\left(  w,k\right)  \in
Z$ and $\left(  q,k+1\right)  \in Z$. Hence, $\left(  w,k+1\right)  \in Z$ (by
(\ref{eq.convex}), applied to $w$, $w$, $q$, $k$, $k+1$ and $k+1$ instead of
$i$, $i^{\prime}$, $i^{\prime\prime}$, $j$, $j^{\prime}$ and $j^{\prime\prime
}$). Hence, $\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(
w,k+1\right)  $ is well-defined. Moreover, (\ref{eq.def.res.check2}) (applied
to $r=w$) yields
\[
\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  w,k+1\right)
=\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }w<\operatorname*{sep}\nolimits_{k}P;\\
2,\ \ \ \ \ \ \ \ \ \ \text{if }w\geq\operatorname*{sep}\nolimits_{k}P
\end{array}
\right.  =2\ \ \ \ \ \ \ \ \ \ \left(  \text{since }w<s=\operatorname*{sep}%
\nolimits_{k}P\right)  .
\]
Thus, the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ contains at least one $1$. Since it also contains at least one
$2$, it must therefore be mixed. Now, it is clear that $\operatorname*{sep}%
\nolimits_{k+1}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{sep}\nolimits_{k}P$ (due to (\ref{eq.def.res.check2})). Thus,
the tableau $\operatorname*{res}\nolimits_{k}P$ we have constructed actually
meets the requirements we have imposed on it. This completes the proof of the
well-definedness.}

\item If $P$ has $k$-type 2M, then we let $\operatorname*{res}_{k}P$ be the
12-table which differs from $P$ in that the $k$-th column of
$\operatorname*{res}_{k}P$ is mixed and satisfies $\operatorname*{sep}%
\nolimits_{k}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{sep}\nolimits_{k+1}P$, whereas the $\left(  k+1\right)  $-th
column of $\operatorname*{res}\nolimits_{k}P$ is 2-pure (i.e., it is filled
with $2$'s).\ \ \ \ \footnote{Again, it is easy to see that this is
well-defined.}

\item If $P$ has $k$-type 21, then we let $\operatorname*{res}_{k}P$ be the
12-table which differs from $P$ in that the $k$-th column of
$\operatorname*{res}_{k}P$ is 1-pure, whereas the $\left(  k+1\right)  $-th
column of $\operatorname*{res}\nolimits_{k}P$ is 2-pure.
\end{itemize}

In either case, $\operatorname*{res}\nolimits_{k}P$ is a well-defined
12-table. It is furthermore clear that $\operatorname*{seplist}\left(
\operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{seplist}P$. Thus,
using the \textquotedblleft separational definition of
benignity\textquotedblright, we see that $\operatorname*{res}\nolimits_{k}P$
is benign (since $P$ is benign); that is, $\operatorname*{res}\nolimits_{k}%
P\in\mathbf{S}$. We say that $\operatorname*{res}\nolimits_{k}P$ is the
12-table obtained by \textit{resolving} the conflict $\left(  k,k+1\right)  $
in $P$. Let us give some examples:

\begin{example}
\label{exa.resolve}Let $P=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 1 \\
%\none& 1 & 1 & 2 \\
%2 & 1 & 1 \\
%2 & 2 & 1 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 1 \\
\none& 1 & 1 & 2 \\
2 & 1 & 1 \\
2 & 2 & 1 \\
2
\end{ytableau}%
%EndExpansion
$. Then, $P$ is a benign 12-table (with only one mixed column), and its
conflicts are $\left(  1,2\right)  $, $\left(  1,3\right)  $, $\left(
2,3\right)  $ and $\left(  4,5\right)  $. Out of these conflicts, $\left(
1,2\right)  $, $\left(  2,3\right)  $ and $\left(  4,5\right)  $ are
resolvable (as they have the form $\left(  k,k+1\right)  $ for various $k$).
We have $\operatorname*{sep}\nolimits_{2}P=4$.

If we set $k=1$, then we land in Case 3 (that is, $P$ has $k$-type 2M), and
resolving the conflict $\left(  k,k+1\right)  =\left(  1,2\right)  $ gives us
the 12-table $\operatorname*{res}\nolimits_{1}P=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 1 \\
%\none& 2 & 1 & 2 \\
%1 & 2 & 1 \\
%2 & 2 & 1 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 1 \\
\none& 2 & 1 & 2 \\
1 & 2 & 1 \\
2 & 2 & 1 \\
2
\end{ytableau}%
%EndExpansion
$.

If we instead set $k=2$, then we land in Case 2 (that is, $P$ has $k$-type
M1), and resolving the conflict $\left(  k,k+1\right)  =\left(  2,3\right)  $
gives us the 12-table $\operatorname*{res}\nolimits_{2}P=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 1 \\
%\none& 1 & 1 & 2 \\
%2 & 1 & 1 \\
%2 & 1 & 2 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 1 \\
\none& 1 & 1 & 2 \\
2 & 1 & 1 \\
2 & 1 & 2 \\
2
\end{ytableau}%
%EndExpansion
$.

If we instead set $k=4$, then we land in Case 4 (that is, $P$ has $k$-type
21), and resolving the conflict $\left(  k,k+1\right)  =\left(  4,5\right)  $
gives us the 12-table $\operatorname*{res}\nolimits_{4}P=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 1 & 2 \\
%\none& 1 & 1 & 1 \\
%2 & 1 & 1 \\
%2 & 2 & 1 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 1 & 2 \\
\none& 1 & 1 & 1 \\
2 & 1 & 1 \\
2 & 2 & 1 \\
2
\end{ytableau}%
%EndExpansion
$.

We notice that each of the three 12-tables $\operatorname*{res}\nolimits_{1}%
P$, $\operatorname*{res}\nolimits_{2}P$ and $\operatorname*{res}%
\nolimits_{4}P$ still has conflicts\footnotemark, and again some of these
conflicts are resolvable. In order to get a 12-rpp from $P$, we will have to
keep resolving these conflicts until none remain.
\end{example}

\footnotetext{Actually, each of these three 12-tables has fewer conflicts than
$P$ (in particular, the conflict that was resolved is now gone). But this does
not generalize. For instance, if $P=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 1 & 1 \\
%2 & 1
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 1 & 1 \\
2 & 1
\end{ytableau}%
%EndExpansion
$ and $k=1$, then resolving the conflict $\left(  k,k+1\right)  =\left(
1,2\right)  $ (which is the only conflict of $P$) leads to the 12-table
$\operatorname*{res}\nolimits_{1}P=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& 2 & 1 \\
%1 & 2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& 2 & 1 \\
1 & 2
\end{ytableau}%
%EndExpansion
$, which has as many conflicts as $P$ did.}We now observe some further
properties of $\operatorname*{res}\nolimits_{k}P$:

\begin{proposition}
\label{prop.conflict-resolution-props}Let $P\in\mathbf{S}$ and $k\in
\mathbb{N}_{+}$ be such that $\left(  k,k+1\right)  $ is a conflict of $P$.

\textbf{(a)} The 12-table $\operatorname*{res}\nolimits_{k}P$ differs from $P$
only in columns $k$ and $k+1$. In other words,%
\begin{equation}
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{k}%
P\right)  =\left(  \text{the }h\text{-th column of }P\right)
\label{pf.lem.BK.res.loc}%
\end{equation}
for every $h\in\mathbb{N}_{+}\setminus\left\{  k,k+1\right\}  $.

\textbf{(b)} The $k$-th and the $\left(  k+1\right)  $-th columns of
$\operatorname*{res}\nolimits_{k}P$ depend only on the $k$-th and the $\left(
k+1\right)  $-th columns of $P$. In other words, if $Q$ is a further benign
12-table satisfying%
\begin{align*}
\left(  \text{the }h\text{-th column of }Q\right)   &  =\left(  \text{the
}h\text{-th column of }P\right) \\
&  \ \ \ \ \ \ \ \ \ \ \text{for each }h\in\left\{  k,k+1\right\}  ,
\end{align*}
then%
\begin{align}
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{k}%
Q\right)   &  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{k}P\right) \label{pf.lem.BK.res.loc2}\\
&  \ \ \ \ \ \ \ \ \ \ \text{for each }h\in\left\{  k,k+1\right\}  .\nonumber
\end{align}


\textbf{(c)} We have%
\begin{equation}
\operatorname*{ceq}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{ceq}\left(  P\right)  . \label{pf.lem.BK.res.ceq}%
\end{equation}


\textbf{(d)} We have%
\begin{align}
&  \left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }\operatorname*{res}\nolimits_{k}P\text{ is
mixed}\right) \nonumber\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }P\text{ is mixed}\right)  , \label{pf.lem.BK.res.mixed}%
\end{align}%
\begin{align}
&  \left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }\operatorname*{res}\nolimits_{k}P\text{ is
1-pure}\right) \nonumber\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }P\text{ is 1-pure}\right)  ,
\label{pf.lem.BK.res.1pure}%
\end{align}%
\begin{align}
&  \left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }\operatorname*{res}\nolimits_{k}P\text{ is
2-pure}\right) \nonumber\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }P\text{ is 2-pure}\right)  ,
\label{pf.lem.BK.res.2pure}%
\end{align}
and%
\begin{equation}
\operatorname*{ircont}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{ircont}\left(  P\right)  . \label{pf.lem.BK.res.irconts}%
\end{equation}


\textbf{(e)} For every $r\in\mathbb{N}_{+}$ and $i\in\mathbb{N}_{+}$
satisfying $\left(  r,i\right)  \in Z$ and $\left(  r,s_{k}\left(  i\right)
\right)  \in Z$, we have%
\begin{equation}
P\left(  r,i\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,s_{k}\left(  i\right)  \right)  . \label{pf.lem.BK.res.Pli}%
\end{equation}


\textbf{(f)} If $\left(  i,j\right)  $ is a conflict of $P$ such that $\left(
i,j\right)  \neq\left(  k,k+1\right)  $, then
\begin{equation}
\left(  s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  \text{ is a
conflict of }\operatorname*{res}\nolimits_{k}P.
\label{pf.lem.BK.res.conflict1}%
\end{equation}


\textbf{(g)} The benign 12-tables $\operatorname*{flip}\left(  P\right)  $ and
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $ have
the property that%
\begin{equation}
\left(
\begin{array}
[c]{c}%
\left(  k,k+1\right)  \text{ is a conflict of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \text{,}\\
\text{and we have }\operatorname*{flip}\left(  P\right)  =\operatorname*{res}%
\nolimits_{k}\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)
\end{array}
\right)  . \label{pf.lem.BK.res.flip}%
\end{equation}


\textbf{(h)} Recall that we defined a nonnegative integer $\ell\left(
T\right)  $ for every 12-table $T$ in Subsection \ref{subsect.fourtypes}. We
have
\begin{equation}
\ell\left(  P\right)  >\ell\left(  \operatorname*{res}\nolimits_{k}P\right)  .
\label{pf.lem.BK.res.lendec}%
\end{equation}

\end{proposition}

Notice that the converse of Proposition \ref{prop.conflict-resolution-props}
\textbf{(f)} does not generally hold.

\begin{proof}
[Proof of Proposition \ref{prop.conflict-resolution-props}.]Before we come to
the actual proof, let us notice a simple fact:

For any $\left(  i,j\right)  \in\mathbb{N}_{+}^{2}$ satisfying $i<j$, we have%
\begin{equation}
s_{k}\left(  i\right)  <s_{k}\left(  j\right)  \ \ \ \ \ \ \ \ \ \ \text{if
}\left(  i,j\right)  \neq\left(  k,k+1\right)
\label{pf.prop.conflict-resolution.props.inversion-transform}%
\end{equation}


\begin{vershort}
(Indeed, this is straightforward to check.)
\end{vershort}

\begin{verlong}
\footnote{\textit{Proof:} The proof of
(\ref{pf.prop.conflict-resolution.props.inversion-transform}) is analogous to
the proof of (\ref{pf.prop.diamond.example.poset.inversion-transform}) (the
only difference being that $\left(  i,j\right)  $ is now an element of
$\mathbb{N}_{+}^{2}$ rather than an element of $\left\{  1,2,\ldots,n\right\}
^{2}$).}
\end{verlong}

Parts \textbf{(a)} and \textbf{(b)} of Proposition
\ref{prop.conflict-resolution-props} follow immediately from the construction
of $\operatorname*{res}\nolimits_{k}P$.

\textbf{(c)} Let $i\in\mathbb{N}_{+}$. We say that a positive integer
$j\in\mathbb{N}_{+}$ is \textit{good} if $\left(  i,j\right)  \in Z$ and
$\left(  i+1,j\right)  \in Z$. Let $z_{i}$ denote the number of good
$j\in\mathbb{N}_{+}$.

Now, it is easy to see that%
\[
\left(  \operatorname*{ceq}\left(  P\right)  \right)  _{i}=z_{i}-\left(
\text{the number of appearances of }i+1\text{ in }\operatorname*{seplist}%
P\right)
\]
\footnote{\textit{Proof.} The definition of $\operatorname*{ceq}\left(
P\right)  $ yields%
\begin{align*}
&  \left(  \operatorname*{ceq}\left(  P\right)  \right)  _{i}\\
&  =\left(  \text{the number of }j\in\mathbb{N}_{+}\text{ such that }\left(
i,j\right)  \text{ is a stagnant cell of }P\right) \\
&  =\left(  \text{the number of good }j\in\mathbb{N}_{+}\text{ such that
}\left(  i,j\right)  \text{ is a stagnant cell of }P\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since every }j\in\mathbb{N}_{+}\text{
such that }\left(  i,j\right)  \text{ is a stagnant cell of }P\text{ must be
good}\right) \\
&  =\underbrace{\left(  \text{the number of good }j\in\mathbb{N}_{+}\right)
}_{=z_{i}}\\
&  \ \ \ \ \ \ \ \ \ \ -\underbrace{\left(  \text{the number of good }%
j\in\mathbb{N}_{+}\text{ such that }P\left(  i,j\right)  =1\text{ and
}P\left(  i+1,j\right)  =2\right)  }_{=\left(  \text{the number of }%
j\in\mathbb{N}_{+}\text{ such that the }j\text{-th column of }P\text{ is mixed
and satisfies }\operatorname*{sep}\nolimits_{j}P=i+1\right)  }\\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{because for a good }j\in\mathbb{N}_{+}\text{, we have that }\left(
i,j\right)  \text{ is a stagnant cell of}\\
P\text{ if and only if }j\text{ does \textbf{not} satisfy }\left(  P\left(
i,j\right)  =1\text{ and }P\left(  i+1,j\right)  =2\right)
\end{array}
\right) \\
&  =z_{i}-\underbrace{\left(  \text{the number of }j\in\mathbb{N}_{+}\text{
such that the }j\text{-th column of }P\text{ is mixed and satisfies
}\operatorname*{sep}\nolimits_{j}P=i+1\right)  }_{=\left(  \text{the number of
appearances of }i+1\text{ in }\operatorname*{seplist}P\right)  }\\
&  =z_{i}-\left(  \text{the number of appearances of }i+1\text{ in
}\operatorname*{seplist}P\right)  ,
\end{align*}
qed.}. The same argument (but applied to $\operatorname*{res}\nolimits_{k}P$
instead of $P$) yields%
\begin{align*}
&  \left(  \operatorname*{ceq}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  \right)  _{i}\\
&  =z_{i}-\left(  \text{the number of appearances of }i+1\text{ in
}\underbrace{\operatorname*{seplist}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  }_{=\operatorname*{seplist}P}\right) \\
&  =z_{i}-\left(  \text{the number of appearances of }i+1\text{ in
}\operatorname*{seplist}P\right)  =\left(  \operatorname*{ceq}\left(
P\right)  \right)  _{i}.
\end{align*}
Since we have proven this for every $i\in\mathbb{N}_{+}$, we can thus conclude
$\operatorname*{ceq}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{ceq}\left(  P\right)  $. This proves Proposition
\ref{prop.conflict-resolution-props} \textbf{(c)}.

\textbf{(d)} The equalities (\ref{pf.lem.BK.res.mixed}),
(\ref{pf.lem.BK.res.1pure}) and (\ref{pf.lem.BK.res.2pure}) follow directly
from the definition of $\operatorname*{res}\nolimits_{k}P$. It now remains to
prove (\ref{pf.lem.BK.res.irconts}). In other words, it remains to prove that
$\left(  \operatorname*{ircont}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  \right)  _{g}=\left(  \operatorname*{ircont}\left(  P\right)
\right)  _{g}$ for every $g\in\mathbb{N}_{+}$.

So let us fix an $g\in\mathbb{N}_{+}$. We must be in one of the following
three Cases:

\textit{Case 1:} We have $g=1$.

\textit{Case 2:} We have $g=2$.

\textit{Case 3:} We have $g\notin\left\{  1,2\right\}  $.

Let us consider Case 1 first. In this case, we have $g=1$. Now, any 12-table
$T$ satisfies%
\begin{align}
&  \left(  \operatorname*{ircont}\left(  T\right)  \right)  _{g}\nonumber\\
&  =\left(  \operatorname*{ircont}\left(  T\right)  \right)  _{1}%
\ \ \ \ \ \ \ \ \ \ \left(  \text{since }g=1\right) \nonumber\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }T\text{ contains }1\right) \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by the definition of }\left(
\operatorname*{ircont}\left(  T\right)  \right)  _{1}\right) \nonumber\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }T\text{ is 1-pure}\right) \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ +\left(  \text{the number of }h\in\mathbb{N}_{+}\text{
such that the }h\text{-th column of }T\text{ is mixed}\right)
\label{pf.lem.BK.res.irconts.pf.T}\\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since the columns of a 12-table that contain }1\text{ are precisely
the}\\
\text{columns that are either 1-pure or mixed}%
\end{array}
\right)  .\nonumber
\end{align}
Applying this to $T=P$, we obtain%
\begin{align}
&  \left(  \operatorname*{ircont}\left(  P\right)  \right)  _{g}\nonumber\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }P\text{ is 1-pure}\right) \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ +\left(  \text{the number of }h\in\mathbb{N}_{+}\text{
such that the }h\text{-th column of }P\text{ is mixed}\right)  .
\label{pf.lem.BK.res.irconts.pf.P}%
\end{align}
But applying (\ref{pf.lem.BK.res.irconts.pf.T}) to $T=\operatorname*{res}%
\nolimits_{k}P$, we obtain%
\begin{align*}
&  \left(  \operatorname*{ircont}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  \right)  _{g}\\
&  =\underbrace{\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such
that the }h\text{-th column of }\operatorname*{res}\nolimits_{k}P\text{ is
1-pure}\right)  }_{\substack{=\left(  \text{the number of }h\in\mathbb{N}%
_{+}\text{ such that the }h\text{-th column of }P\text{ is 1-pure}\right)
\\\text{(by (\ref{pf.lem.BK.res.1pure}))}}}\\
&  \ \ \ \ \ \ \ \ \ \ +\underbrace{\left(  \text{the number of }%
h\in\mathbb{N}_{+}\text{ such that the }h\text{-th column of }%
\operatorname*{res}\nolimits_{k}P\text{ is mixed}\right)  }%
_{\substack{=\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that
the }h\text{-th column of }P\text{ is mixed}\right)  \\\text{(by
(\ref{pf.lem.BK.res.mixed}))}}}\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }P\text{ is 1-pure}\right) \\
&  \ \ \ \ \ \ \ \ \ \ +\left(  \text{the number of }h\in\mathbb{N}_{+}\text{
such that the }h\text{-th column of }P\text{ is mixed}\right) \\
&  =\left(  \operatorname*{ircont}\left(  P\right)  \right)  _{g}%
\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BK.res.irconts.pf.P}%
)}\right)  .
\end{align*}
Thus, $\left(  \operatorname*{ircont}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  _{g}=\left(  \operatorname*{ircont}\left(
P\right)  \right)  _{g}$ is proven in Case 1.

In order to prove $\left(  \operatorname*{ircont}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  _{g}=\left(  \operatorname*{ircont}\left(
P\right)  \right)  _{g}$ in Case 2, we can apply the preceding proof for Case
1 almost verbatim; we only need to replace every appearance of
\textquotedblleft$1$\textquotedblright\ and of \textquotedblleft%
1-pure\textquotedblright\ by \textquotedblleft$2$\textquotedblright\ and
\textquotedblleft2-pure\textquotedblright, respectively, and apply
(\ref{pf.lem.BK.res.2pure}) instead of (\ref{pf.lem.BK.res.1pure}).

Let us now consider Case 3. In this case, we have $g\notin\left\{
1,2\right\}  $. Now, any 12-table $T$ satisfies%
\begin{align}
&  \left(  \operatorname*{ircont}\left(  T\right)  \right)  _{g}\nonumber\\
&  =\left(  \text{the number of }h\in\mathbb{N}_{+}\text{ such that the
}h\text{-th column of }T\text{ contains }g\right) \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by the definition of }\left(
\operatorname*{ircont}\left(  T\right)  \right)  _{g}\right) \nonumber\\
&  =0\ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since no column of }T\text{ contains }g\text{ (since no entry of
}T\text{ equals }g\\
\text{(because all entries of }T\text{ are }1\text{'s and }2\text{'s, but
}g\notin\left\{  1,2\right\}  \text{))}%
\end{array}
\right)  . \label{pf.lem.BK.res.irconts.pf.T3}%
\end{align}
Applying this to $T=P$ yields $\left(  \operatorname*{ircont}\left(  P\right)
\right)  _{g}=0$. But applying (\ref{pf.lem.BK.res.irconts.pf.T3}) to
$T=\operatorname*{res}\nolimits_{k}P$ yields $\left(  \operatorname*{ircont}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)  _{g}=0=\left(
\operatorname*{ircont}\left(  P\right)  \right)  _{g}$. Thus, $\left(
\operatorname*{ircont}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  _{g}=\left(  \operatorname*{ircont}\left(  P\right)  \right)  _{g}$
is proven in Case 3.

Hence, $\left(  \operatorname*{ircont}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  _{g}=\left(  \operatorname*{ircont}\left(
P\right)  \right)  _{g}$ is proven in each of the three Cases 1, 2 and 3.
Since these three Cases cover all possibilities, this shows that $\left(
\operatorname*{ircont}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  _{g}=\left(  \operatorname*{ircont}\left(  P\right)  \right)  _{g}$
always holds. This completes the proof of (\ref{pf.lem.BK.res.irconts}), and
thus the proof of Proposition \ref{prop.conflict-resolution-props}
\textbf{(d)} is finished.

\textbf{(e)} Let $r\in\mathbb{N}_{+}$ and $i\in\mathbb{N}_{+}$ be such that
$\left(  r,i\right)  \in Z$ and $\left(  r,s_{k}\left(  i\right)  \right)  \in
Z$. We need to prove (\ref{pf.lem.BK.res.Pli}). If $i\notin\left\{
k,k+1\right\}  $, then $s_{k}\left(  i\right)  =i$ and thus $\left(
\operatorname*{res}\nolimits_{k}P\right)  \left(  r,\underbrace{s_{k}\left(
i\right)  }_{=i}\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,i\right)  =P\left(  r,i\right)  $ (since $\operatorname*{res}%
\nolimits_{k}P$ only differs from $P$ in columns $k$ and $k+1$, but
$i\notin\left\{  k,k+1\right\}  $). Hence, if $i\notin\left\{  k,k+1\right\}
$, then (\ref{pf.lem.BK.res.Pli}) is proven. We thus WLOG assume that
$i\in\left\{  k,k+1\right\}  $. That is, $i=k$ or $i=k+1$. We assume that
$i=k$ (since the case $i=k+1$ is analogous).

We need to prove (\ref{pf.lem.BK.res.Pli}). In other words, we need to prove
that $P\left(  r,i\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,s_{k}\left(  i\right)  \right)  $. In other words, we need to prove
that $P\left(  r,k\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,s_{k}\left(  k\right)  \right)  $ (since $i=k$). In other words, we
need to prove that $P\left(  r,k\right)  =\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \left(  r,k+1\right)  $ (since $s_{k}\left(  k\right)
=k+1$).

We recall that the 12-table $P$ either has $k$-type M1, or has $k$-type 2M, or
has $k$-type 21. In other words, we must be in one of the following three cases:

\textit{Case 1:} The 12-table $P$ has $k$-type M1.

\textit{Case 2:} The 12-table $P$ has $k$-type 2M.

\textit{Case 3:} The 12-table $P$ has $k$-type 21.

Let us first assume that we are in Case 1. Then, the 12-table $P$ has $k$-type
M1. In other words, the $k$-th column of $P$ is mixed, and the $\left(
k+1\right)  $-th column of $P$ is 1-pure. The definition of
$\operatorname*{res}\nolimits_{k}P$ then shows that the $k$-th column of
$\operatorname*{res}_{k}P$ is 1-pure, whereas the $\left(  k+1\right)  $-th
column of $\operatorname*{res}\nolimits_{k}P$ is mixed and satisfies
$\operatorname*{sep}\nolimits_{k+1}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  =\operatorname*{sep}\nolimits_{k}P$.

The $k$-th column of $P$ is mixed. Thus, (\ref{pf.lem.BK.Tsep}) (applied to
$P$ instead of $T$) yields%
\[
P\left(  r,k\right)  =\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }r<\operatorname*{sep}\nolimits_{k}P;\\
2,\ \ \ \ \ \ \ \ \ \ \text{if }r\geq\operatorname*{sep}\nolimits_{k}P
\end{array}
\right.  .
\]
On the other hand, the $\left(  k+1\right)  $-th column of
$\operatorname*{res}\nolimits_{k}P$ is mixed. Thus, (\ref{pf.lem.BK.Tsep})
(applied to $\operatorname*{res}\nolimits_{k}P$ and $k+1$ instead of $T$ and
$k$) yields%
\begin{align*}
\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,k+1\right)   &
=\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }r<\operatorname*{sep}\nolimits_{k+1}\left(
\operatorname*{res}\nolimits_{k}P\right)  ;\\
2,\ \ \ \ \ \ \ \ \ \ \text{if }r\geq\operatorname*{sep}\nolimits_{k+1}\left(
\operatorname*{res}\nolimits_{k}P\right)
\end{array}
\right. \\
&  =\left\{
\begin{array}
[c]{c}%
1,\ \ \ \ \ \ \ \ \ \ \text{if }r<\operatorname*{sep}\nolimits_{k}P;\\
2,\ \ \ \ \ \ \ \ \ \ \text{if }r\geq\operatorname*{sep}\nolimits_{k}P
\end{array}
\right.  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }\operatorname*{sep}%
\nolimits_{k+1}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{sep}\nolimits_{k}P\right) \\
&  =P\left(  r,k\right)  .
\end{align*}
Thus, $P\left(  r,k\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,k+1\right)  $ is proven in Case 1.

Let us now assume that we are in Case 2. Then, the 12-table $P$ has $k$-type
2M. In other words, the $k$-th column of $P$ is 2-pure, and the $\left(
k+1\right)  $-th column of $P$ is mixed. The definition of
$\operatorname*{res}\nolimits_{k}P$ then shows that the $k$-th column of
$\operatorname*{res}_{k}P$ is mixed and satisfies $\operatorname*{sep}%
\nolimits_{k}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{sep}\nolimits_{k+1}P$, whereas the $\left(  k+1\right)  $-th
column of $\operatorname*{res}\nolimits_{k}P$ is 2-pure.

We have $P\left(  r,k\right)  =2$ (since the $k$-th column of $P$ is 2-pure)
and $\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,k+1\right)
=2$ (since the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ is 2-pure). Thus, $P\left(  r,k\right)  =2=\left(
\operatorname*{res}\nolimits_{k}P\right)  \left(  r,k+1\right)  $. Thus,
$P\left(  r,k\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,k+1\right)  $ is proven in Case 2.

Let us finally assume that we are in Case 3. Then, the 12-table $P$ has
$k$-type 21. In other words, the $k$-th column of $P$ is 2-pure, and the
$\left(  k+1\right)  $-th column of $P$ is 1-pure. The definition of
$\operatorname*{res}\nolimits_{k}P$ then shows that the $k$-th column of
$\operatorname*{res}_{k}P$ is mixed and satisfies $\operatorname*{sep}%
\nolimits_{k}\left(  \operatorname*{res}\nolimits_{k}P\right)
=\operatorname*{sep}\nolimits_{k+1}P$, whereas the $\left(  k+1\right)  $-th
column of $\operatorname*{res}\nolimits_{k}P$ is 2-pure.

We have $P\left(  r,k\right)  =2$ (since the $k$-th column of $P$ is 2-pure)
and $\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,k+1\right)
=2$ (since the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ is 2-pure). Thus, $P\left(  r,k\right)  =2=\left(
\operatorname*{res}\nolimits_{k}P\right)  \left(  r,k+1\right)  $. Thus,
$P\left(  r,k\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,k+1\right)  $ is proven in Case 3.

We have now proven $P\left(  r,k\right)  =\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \left(  r,k+1\right)  $ in each of the three Cases 1, 2
and 3. Since these three Cases cover all possibilities, this yields that
$P\left(  r,k\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)
\left(  r,k+1\right)  $ always holds. As we have explained, this completes the
proof of (\ref{pf.lem.BK.res.Pli}). Thus, Proposition
\ref{prop.conflict-resolution-props} \textbf{(e)} is proven.

\textbf{(f)} Let $\left(  i,j\right)  $ be a conflict of $P$ such that
$\left(  i,j\right)  \neq\left(  k,k+1\right)  $. Then, there exists an
$r\in\mathbb{N}_{+}$ satisfying $\left(  r,i\right)  \in Z$, $\left(
r,j\right)  \in Z$, $P\left(  r,i\right)  =2$ and $P\left(  r,j\right)  =1$
(since $\left(  i,j\right)  $ is a conflict of $P$). Consider this $r$.
Clearly, $i<j$ (since $\left(  i,j\right)  $ is a conflict). Since $i$ and $j$
are integers, this yields $i\leq j-1$ and thus $i+1\leq j$.

We shall now show that $\left(  r,s_{k}\left(  i\right)  \right)  \in Z$.
Indeed, assume the contrary. Then, $\left(  r,s_{k}\left(  i\right)  \right)
\notin Z$. Notice that $s_{k}\left(  i\right)  \leq i+1$ (since every
$u\in\mathbb{N}_{+}$ yields $s_{k}\left(  u\right)  \leq u+1$). Therefore,
$s_{k}\left(  i\right)  \leq i+1\leq j$. If $i\leq s_{k}\left(  i\right)  $,
then we thus have $\left(  r,s_{k}\left(  i\right)  \right)  \in Z$ (by
(\ref{eq.convex}), applied to $r$, $r$, $r$, $i$, $s_{k}\left(  i\right)  $
and $j$ instead of $i$, $i^{\prime}$, $i^{\prime\prime}$, $j$, $j^{\prime}$
and $j^{\prime\prime}$ (since $Z$ is convex and since $\left(  r,i\right)  \in
Z$ and $\left(  r,j\right)  \in Z$)), which contradicts $\left(
r,s_{k}\left(  i\right)  \right)  \notin Z$. Hence, we cannot have $i\leq
s_{k}\left(  i\right)  $. Thus, $i>s_{k}\left(  i\right)  $, so that $i=k+1$
(since the only $u\in\mathbb{N}_{+}$ satisfying $u>s_{k}\left(  u\right)  $ is
$k+1$). Thus, $s_{k}\left(  i\right)  =s_{k}\left(  k+1\right)  =k$, so that
$\left(  r,k\right)  \notin Z$ (since $\left(  r,s_{k}\left(  i\right)
\right)  \notin Z$).

But recall that $\left(  k,k+1\right)  $ is a conflict of $P$. Thus, there
exists a $q\in\mathbb{N}_{+}$ satisfying $\left(  q,k\right)  \in Z$, $\left(
q,k+1\right)  \in Z$, $P\left(  q,k\right)  =2$ and $P\left(  q,k+1\right)
=1$. Consider this $q$. If $r\leq q$, then
\begin{align*}
1  &  =P\left(  q,k+1\right)  \geq P\left(  r,\underbrace{k+1}_{=i}\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since }r\leq q\text{, and since the entries of }P\text{ are}\\
\text{weakly increasing down columns}%
\end{array}
\right) \\
&  =P\left(  r,i\right)  =2,
\end{align*}
which is absurd. Hence, we cannot have $r\leq q$. Thus, we have $r>q$, so that
$q<r$. Now, $Z$ is convex and we have $\left(  q,k\right)  \in Z$ and $\left(
r,\underbrace{k+1}_{=i}\right)  =\left(  r,i\right)  \in Z$. Hence,
(\ref{eq.convex}) (applied to $q$, $r$, $r$, $k$, $k$ and $k+1$ instead of
$i$, $i^{\prime}$, $i^{\prime\prime}$, $j$, $j^{\prime}$ and $j^{\prime\prime
}$) yields $\left(  r,k\right)  \in Z$, which contradicts $\left(  r,k\right)
\notin Z$. This contradicts our assumption. Thus, $\left(  r,s_{k}\left(
i\right)  \right)  \in Z$ is proven.

Next, we shall show that $\left(  r,s_{k}\left(  j\right)  \right)  \in Z$.
Indeed, assume the contrary. Then, $\left(  r,s_{k}\left(  j\right)  \right)
\notin Z$. Notice that $s_{k}\left(  j\right)  \geq j-1$ (since every
$u\in\mathbb{N}_{+}$ satisfies $s_{k}\left(  u\right)  \geq u-1$). Thus,
$j-1\leq s_{k}\left(  j\right)  $, so that $i\leq j-1\leq s_{k}\left(
j\right)  $. If $s_{k}\left(  j\right)  \leq j$, then we thus have $\left(
r,s_{k}\left(  j\right)  \right)  \in Z$ (by (\ref{eq.convex}), applied to
$r$, $r$, $r$, $i$, $s_{k}\left(  j\right)  $ and $j$ instead of $i$,
$i^{\prime}$, $i^{\prime\prime}$, $j$, $j^{\prime}$ and $j^{\prime\prime}$
(since $Z$ is convex and since $\left(  r,i\right)  \in Z$ and $\left(
r,j\right)  \in Z$)), which contradicts $\left(  r,s_{k}\left(  j\right)
\right)  \notin Z$. Hence, we cannot have $s_{k}\left(  j\right)  \leq j$.
Thus, $s_{k}\left(  j\right)  >j$, so that $j=k$ (since the only
$u\in\mathbb{N}_{+}$ satisfying $s_{k}\left(  u\right)  >u$ is $k$). Thus,
$s_{k}\left(  j\right)  =s_{k}\left(  k\right)  =k+1$, so that $\left(
r,k+1\right)  \notin Z$ (since $\left(  r,s_{k}\left(  j\right)  \right)
\notin Z$).

But recall that $\left(  k,k+1\right)  $ is a conflict of $P$. Thus, there
exists a $q\in\mathbb{N}_{+}$ satisfying $\left(  q,k\right)  \in Z$, $\left(
q,k+1\right)  \in Z$, $P\left(  q,k\right)  =2$ and $P\left(  q,k+1\right)
=1$. Consider this $q$. If $q\leq r$, then
\begin{align*}
2  &  =P\left(  q,k\right)  \leq P\left(  r,\underbrace{k}_{=j}\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since }q\leq r\text{, and since the entries of }P\text{ are}\\
\text{weakly increasing down columns}%
\end{array}
\right) \\
&  =P\left(  r,j\right)  =1
\end{align*}
which is absurd. Hence, we cannot have $q\leq r$. Thus, we have $q>r$. Thus,
$r<q$. Now, $Z$ is convex and we have $\left(  r,\underbrace{k}_{=j}\right)
=\left(  r,j\right)  \in Z$ and $\left(  q,k+1\right)  \in Z$. Hence,
(\ref{eq.convex}) (applied to $r$, $r$, $q$, $k$, $k+1$ and $k+1$ instead of
$i$, $i^{\prime}$, $i^{\prime\prime}$, $j$, $j^{\prime}$ and $j^{\prime\prime
}$) yields $\left(  r,k+1\right)  \in Z$, which contradicts $\left(
r,k+1\right)  \notin Z$. This contradicts our assumption. Thus, $\left(
r,s_{k}\left(  j\right)  \right)  \in Z$ is proven.

From (\ref{pf.lem.BK.res.Pli}), we obtain $P\left(  r,i\right)  =\left(
\operatorname*{res}\nolimits_{k}P\right)  \left(  r,s_{k}\left(  i\right)
\right)  $ (since $\left(  r,i\right)  \in Z$ and $\left(  r,s_{k}\left(
i\right)  \right)  \in Z$), so that $\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \left(  r,s_{k}\left(  i\right)  \right)  =P\left(
r,i\right)  =2$. From (\ref{pf.lem.BK.res.Pli}) (applied to $j$ instead of
$i$), we obtain $P\left(  r,j\right)  =\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \left(  r,s_{k}\left(  j\right)  \right)  $ (since
$\left(  r,j\right)  \in Z$ and $\left(  r,s_{k}\left(  j\right)  \right)  \in
Z$), so that $\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(
r,s_{k}\left(  j\right)  \right)  =P\left(  r,j\right)  =1$. Finally, from
$i<j$ and $\left(  i,j\right)  \neq\left(  k,k+1\right)  $, we obtain
$s_{k}\left(  i\right)  <s_{k}\left(  j\right)  $ (due to
(\ref{pf.prop.conflict-resolution.props.inversion-transform})). Altogether, we
thus know that $s_{k}\left(  i\right)  <s_{k}\left(  j\right)  $, $\left(
r,s_{k}\left(  i\right)  \right)  \in Z$, $\left(  r,s_{k}\left(  j\right)
\right)  \in Z$, $\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(
r,s_{k}\left(  i\right)  \right)  =2$ and $\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \left(  r,s_{k}\left(  j\right)  \right)  =1$. Thus,
$\left(  s_{k}\left(  i\right)  ,s_{k}\left(  j\right)  \right)  $ is a
conflict of $\operatorname*{res}\nolimits_{k}P$ (due to the definition of a
\textquotedblleft conflict\textquotedblright). This proves Proposition
\ref{prop.conflict-resolution-props} \textbf{(f)}.

\textbf{(g)} We need to prove (\ref{pf.lem.BK.res.flip}). We recall that the
12-table $P$ either has $k$-type M1, or has $k$-type 2M, or has $k$-type 21.
In other words, we must be in one of the following three cases:

\textit{Case 1:} The 12-table $P$ has $k$-type M1.

\textit{Case 2:} The 12-table $P$ has $k$-type 2M.

\textit{Case 3:} The 12-table $P$ has $k$-type 21.

Let us first assume that we are in Case 1. Then, the 12-table $P$ has $k$-type
M1. In other words, the $k$-th column of $P$ is mixed, and the $\left(
k+1\right)  $-th column of $P$ is 1-pure. By the definition of
$\operatorname*{flip}\left(  P\right)  $, we see that:

\begin{itemize}
\item the $k$-th column of $\operatorname*{flip}\left(  P\right)  $ is the
$k$-th column of $P$ (since the $k$-th column of $P$ is mixed, and the map
$\operatorname*{flip}$ leaves mixed columns unchanged);

\item the $\left(  k+1\right)  $-th column of $\operatorname*{flip}\left(
P\right)  $ is 2-pure (since the $\left(  k+1\right)  $-th column of $P$ is
1-pure, and since the map $\operatorname*{flip}$ changes 1-pure columns by
replacing all their entries by $2$'s).
\end{itemize}

On the other hand, recall the definition of $\operatorname*{res}%
\nolimits_{k}P$. This definition (combined with the fact that $P$ has $k$-type
M1) shows that the $k$-th column of $\operatorname*{res}_{k}P$ is 1-pure,
whereas the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ is mixed and satisfies $\operatorname*{sep}\nolimits_{k+1}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{sep}%
\nolimits_{k}P$. In particular, the 12-table $\operatorname*{res}%
\nolimits_{k}P$ differs from $P$ only in its columns $k$ and $k+1$. By the
definition of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $, we now see that:

\begin{itemize}
\item the $k$-th column of $\operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  $ is 2-pure (since the $k$-th column of
$\operatorname*{res}\nolimits_{k}P$ is 1-pure, and since the map
$\operatorname*{flip}$ changes 1-pure columns by replacing all their entries
by $2$'s);

\item the $\left(  k+1\right)  $-th column of $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $ is the $\left(  k+1\right)  $-th
column of $\operatorname*{res}\nolimits_{k}P$ (since the $\left(  k+1\right)
$-th column of $\operatorname*{res}\nolimits_{k}P$ is mixed, and the map
$\operatorname*{flip}$ leaves mixed columns unchanged).
\end{itemize}

We shall now prove that $\left(  k,k+1\right)  $ is a conflict of
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $.

Recall that $\left(  k,k+1\right)  $ is a conflict of $P$. In other words,
there exists an $r\in\mathbb{N}_{+}$ satisfying $\left(  r,k\right)  \in Z$,
$\left(  r,k+1\right)  \in Z$, $P\left(  r,k\right)  =2$ and $P\left(
r,k+1\right)  =1$. Let us denote this $r$ by $q$. Then, $q$ is an element of
$\mathbb{N}_{+}$ satisfying $\left(  q,k\right)  \in Z$, $\left(
q,k+1\right)  \in Z$, $P\left(  q,k\right)  =2$ and $P\left(  q,k+1\right)
=1$.

Now, the $k$-th column of $P$ is mixed, and therefore contains a $1$. In other
words, there exists an $r\in\mathbb{N}_{+}$ such that $\left(  r,k\right)  \in
Z$ and $P\left(  r,k\right)  =1$. Consider this $r$.

Let us show that $r<q$. In fact, assume the contrary. Then, $r\geq q$, so that
$q\leq r$. Hence, $P\left(  q,k\right)  \leq P\left(  r,k\right)  $ (since the
entries of $P$ are weakly increasing down columns), so that $2=P\left(
q,k\right)  \leq P\left(  r,k\right)  =1$. This contradicts $2>1$. Hence, our
assumption was wrong. Thus, $r<q$ is proven. Now, $Z$ is convex, and we have
$\left(  r,k\right)  \in Z$ and $\left(  q,k+1\right)  \in Z$. Hence, $\left(
r,k+1\right)  \in Z$ (by (\ref{eq.convex}), applied to $r$, $r$, $q$, $k$,
$k+1$ and $k+1$ instead of $i$, $i^{\prime}$, $i^{\prime\prime}$, $j$,
$j^{\prime}$ and $j^{\prime\prime}$). In other words, $\left(  r,s_{k}\left(
k\right)  \right)  \in Z$ (since $k+1=s_{k}\left(  k\right)  $).

We have $\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  \left(  r,k\right)  =2$ (since the $k$-th
column of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ is 2-pure). Furthermore,
\begin{align*}
&  \left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  \right)  \left(  r,k+1\right) \\
&  =\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,k+1\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since the }\left(  k+1\right)  \text{-th
column of }\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  \text{ is the }\left(  k+1\right)  \text{-th column of
}\operatorname*{res}\nolimits_{k}P\right) \\
&  =\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,s_{k}\left(
k\right)  \right)  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }k+1=s_{k}\left(
k\right)  \right) \\
&  =P\left(  r,k\right)  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }P\left(
r,k\right)  =\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(
r,s_{k}\left(  k\right)  \right)  \text{ (by (\ref{pf.lem.BK.res.Pli}),
applied to }i=k\text{)}\right) \\
&  =1.
\end{align*}


So we know that $\left(  r,k\right)  \in Z$, $\left(  r,k+1\right)  \in Z$,
$\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \left(  r,k\right)  =2$ and $\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \left(  r,k+1\right)  =1$.
Hence, $\left(  k,k+1\right)  $ is a conflict of $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $. Thus, $\operatorname*{res}%
\nolimits_{k}\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  $ is well-defined.

Next, we need to show that $\operatorname*{flip}\left(  P\right)
=\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $. Recall that the $k$-th
column of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ is 2-pure, whereas the $\left(  k+1\right)  $-th column of
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $ is
mixed (because it is the $\left(  k+1\right)  $-th column of
$\operatorname*{res}\nolimits_{k}P$, and the latter is mixed). Thus, the
12-table $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ has $k$-type 2M. Therefore, the definition of $\operatorname*{res}%
\nolimits_{k}\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  $ shows that $\operatorname*{res}%
\nolimits_{k}\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  $ is the 12-table which differs from
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $ in
that the $k$-th column of $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$ is mixed and satisfies $\operatorname*{sep}\nolimits_{k}\left(
\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \right)
=\operatorname*{sep}\nolimits_{k+1}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $, whereas the $\left(
k+1\right)  $-th column of $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$ is 2-pure (i.e., it is filled with $2$'s). In particular, the 12-table
$\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $ differs from
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $ only
in its columns $k$ and $k+1$.

Now, we want to show that $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
=\operatorname*{flip}\left(  P\right)  $. In order to do so, it is clearly
enough to prove that%
\begin{equation}
\left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right)  =\left(  \text{the }i\text{-th column of }%
\operatorname*{flip}\left(  P\right)  \right)
\label{pf.lem.BK.res.flip.pf.c2.icol}%
\end{equation}
for every $i\in\mathbb{N}_{+}$.

\textit{Proof of (\ref{pf.lem.BK.res.flip.pf.c2.icol}):} Fix $i\in
\mathbb{N}_{+}$.

First, the $k$-th column of $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$ is mixed; so is the $k$-th column of $\operatorname*{flip}\left(  P\right)
$ (since this column is the $k$-th column of $P$, and the latter is mixed).
These two columns furthermore satisfy%
\begin{align*}
&  \operatorname*{sep}\nolimits_{k}\left(  \operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right) \\
&  =\operatorname*{sep}\nolimits_{k+1}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\operatorname*{sep}%
\nolimits_{k+1}\left(  \operatorname*{res}\nolimits_{k}P\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since the }\left(  k+1\right)  \text{-th column of }\operatorname*{flip}%
\left(  \operatorname*{res}\nolimits_{k}P\right) \\
\text{is the }\left(  k+1\right)  \text{-th column of }\operatorname*{res}%
\nolimits_{k}P
\end{array}
\right) \\
&  =\operatorname*{sep}\nolimits_{k}P=\operatorname*{sep}\nolimits_{k}\left(
\operatorname*{flip}\left(  P\right)  \right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since }\operatorname*{sep}\nolimits_{k}\left(  \operatorname*{flip}%
\left(  P\right)  \right)  =\operatorname*{sep}\nolimits_{k}P\text{
(because}\\
\text{the }k\text{-th column of }\operatorname*{flip}\left(  P\right)  \text{
is the }k\text{-th column of }P\text{)}%
\end{array}
\right)  .
\end{align*}
That is, the point at which the $1$'s end at the $2$'s begin is the same in
these two columns. Hence,%
\[
\left(  \text{the }k\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right)  =\left(  \text{the }k\text{-th column of }%
\operatorname*{flip}\left(  P\right)  \right)  .
\]
In other words, (\ref{pf.lem.BK.res.flip.pf.c2.icol}) is proven for $i=k$.
Hence, we can now WLOG assume that $i\neq k$. Assume this.

The $\left(  k+1\right)  $-th column of $\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  $ is 2-pure; so is the $\left(  k+1\right)  $-th column of
$\operatorname*{flip}\left(  P\right)  $. Hence, these two columns are equal.
In other words,%
\[
\left(  \text{the }\left(  k+1\right)  \text{-th column of }%
\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \right)  =\left(  \text{the
}\left(  k+1\right)  \text{-th column of }\operatorname*{flip}\left(
P\right)  \right)  .
\]
In other words, (\ref{pf.lem.BK.res.flip.pf.c2.icol}) is proven for $i=k+1$.
Hence, we can now WLOG assume that $i\neq k+1$. Assume this.

We have $i\neq k$ and $i\neq k+1$. Thus, $i\notin\left\{  k,k+1\right\}  $.
Hence,%
\[
\left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
P\right)  =\left(  \text{the }i\text{-th column of }P\right)
\]
(because the 12-table $\operatorname*{res}\nolimits_{k}P$ differs from $P$
only in its columns $k$ and $k+1$). Therefore,%
\[
\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\left(  \text{the
}i\text{-th column of }\operatorname*{flip}\left(  P\right)  \right)
\]
(by Remark \ref{rmk.flip.independent}, applied to $\operatorname*{res}%
\nolimits_{k}P$ and $P$ instead of $P$ and $Q$). Now,%
\begin{align*}
&  \left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right) \\
&  =\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since the 12-table }\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
\text{ differs from}\\
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \text{
only in its columns }k\text{ and }k+1
\end{array}
\right) \\
&  =\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
P\right)  \right)  .
\end{align*}
Thus, (\ref{pf.lem.BK.res.flip.pf.c2.icol}) holds.

We now have proven (\ref{pf.lem.BK.res.flip.pf.c2.icol}). As a consequence, we
obtain $\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\operatorname*{flip}%
\left(  P\right)  $. In other words, $\operatorname*{flip}\left(  P\right)
=\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $. Hence, we have proven
(\ref{pf.lem.BK.res.flip}) in Case 1.

Let us next assume that we are in Case 2. Then, the 12-table $P$ has $k$-type
2M. In other words, the $k$-th column of $P$ is 2-pure, and the $\left(
k+1\right)  $-th column of $P$ is mixed. By the definition of
$\operatorname*{flip}\left(  P\right)  $, we see that:

\begin{itemize}
\item the $k$-th column of $\operatorname*{flip}\left(  P\right)  $ is 1-pure
(since the $k$-th column of $P$ is 2-pure, and since the map
$\operatorname*{flip}$ changes 2-pure columns by replacing all their entries
by $1$'s).

\item the $\left(  k+1\right)  $-th column of $\operatorname*{flip}\left(
P\right)  $ is the $\left(  k+1\right)  $-th column of $P$ (since the $\left(
k+1\right)  $-th column of $P$ is mixed, and the map $\operatorname*{flip}$
leaves mixed columns unchanged);
\end{itemize}

On the other hand, recall the definition of $\operatorname*{res}%
\nolimits_{k}P$. This definition (combined with the fact that $P$ has $k$-type
2M) shows that the $k$-th column of $\operatorname*{res}_{k}P$ is mixed and
satisfies $\operatorname*{sep}\nolimits_{k}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  =\operatorname*{sep}\nolimits_{k+1}P$, whereas the
$\left(  k+1\right)  $-th column of $\operatorname*{res}\nolimits_{k}P$ is
2-pure. In particular, the 12-table $\operatorname*{res}\nolimits_{k}P$
differs from $P$ only in its columns $k$ and $k+1$. By the definition of
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $, we
now see that:

\begin{itemize}
\item the $k$-th column of $\operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  $ is the $k$-th column of $\operatorname*{res}%
\nolimits_{k}P$ (since the $k$-th column of $\operatorname*{res}%
\nolimits_{k}P$ is mixed, and the map $\operatorname*{flip}$ leaves mixed
columns unchanged);

\item the $\left(  k+1\right)  $-th column of $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $ is 1-pure (since the $\left(
k+1\right)  $-th column of $\operatorname*{res}\nolimits_{k}P$ is 2-pure, and
since the map $\operatorname*{flip}$ changes 2-pure columns by replacing all
their entries by $1$'s).
\end{itemize}

We shall now prove that $\left(  k,k+1\right)  $ is a conflict of
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $.

Recall that $\left(  k,k+1\right)  $ is a conflict of $P$. In other words,
there exists an $r\in\mathbb{N}_{+}$ satisfying $\left(  r,k\right)  \in Z$,
$\left(  r,k+1\right)  \in Z$, $P\left(  r,k\right)  =2$ and $P\left(
r,k+1\right)  =1$. Let us denote this $r$ by $q$. Then, $q$ is an element of
$\mathbb{N}_{+}$ satisfying $\left(  q,k\right)  \in Z$, $\left(
q,k+1\right)  \in Z$, $P\left(  q,k\right)  =2$ and $P\left(  q,k+1\right)
=1$.

Now, the $\left(  k+1\right)  $-th column of $P$ is mixed, and therefore
contains a $2$. In other words, there exists an $r\in\mathbb{N}_{+}$ such that
$\left(  r,k+1\right)  \in Z$ and $P\left(  r,k+1\right)  =2$. Consider this
$r$.

Let us show that $r>q$. In fact, assume the contrary. Then, $r\leq q$, so that
$P\left(  r,k+1\right)  \leq P\left(  q,k+1\right)  $ (since the entries of
$P$ are weakly increasing down columns), so that $2=P\left(  r,k+1\right)
\leq P\left(  q,k+1\right)  =1$. This contradicts $2>1$. Hence, our assumption
was wrong. Thus, $r>q$ is proven. Hence, $q<r$. Now, $Z$ is convex, and we
have $\left(  q,k\right)  \in Z$ and $\left(  r,k+1\right)  \in Z$. Hence,
$\left(  r,k\right)  \in Z$ (by (\ref{eq.convex}), applied to $q$, $r$, $r$,
$k$, $k$ and $k+1$ instead of $i$, $i^{\prime}$, $i^{\prime\prime}$, $j$,
$j^{\prime}$ and $j^{\prime\prime}$). In other words, $\left(  r,s_{k}\left(
k+1\right)  \right)  \in Z$ (since $k=s_{k}\left(  k+1\right)  $).

We have $\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  \left(  r,k+1\right)  =1$ (since the $\left(
k+1\right)  $-th column of $\operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  $ is 1-pure). Furthermore, $P\left(  r,k+1\right)
=\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,s_{k}\left(
k+1\right)  \right)  $ (by (\ref{pf.lem.BK.res.Pli}), applied to $i=k+1$), so
that $\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,s_{k}\left(
k+1\right)  \right)  =P\left(  r,k+1\right)  =2$. Now,
\begin{align*}
&  \left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  \right)  \left(  r,k\right) \\
&  =\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,k\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{since the }k\text{-th column of
}\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \text{
is the }k\text{-th column of }\operatorname*{res}\nolimits_{k}P\right) \\
&  =\left(  \operatorname*{res}\nolimits_{k}P\right)  \left(  r,s_{k}\left(
k+1\right)  \right)  \ \ \ \ \ \ \ \ \ \ \left(  \text{since }k=s_{k}\left(
k+1\right)  \right) \\
&  =2.
\end{align*}


So we know that $\left(  r,k\right)  \in Z$, $\left(  r,k+1\right)  \in Z$,
$\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \left(  r,k\right)  =2$ and $\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \left(  r,k+1\right)  =1$.
Hence, $\left(  k,k+1\right)  $ is a conflict of $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $. Thus, $\operatorname*{res}%
\nolimits_{k}\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  $ is well-defined.

Next, we need to show that $\operatorname*{flip}\left(  P\right)
=\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $. Recall that the $k$-th
column of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ is mixed (because it is the $k$-th column of $\operatorname*{res}%
\nolimits_{k}P$, and the latter is mixed), while the $\left(  k+1\right)  $-th
column of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ is 1-pure. Thus, the 12-table $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $ has $k$-type M1. Therefore, the
definition of $\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)  $ shows that
$\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $ is the 12-table which
differs from $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ in that the $k$-th column of $\operatorname*{res}_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$ is 1-pure (i.e., it is filled with $1$'s), whereas the $\left(  k+1\right)
$-th column of $\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)  $ is mixed and
satisfies \newline$\operatorname*{sep}\nolimits_{k+1}\left(
\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \right)
=\operatorname*{sep}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $. In particular, the
12-table $\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $ differs from
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $ only
in its columns $k$ and $k+1$.

Now, we want to show that $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
=\operatorname*{flip}\left(  P\right)  $. In order to do so, it is clearly
enough to prove that%
\begin{equation}
\left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right)  =\left(  \text{the }i\text{-th column of }%
\operatorname*{flip}\left(  P\right)  \right)
\label{pf.lem.BK.res.flip.pf.c3.icol}%
\end{equation}
for every $i\in\mathbb{N}_{+}$.

\textit{Proof of (\ref{pf.lem.BK.res.flip.pf.c3.icol}):} Fix $i\in
\mathbb{N}_{+}$.

First, the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  $ is mixed; so is the $\left(  k+1\right)
$-th column of $\operatorname*{flip}\left(  P\right)  $ (since this column is
the $k$-th column of $P$, and the latter is mixed). These two columns
furthermore satisfy%
\begin{align*}
&  \operatorname*{sep}\nolimits_{k+1}\left(  \operatorname*{res}%
\nolimits_{k}\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  \right) \\
&  =\operatorname*{sep}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\operatorname*{sep}%
\nolimits_{k}\left(  \operatorname*{res}\nolimits_{k}P\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since the }k\text{-th column of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right) \\
\text{is the }k\text{-th column of }\operatorname*{res}\nolimits_{k}P
\end{array}
\right) \\
&  =\operatorname*{sep}\nolimits_{k+1}P=\operatorname*{sep}\nolimits_{k+1}%
\left(  \operatorname*{flip}\left(  P\right)  \right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since }\operatorname*{sep}\nolimits_{k+1}\left(  \operatorname*{flip}%
\left(  P\right)  \right)  =\operatorname*{sep}\nolimits_{k+1}P\text{
(because}\\
\text{the }\left(  k+1\right)  \text{-th column of }\operatorname*{flip}%
\left(  P\right)  \text{ is the }\left(  k+1\right)  \text{-th column of
}P\text{)}%
\end{array}
\right)  .
\end{align*}
That is, the point at which the $1$'s end at the $2$'s begin is the same in
these two columns. Hence,%
\[
\left(  \text{the }\left(  k+1\right)  \text{-th column of }%
\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \right)  =\left(  \text{the
}\left(  k+1\right)  \text{-th column of }\operatorname*{flip}\left(
P\right)  \right)  .
\]
In other words, (\ref{pf.lem.BK.res.flip.pf.c3.icol}) is proven for $i=k+1$.
Hence, we can now WLOG assume that $i\neq k+1$. Assume this.

The $k$-th column of $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$ is 1-pure; so is the $k$-th column of $\operatorname*{flip}\left(  P\right)
$. Hence, these two columns are equal. In other words,%
\[
\left(  \text{the }k\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right)  =\left(  \text{the }k\text{-th column of }%
\operatorname*{flip}\left(  P\right)  \right)  .
\]
In other words, (\ref{pf.lem.BK.res.flip.pf.c3.icol}) is proven for $i=k$.
Hence, we can now WLOG assume that $i\neq k$. Assume this.

We have $i\neq k$ and $i\neq k+1$. Thus, $i\notin\left\{  k,k+1\right\}  $.
Hence,%
\[
\left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
P\right)  =\left(  \text{the }i\text{-th column of }P\right)
\]
(because the 12-table $\operatorname*{res}\nolimits_{k}P$ differs from $P$
only in its columns $k$ and $k+1$). Therefore,%
\[
\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\left(  \text{the
}i\text{-th column of }\operatorname*{flip}\left(  P\right)  \right)
\]
(by Remark \ref{rmk.flip.independent}, applied to $\operatorname*{res}%
\nolimits_{k}P$ and $P$ instead of $P$ and $Q$). Now,%
\begin{align*}
&  \left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right) \\
&  =\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since the 12-table }\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
\text{ differs from}\\
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \text{
only in its columns }k\text{ and }k+1
\end{array}
\right) \\
&  =\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
P\right)  \right)  .
\end{align*}
Thus, (\ref{pf.lem.BK.res.flip.pf.c3.icol}) holds.

We now have proven (\ref{pf.lem.BK.res.flip.pf.c3.icol}). As a consequence, we
obtain $\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\operatorname*{flip}%
\left(  P\right)  $. In other words, $\operatorname*{flip}\left(  P\right)
=\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $. Hence, we have proven
(\ref{pf.lem.BK.res.flip}) in Case 2.

Let us finally assume that we are in Case 3. Then, the 12-table $P$ has
$k$-type 21. In other words, the $k$-th column of $P$ is 2-pure, and the
$\left(  k+1\right)  $-th column of $P$ is 1-pure. By the definition of
$\operatorname*{flip}\left(  P\right)  $, we see that:

\begin{itemize}
\item the $k$-th column of $\operatorname*{flip}\left(  P\right)  $ is 1-pure
(since the $k$-th column of $P$ is 2-pure, and since the map
$\operatorname*{flip}$ changes 2-pure columns by replacing all their entries
by $1$'s).

\item the $\left(  k+1\right)  $-th column of $\operatorname*{flip}\left(
P\right)  $ is 2-pure (since the $\left(  k+1\right)  $-th column of $P$ is
1-pure, and since the map $\operatorname*{flip}$ changes 1-pure columns by
replacing all their entries by $2$'s).
\end{itemize}

On the other hand, recall the definition of $\operatorname*{res}%
\nolimits_{k}P$. This definition (combined with the fact that $P$ has $k$-type
21) shows that the $k$-th column of $\operatorname*{res}_{k}P$ is 1-pure,
whereas the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ is 2-pure. In particular, the 12-table $\operatorname*{res}%
\nolimits_{k}P$ differs from $P$ only in its columns $k$ and $k+1$. By the
definition of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $, we now see that:

\begin{itemize}
\item the $k$-th column of $\operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  $ is 2-pure (since the $k$-th column of
$\operatorname*{res}\nolimits_{k}P$ is 1-pure, and since the map
$\operatorname*{flip}$ changes 2-pure columns by replacing all their entries
by $1$'s);

\item the $\left(  k+1\right)  $-th column of $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $ is 1-pure (since the $\left(
k+1\right)  $-th column of $\operatorname*{res}\nolimits_{k}P$ is 2-pure, and
since the map $\operatorname*{flip}$ changes 2-pure columns by replacing all
their entries by $1$'s).
\end{itemize}

We shall now prove that $\left(  k,k+1\right)  $ is a conflict of
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $.

Recall that $\left(  k,k+1\right)  $ is a conflict of $P$. In other words,
there exists an $r\in\mathbb{N}_{+}$ satisfying $\left(  r,k\right)  \in Z$,
$\left(  r,k+1\right)  \in Z$, $P\left(  r,k\right)  =2$ and $P\left(
r,k+1\right)  =1$. Let us denote this $r$ by $q$. Then, $q$ is an element of
$\mathbb{N}_{+}$ satisfying $\left(  q,k\right)  \in Z$, $\left(
q,k+1\right)  \in Z$, $P\left(  q,k\right)  =2$ and $P\left(  q,k+1\right)
=1$.

We have $\left(  \operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \right)  \left(  q,k\right)  =2$ (since the $k$-th
column of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ is 2-pure) and $\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \left(  q,k+1\right)  =1$
(since the $\left(  k+1\right)  $-th column of $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $ is 1-pure). So we know that
$\left(  q,k\right)  \in Z$, $\left(  q,k+1\right)  \in Z$, $\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
\left(  q,k\right)  =2$ and $\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \left(  q,k+1\right)  =1$.
Therefore, $\left(  k,k+1\right)  $ is a conflict of $\operatorname*{flip}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  $. Thus,
$\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $ is well-defined.

Next, we need to show that $\operatorname*{flip}\left(  P\right)
=\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $. Recall that the $k$-th
column of $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ is 2-pure, while the $\left(  k+1\right)  $-th column of
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $ is
1-pure. Thus, the 12-table $\operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  $ has $k$-type 21. Therefore, the definition of
$\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $ shows that
$\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $ is the 12-table which
differs from $\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}%
P\right)  $ in that the $k$-th column of $\operatorname*{res}_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$ is 1-pure, whereas the $\left(  k+1\right)  $-th column of
$\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $ is 2-pure. In particular,
the 12-table $\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)  $ differs from
$\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  $ only
in its columns $k$ and $k+1$.

Now, we want to show that $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
=\operatorname*{flip}\left(  P\right)  $. In order to do so, it is clearly
enough to prove that%
\begin{equation}
\left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right)  =\left(  \text{the }i\text{-th column of }%
\operatorname*{flip}\left(  P\right)  \right)
\label{pf.lem.BK.res.flip.pf.c4.icol}%
\end{equation}
for every $i\in\mathbb{N}_{+}$.

\textit{Proof of (\ref{pf.lem.BK.res.flip.pf.c4.icol}):} Fix $i\in
\mathbb{N}_{+}$.

The $k$-th column of $\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$ is 1-pure; so is the $k$-th column of $\operatorname*{flip}\left(  P\right)
$. Hence, these two columns are equal. In other words,%
\[
\left(  \text{the }k\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right)  =\left(  \text{the }k\text{-th column of }%
\operatorname*{flip}\left(  P\right)  \right)  .
\]
In other words, (\ref{pf.lem.BK.res.flip.pf.c4.icol}) is proven for $i=k$.
Hence, we can now WLOG assume that $i\neq k$. Assume this.

The $\left(  k+1\right)  $-th column of $\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  $ is 2-pure; so is the $\left(  k+1\right)  $-th column of
$\operatorname*{flip}\left(  P\right)  $. Hence, these two columns are equal.
In other words,%
\[
\left(  \text{the }\left(  k+1\right)  \text{-th column of }%
\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  \right)  =\left(  \text{the
}\left(  k+1\right)  \text{-th column of }\operatorname*{flip}\left(
P\right)  \right)  .
\]
In other words, (\ref{pf.lem.BK.res.flip.pf.c4.icol}) is proven for $i=k+1$.
Hence, we can now WLOG assume that $i\neq k+1$. Assume this.

We have $i\neq k$ and $i\neq k+1$. Thus, $i\notin\left\{  k,k+1\right\}  $.
Hence,%
\[
\left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
P\right)  =\left(  \text{the }i\text{-th column of }P\right)
\]
(because the 12-table $\operatorname*{res}\nolimits_{k}P$ differs from $P$
only in its columns $k$ and $k+1$). Therefore,%
\[
\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\left(  \text{the
}i\text{-th column of }\operatorname*{flip}\left(  P\right)  \right)
\]
(by Remark \ref{rmk.flip.independent}, applied to $\operatorname*{res}%
\nolimits_{k}P$ and $P$ instead of $P$ and $Q$). Now,%
\begin{align*}
&  \left(  \text{the }i\text{-th column of }\operatorname*{res}\nolimits_{k}%
\left(  \operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)
\right)  \right) \\
&  =\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since the 12-table }\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
\text{ differs from}\\
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \text{
only in its columns }k\text{ and }k+1
\end{array}
\right) \\
&  =\left(  \text{the }i\text{-th column of }\operatorname*{flip}\left(
P\right)  \right)  .
\end{align*}
Thus, (\ref{pf.lem.BK.res.flip.pf.c4.icol}) holds.

We now have proven (\ref{pf.lem.BK.res.flip.pf.c4.icol}). As a consequence, we
obtain $\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  =\operatorname*{flip}%
\left(  P\right)  $. In other words, $\operatorname*{flip}\left(  P\right)
=\operatorname*{res}\nolimits_{k}\left(  \operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  \right)  $. Hence, we have proven
(\ref{pf.lem.BK.res.flip}) in Case 3.

We now have proven (\ref{pf.lem.BK.res.flip}) in each of the three Cases 1, 2
and 3. Since these three Cases cover all possibilities, this shows that
(\ref{pf.lem.BK.res.flip}) always holds. Thus, Proposition
\ref{prop.conflict-resolution-props} \textbf{(g)} is proven.

\textbf{(h)} We need to prove $\ell\left(  P\right)  >\ell\left(
\operatorname*{res}\nolimits_{k}P\right)  $. In other words, we need to prove
$\ell\left(  P\right)  -\ell\left(  \operatorname*{res}\nolimits_{k}P\right)
>0$.

The definition of $\ell\left(  \operatorname*{res}\nolimits_{k}P\right)  $
yields%
\begin{align*}
\ell\left(  \operatorname*{res}\nolimits_{k}P\right)   &  =\sum_{h\in
\mathbb{N}_{+}}h\cdot\operatorname*{sig}\left(  \text{the }h\text{-th column
of }\operatorname*{res}\nolimits_{k}P\right) \\
&  =\sum_{h\in\mathbb{N}_{+}\setminus\left\{  k,k+1\right\}  }h\cdot
\operatorname*{sig}\underbrace{\left(  \text{the }h\text{-th column of
}\operatorname*{res}\nolimits_{k}P\right)  }_{\substack{=\left(  \text{the
}h\text{-th column of }P\right)  \\\text{(by (\ref{pf.lem.BK.res.loc}))}}}\\
&  \ \ \ \ \ \ \ \ \ \ +k\cdot\operatorname*{sig}\left(  \text{the }k\text{-th
column of }\operatorname*{res}\nolimits_{k}P\right) \\
&  \ \ \ \ \ \ \ \ \ \ +\left(  k+1\right)  \cdot\operatorname*{sig}\left(
\text{the }\left(  k+1\right)  \text{-th column of }\operatorname*{res}%
\nolimits_{k}P\right) \\
&  =\sum_{h\in\mathbb{N}_{+}\setminus\left\{  k,k+1\right\}  }h\cdot
\operatorname*{sig}\left(  \text{the }h\text{-th column of }P\right) \\
&  \ \ \ \ \ \ \ \ \ \ +k\cdot\operatorname*{sig}\left(  \text{the }k\text{-th
column of }\operatorname*{res}\nolimits_{k}P\right) \\
&  \ \ \ \ \ \ \ \ \ \ +\left(  k+1\right)  \cdot\operatorname*{sig}\left(
\text{the }\left(  k+1\right)  \text{-th column of }\operatorname*{res}%
\nolimits_{k}P\right)  .
\end{align*}
Subtracting this from the equality%
\begin{align*}
\ell\left(  P\right)   &  =\sum_{h\in\mathbb{N}_{+}}h\cdot\operatorname*{sig}%
\left(  \text{the }h\text{-th column of }P\right)  \ \ \ \ \ \ \ \ \ \ \left(
\text{by the definition of }\ell\left(  P\right)  \right) \\
&  =\sum_{h\in\mathbb{N}_{+}\setminus\left\{  k,k+1\right\}  }h\cdot
\operatorname*{sig}\left(  \text{the }h\text{-th column of }P\right) \\
&  \ \ \ \ \ \ \ \ \ \ +k\cdot\operatorname*{sig}\left(  \text{the }k\text{-th
column of }P\right) \\
&  \ \ \ \ \ \ \ \ \ \ +\left(  k+1\right)  \cdot\operatorname*{sig}\left(
\text{the }\left(  k+1\right)  \text{-th column of }P\right)  ,
\end{align*}
we obtain%
\begin{align}
&  \ell\left(  P\right)  -\ell\left(  \operatorname*{res}\nolimits_{k}P\right)
\nonumber\\
&  =\left(  \sum_{h\in\mathbb{N}_{+}\setminus\left\{  k,k+1\right\}  }%
h\cdot\operatorname*{sig}\left(  \text{the }h\text{-th column of }P\right)
\right. \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ \left.
%TCIMACRO{\TeXButton{phantom}{\phantom{\sum_{h}}}}%
%BeginExpansion
\phantom{\sum_{h}}%
%EndExpansion
+k\cdot\operatorname*{sig}\left(  \text{the }k\text{-th column of }P\right)
\right. \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ \left.
%TCIMACRO{\TeXButton{phantom}{\phantom{\sum_{h}}}}%
%BeginExpansion
\phantom{\sum_{h}}%
%EndExpansion
+\left(  k+1\right)  \cdot\operatorname*{sig}\left(  \text{the }\left(
k+1\right)  \text{-th column of }P\right)  \right) \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ -\left(  \sum_{h\in\mathbb{N}_{+}\setminus\left\{
k,k+1\right\}  }h\cdot\operatorname*{sig}\left(  \text{the }h\text{-th column
of }P\right)  \right. \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ \left.
%TCIMACRO{\TeXButton{phantom}{\phantom{\sum_{h}}}}%
%BeginExpansion
\phantom{\sum_{h}}%
%EndExpansion
+k\cdot\operatorname*{sig}\left(  \text{the }k\text{-th column of
}\operatorname*{res}\nolimits_{k}P\right)  \right. \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ \left.
%TCIMACRO{\TeXButton{phantom}{\phantom{\sum_{h}}}}%
%BeginExpansion
\phantom{\sum_{h}}%
%EndExpansion
+\left(  k+1\right)  \cdot\operatorname*{sig}\left(  \text{the }\left(
k+1\right)  \text{-th column of }\operatorname*{res}\nolimits_{k}P\right)
\right) \nonumber\\
&  =k\cdot\operatorname*{sig}\left(  \text{the }k\text{-th column of
}P\right)  +\left(  k+1\right)  \cdot\operatorname*{sig}\left(  \text{the
}\left(  k+1\right)  \text{-th column of }P\right) \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ -k\cdot\operatorname*{sig}\left(  \text{the }k\text{-th
column of }\operatorname*{res}\nolimits_{k}P\right) \nonumber\\
&  \ \ \ \ \ \ \ \ \ \ -\left(  k+1\right)  \cdot\operatorname*{sig}\left(
\text{the }\left(  k+1\right)  \text{-th column of }\operatorname*{res}%
\nolimits_{k}P\right)  . \label{pf.lem.BK.res.lendec.pf.3}%
\end{align}


Now, let us recall that the 12-table $P$ either has $k$-type M1, or has
$k$-type 2M, or has $k$-type 21. Let us WLOG assume that it has $k$-type M1
(as the other cases are similar and left to the reader). Thus, the $k$-th
column of $P$ is mixed, and the $\left(  k+1\right)  $-th column of $P$ is
1-pure. The construction of $\operatorname*{res}\nolimits_{k}P$ now shows that
$\operatorname*{res}_{k}P$ is the 12-table which differs from $P$ in that the
$k$-th column of $\operatorname*{res}_{k}P$ is 1-pure (i.e., it is filled with
$1$'s), whereas the $\left(  k+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{k}P$ is mixed and satisfies $\operatorname*{sep}\nolimits_{k+1}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{sep}%
\nolimits_{k}P$. Now, (\ref{pf.lem.BK.res.lendec.pf.3}) becomes%
\begin{align*}
&  \ell\left(  P\right)  -\ell\left(  \operatorname*{res}\nolimits_{k}P\right)
\\
&  =k\cdot\underbrace{\operatorname*{sig}\left(  \text{the }k\text{-th column
of }P\right)  }_{\substack{=1\\\text{(since the }k\text{-th column of }P\text{
is mixed)}}}+\left(  k+1\right)  \cdot\underbrace{\operatorname*{sig}\left(
\text{the }\left(  k+1\right)  \text{-th column of }P\right)  }%
_{\substack{=2\\\text{(since the }\left(  k+1\right)  \text{-th column of
}P\text{ is 1-pure)}}}\\
&  \ \ \ \ \ \ \ \ \ \ -k\cdot\underbrace{\operatorname*{sig}\left(  \text{the
}k\text{-th column of }\operatorname*{res}\nolimits_{k}P\right)
}_{\substack{=2\\\text{(since the }k\text{-th column of }\operatorname*{res}%
\nolimits_{k}P\text{ is 1-pure)}}}\\
&  \ \ \ \ \ \ \ \ \ \ -\left(  k+1\right)  \cdot
\underbrace{\operatorname*{sig}\left(  \text{the }\left(  k+1\right)
\text{-th column of }\operatorname*{res}\nolimits_{k}P\right)  }%
_{\substack{=2\\\text{(since the }\left(  k+1\right)  \text{-th column of
}\operatorname*{res}\nolimits_{k}P\text{ is mixed)}}}\\
&  =k\cdot1+\left(  k+1\right)  \cdot2-k\cdot2-\left(  k+1\right)  \cdot1=1>0.
\end{align*}
Thus, $\ell\left(  P\right)  -\ell\left(  \operatorname*{res}\nolimits_{k}%
P\right)  >0$ is proven in the case when $P$ has $k$-type M1. As we said, the
other two cases are left to the reader. Hence, $\ell\left(  P\right)
-\ell\left(  \operatorname*{res}\nolimits_{k}P\right)  >0$ is always proven.
This finishes the proof of Proposition \ref{prop.conflict-resolution-props}
\textbf{(h)}.
\end{proof}

\subsection{The conflict-resolution relation $\Rrightarrow$}

Let us now define a binary relation $\Rrightarrow$ on the set $\mathbf{S}$ as
follows: Let $P\in\mathbf{S}$ and $Q\in\mathbf{S}$. If $k\in\mathbb{N}_{+}$,
then we write $P\underset{k}{\Rrightarrow}Q$ if and only if $\left(
k,k+1\right)  $ is a conflict of $P$ and we have $Q=\operatorname*{res}%
\nolimits_{k}P$. (In other words, if $k\in\mathbb{N}_{+}$, then we write
$P\underset{k}{\Rrightarrow}Q$ if and only if $\left(  k,k+1\right)  $ is a
conflict of $P$ and the 12-table $Q$ is obtained from $P$ by resolving this
conflict.) We write $P\Rrightarrow Q$ if and only if there exists a
$k\in\mathbb{N}_{+}$ such that $P\underset{k}{\Rrightarrow}Q$. (In other
words, we write $P\Rrightarrow Q$ if and only if the 12-table $Q$ is obtained
from $P$ by resolving a conflict of the form $\left(  k,k+1\right)  $ with
$k\in\mathbb{N}_{+}$.) Thus, the relation $\Rrightarrow$ is defined.

Using the results we have shown above, we now readily obtain several
properties of this relation $\Rrightarrow$:

\begin{lemma}
\label{lem.conflict-resolution-props}Let $P\in\mathbf{S}$ and $Q\in\mathbf{S}$
be such that $P\Rrightarrow Q$. Then:

\textbf{(a)} We have $\operatorname*{ceq}\left(  Q\right)
=\operatorname*{ceq}\left(  P\right)  $.

\textbf{(b)} We have $\operatorname*{ircont}\left(  Q\right)
=\operatorname*{ircont}\left(  P\right)  $.

\textbf{(c)} The benign 12-tables $\operatorname*{flip}\left(  P\right)  $ and
$\operatorname*{flip}\left(  Q\right)  $ have the property that
$\operatorname*{flip}\left(  Q\right)  \Rrightarrow\operatorname*{flip}\left(
P\right)  $.

\textbf{(d)} We have $\ell\left(  P\right)  >\ell\left(  Q\right)  $.
\end{lemma}

\begin{proof}
[Proof of Lemma \ref{lem.conflict-resolution-props}.]We have $P\Rrightarrow
Q$. In other words, there exists a $k\in\mathbb{N}_{+}$ such that
$P\underset{k}{\Rrightarrow}Q$ (according to the definition of
\textquotedblleft$P\Rrightarrow Q$\textquotedblright). Consider this $k$. We
have $P\underset{k}{\Rrightarrow}Q$. In other words, $\left(  k,k+1\right)  $
is a conflict of $P$ and we have $Q=\operatorname*{res}\nolimits_{k}P$
(according to the definition of \textquotedblleft$P\underset{k}{\Rrightarrow
}Q$\textquotedblright).

\textbf{(a)} We have $\operatorname*{ceq}\left(  \underbrace{Q}%
_{=\operatorname*{res}\nolimits_{k}P}\right)  =\operatorname*{ceq}\left(
\operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{ceq}\left(
P\right)  $ (by (\ref{pf.lem.BK.res.ceq})). This proves Lemma
\ref{lem.conflict-resolution-props} \textbf{(a)}.

\textbf{(b)} We have $\operatorname*{ircont}\left(  \underbrace{Q}%
_{=\operatorname*{res}\nolimits_{k}P}\right)  =\operatorname*{ircont}\left(
\operatorname*{res}\nolimits_{k}P\right)  =\operatorname*{ircont}\left(
P\right)  $ (by (\ref{pf.lem.BK.res.irconts})). This proves Lemma
\ref{lem.conflict-resolution-props} \textbf{(a)}.

\textbf{(c)} From (\ref{pf.lem.BK.res.flip}), we know that $\left(
k,k+1\right)  $ is a conflict of $\operatorname*{flip}\left(
\operatorname*{res}\nolimits_{k}P\right)  $, and we have $\operatorname*{flip}%
\left(  P\right)  =\operatorname*{res}\nolimits_{k}\left(
\operatorname*{flip}\left(  \operatorname*{res}\nolimits_{k}P\right)  \right)
$. In other words, $\operatorname*{flip}\left(  \operatorname*{res}%
\nolimits_{k}P\right)  \underset{k}{\Rrightarrow}\operatorname*{flip}\left(
P\right)  $ (due to the definition of \textquotedblleft$\operatorname*{flip}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  \underset{k}{\Rrightarrow
}\operatorname*{flip}\left(  P\right)  $\textquotedblright). But since the
relation $\Rrightarrow$ extends the relation $\underset{k}{\Rrightarrow}$ (due
to the definition of $\Rrightarrow$), this yields that $\operatorname*{flip}%
\left(  \operatorname*{res}\nolimits_{k}P\right)  \Rrightarrow
\operatorname*{flip}\left(  P\right)  $. In other words, $\operatorname*{flip}%
\left(  Q\right)  \Rrightarrow\operatorname*{flip}\left(  P\right)  $ (since
$Q=\operatorname*{res}\nolimits_{k}P$). This proves Lemma
\ref{lem.conflict-resolution-props} \textbf{(c)}.

\textbf{(d)} From (\ref{pf.lem.BK.res.lendec}), we have $\ell\left(  P\right)
>\ell\left(  \underbrace{Q}_{=\operatorname*{res}\nolimits_{k}P}\right)
=\ell\left(  \operatorname*{res}\nolimits_{k}P\right)  $. This proves Lemma
\ref{lem.conflict-resolution-props} \textbf{(d)}.
\end{proof}

We furthermore define a relation $\overset{\ast}{\Rrightarrow}$ as in Lemma
\ref{lem.diamond}. In other words, $\overset{\ast}{\Rrightarrow}$ is the
reflexive-and-transitive closure of the relation $\Rrightarrow$. In
particular, the relation $\overset{\ast}{\Rrightarrow}$ is reflexive and
transitive, and extends the relation $\Rrightarrow$. Thus, it is easy to
derive from Lemma \ref{lem.conflict-resolution-props} the following fact:

\begin{lemma}
\label{lem.conflict-resolution-*props}Let $P\in\mathbf{S}$ and $Q\in
\mathbf{S}$ be such that $P\overset{\ast}{\Rrightarrow}Q$. Then:

\textbf{(a)} We have $\operatorname*{ceq}\left(  Q\right)
=\operatorname*{ceq}\left(  P\right)  $.

\textbf{(b)} We have $\operatorname*{ircont}\left(  Q\right)
=\operatorname*{ircont}\left(  P\right)  $.

\textbf{(c)} The benign 12-tables $\operatorname*{flip}\left(  P\right)  $ and
$\operatorname*{flip}\left(  Q\right)  $ have the property that
$\operatorname*{flip}\left(  Q\right)  \overset{\ast}{\Rrightarrow
}\operatorname*{flip}\left(  P\right)  $.
\end{lemma}

\begin{proof}
[Proof of Lemma \ref{lem.conflict-resolution-*props}.]We have $P\overset{\ast
}{\Rrightarrow}Q$. In other words, there exists a sequence $\left(
a_{0},a_{1},\ldots,a_{n}\right)  $ of elements of $\mathbf{S}$ such that
$a_{0}=P$ and $a_{n}=Q$ and such that every $i\in\left\{  0,1,\ldots
,n-1\right\}  $ satisfies $a_{i}\Rrightarrow a_{i+1}$ (due to the definition
of \textquotedblleft$P\overset{\ast}{\Rrightarrow}Q$\textquotedblright).
Consider this sequence.

\textbf{(a)} For every $i\in\left\{  0,1,\ldots,n-1\right\}  $, we have
$a_{i}\Rrightarrow a_{i+1}$ and thus $\operatorname*{ceq}\left(
a_{i+1}\right)  =\operatorname*{ceq}\left(  a_{i}\right)  $ (by Lemma
\ref{lem.conflict-resolution-props} \textbf{(a)}, applied to $a_{i}$ and
$a_{i+1}$ instead of $P$ and $Q$). Thus, $\operatorname*{ceq}\left(
a_{n}\right)  =\operatorname*{ceq}\left(  a_{n-1}\right)  =\cdots
=\operatorname*{ceq}\left(  a_{0}\right)  $, so that $\operatorname*{ceq}%
\left(  a_{n}\right)  =\operatorname*{ceq}\left(  a_{0}\right)  $. This
rewrites as $\operatorname*{ceq}\left(  Q\right)  =\operatorname*{ceq}\left(
P\right)  $ (since $P=a_{0}$ and $Q=a_{n}$). Lemma
\ref{lem.conflict-resolution-*props} \textbf{(a)} is thus proven.

\textbf{(b)} For every $i\in\left\{  0,1,\ldots,n-1\right\}  $, we have
$a_{i}\Rrightarrow a_{i+1}$ and thus $\operatorname*{ircont}\left(
a_{i+1}\right)  =\operatorname*{ircont}\left(  a_{i}\right)  $ (by Lemma
\ref{lem.conflict-resolution-props} \textbf{(b)}, applied to $a_{i}$ and
$a_{i+1}$ instead of $P$ and $Q$). Thus, $\operatorname*{ircont}\left(
a_{n}\right)  =\operatorname*{ircont}\left(  a_{n-1}\right)  =\cdots
=\operatorname*{ircont}\left(  a_{0}\right)  $, so that
$\operatorname*{ircont}\left(  a_{n}\right)  =\operatorname*{ircont}\left(
a_{0}\right)  $. This rewrites as $\operatorname*{ircont}\left(  Q\right)
=\operatorname*{ircont}\left(  P\right)  $ (since $P=a_{0}$ and $Q=a_{n}$).
Lemma \ref{lem.conflict-resolution-*props} \textbf{(b)} is thus proven.

\textbf{(c)} For every $i\in\left\{  0,1,\ldots,n-1\right\}  $, we have
$a_{i}\Rrightarrow a_{i+1}$ and thus
\begin{equation}
\operatorname*{flip}\left(  a_{i+1}\right)  \Rrightarrow\operatorname*{flip}%
\left(  a_{i}\right)  \label{pf.lem.conflict-resolution-*props.c.1}%
\end{equation}
(by Lemma \ref{lem.conflict-resolution-props} \textbf{(c)}, applied to $a_{i}$
and $a_{i+1}$ instead of $P$ and $Q$). Thus, for every $i\in\left\{
0,1,\ldots,n-1\right\}  $, we have $\operatorname*{flip}\left(  a_{\left(
n-1-i\right)  +1}\right)  \Rrightarrow\operatorname*{flip}\left(
a_{n-1-i}\right)  $ (according to (\ref{pf.lem.conflict-resolution-*props.c.1}%
), applied to $n-1-i$ instead of $i$). In other words, for every $i\in\left\{
0,1,\ldots,n-1\right\}  $, we have $\operatorname*{flip}\left(  a_{n-i}%
\right)  \Rrightarrow\operatorname*{flip}\left(  a_{n-\left(  i+1\right)
}\right)  $. Also, $\operatorname*{flip}\left(  \underbrace{a_{n-0}}%
_{=a_{n}=Q}\right)  =\operatorname*{flip}\left(  Q\right)  $ and
$\operatorname*{flip}\left(  \underbrace{a_{n-n}}_{=a_{0}=P}\right)
=\operatorname*{flip}\left(  P\right)  $. Thus, there exists a sequence
$\left(  b_{0},b_{1},\ldots,b_{n}\right)  $ of elements of $\mathbf{S}$ such
that $b_{0}=\operatorname*{flip}\left(  Q\right)  $ and $b_{n}%
=\operatorname*{flip}\left(  P\right)  $ and such that every $i\in\left\{
0,1,\ldots,n-1\right\}  $ satisfies $b_{i}\Rrightarrow b_{i+1}$ (namely, the
sequence $\left(  \operatorname*{flip}\left(  a_{n}\right)
,\operatorname*{flip}\left(  a_{n-1}\right)  ,\ldots,\operatorname*{flip}%
\left(  a_{0}\right)  \right)  $). In other words, $\operatorname*{flip}%
\left(  Q\right)  \overset{\ast}{\Rrightarrow}\operatorname*{flip}\left(
P\right)  $ (by the definition of the relation $\overset{\ast}{\Rrightarrow}%
$). Lemma \ref{lem.conflict-resolution-*props} \textbf{(c)} is thus proven.
\end{proof}

In Subsection \ref{subsect.fourtypes}, we defined a nonnegative integer
$\ell\left(  T\right)  $ for every 12-table $T$. In particular, $\ell\left(
T\right)  $ is defined for every $T\in\mathbf{S}$. We thus have a map
$\ell:\mathbf{S}\rightarrow\mathbb{N}$ which sends every $T\in\mathbf{S}$ to
$\ell\left(  T\right)  $.

Our goal is now to apply Lemma \ref{lem.diamond} to our set $\mathbf{S}$, our
map $\ell$ and our relation $\Rrightarrow$. In order to do so, we need to
check that the local confluence hypothesis and the length-decrease hypothesis
are satisfied\footnote{Both of these hypotheses have been stated in Lemma
\ref{lem.diamond}.}. Let us begin with the proof of the length-decrease hypothesis:

\textit{Proof that the length-decrease hypothesis is satisfied:} Let
$a\in\mathbf{S}$ and $b\in\mathbf{S}$ be such that $a\Rrightarrow b$. Then,
$\ell\left(  a\right)  >\ell\left(  b\right)  $ (by Lemma
\ref{lem.conflict-resolution-props} \textbf{(d)}, applied to $P=a$ and $Q=b$).
Thus, the length-decrease hypothesis is proven.

\textit{Proof that the local confluence hypothesis is satisfied:} We need to
show that if $a$, $b$ and $c$ are three elements of $\mathbf{S}$ satisfying
$a\Rrightarrow b$ and $a\Rrightarrow c$, then there exists a $d\in\mathbf{S}$
such that $b\overset{\ast}{\Rrightarrow}d$ and $c\overset{\ast}{\Rrightarrow
}d$. If we rename the bound variables $a$, $b$, $c$ and $d$ as $A$, $B$, $C$
and $D$ in this sentence, then we obtain the following: We need to show that
if $A$, $B$ and $C$ are three elements of $\mathbf{S}$ satisfying
$A\Rrightarrow B$ and $A\Rrightarrow C$, then there exists a $D\in\mathbf{S}$
such that $B\overset{\ast}{\Rrightarrow}D$ and $C\overset{\ast}{\Rrightarrow
}D$.

So let $A$, $B$ and $C$ be three elements of $\mathbf{S}$ satisfying
$A\Rrightarrow B$ and $A\Rrightarrow C$. We need to prove that there exists a
$D\in\mathbf{S}$ such that $B\overset{\ast}{\Rrightarrow}D$ and
$C\overset{\ast}{\Rrightarrow}D$. If $B=C$, then this is obvious (because we
can take $D=B=C$, and then both $B\overset{\ast}{\Rrightarrow}D$ and
$C\overset{\ast}{\Rrightarrow}D$ hold because the relation $\overset{\ast
}{\Rrightarrow}$ is reflexive). Hence, for the rest of this proof, we can WLOG
assume that we don't have $B=C$. Assume this.

We have $A\Rrightarrow B$. In other words, there exists a $k\in\mathbb{N}_{+}$
such that $A\underset{k}{\Rrightarrow}B$. Let us denote this $k$ by $u$. Thus,
$A\underset{u}{\Rrightarrow}B$. In other words, $\left(  u,u+1\right)  $ is a
conflict of $A$ and we have $B=\operatorname*{res}\nolimits_{u}A$ (due to the
definition of \textquotedblleft$A\underset{u}{\Rrightarrow}B$%
\textquotedblright).

We have $A\Rrightarrow C$. In other words, there exists a $k\in\mathbb{N}_{+}$
such that $A\underset{k}{\Rrightarrow}C$. Let us denote this $k$ by $v$. Thus,
$A\underset{v}{\Rrightarrow}C$. In other words, $\left(  v,v+1\right)  $ is a
conflict of $A$ and we have $C=\operatorname*{res}\nolimits_{v}A$ (due to the
definition of \textquotedblleft$A\underset{v}{\Rrightarrow}C$%
\textquotedblright).

We have $u\neq v$\ \ \ \ \footnote{\textit{Proof.} Assume the contrary. Thus,
$u=v$, so that $\operatorname*{res}\nolimits_{u}A=\operatorname*{res}%
\nolimits_{v}A$, and thus $B=\operatorname*{res}\nolimits_{u}%
A=\operatorname*{res}\nolimits_{v}A=C$. This contradicts the fact that we
don't have $B=C$. This contradiction proves that our assumption was wrong,
qed.}. Hence, $\left(  u,u+1\right)  \neq\left(  v,v+1\right)  $. Also,
$u-v\neq0$ (since $u\neq v$), thus $\left\vert u-v\right\vert \neq0$ and
therefore $\left\vert u-v\right\vert \geq1$. Hence, we must be in one of the
following two cases:

\textit{Case 1:} We have $\left\vert u-v\right\vert =1$.

\textit{Case 2:} We have $\left\vert u-v\right\vert >1$.

Let us consider Case 2 first. In this case, we have $\left\vert u-v\right\vert
>1$. Hence,%
\[
s_{u}\left(  v\right)  =v,\ \ \ \ \ \ \ \ \ \ s_{u}\left(  v+1\right)
=v+1,\ \ \ \ \ \ \ \ \ \ s_{v}\left(  u\right)  =u,\ \ \ \ \ \ \ \ \ \ s_{v}%
\left(  u+1\right)  =u+1,
\]
and $\left\{  u,u+1\right\}  \cap\left\{  v,v+1\right\}  =\varnothing$.

From (\ref{pf.lem.BK.res.conflict1}) (applied to $P=A$, $i=v$, $j=v+1$ and
$k=u$), we see that $\left(  s_{u}\left(  v\right)  ,s_{u}\left(  v+1\right)
\right)  $ is a conflict of $\operatorname*{res}\nolimits_{u}A$. In other
words, $\left(  v,v+1\right)  $ is a conflict of $B$ (since $s_{u}\left(
v\right)  =v$, $s_{u}\left(  v+1\right)  =v+1$ and $\operatorname*{res}%
\nolimits_{u}A=B$). Thus, $\operatorname*{res}\nolimits_{v}B$ is well-defined.

From (\ref{pf.lem.BK.res.conflict1}) (applied to $P=A$, $i=u$, $j=u+1$ and
$k=v$), we see that $\left(  s_{v}\left(  u\right)  ,s_{v}\left(  u+1\right)
\right)  $ is a conflict of $\operatorname*{res}\nolimits_{v}A$. In other
words, $\left(  u,u+1\right)  $ is a conflict of $C$ (since $s_{v}\left(
u\right)  =v$, $s_{v}\left(  u+1\right)  =u+1$ and $\operatorname*{res}%
\nolimits_{v}A=C$). Thus, $\operatorname*{res}\nolimits_{u}C$ is well-defined.

We shall now show that $\operatorname*{res}\nolimits_{v}B=\operatorname*{res}%
\nolimits_{u}C$. Indeed, every $h\in\mathbb{N}_{+}$ satisfies
\begin{equation}
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{v}%
B\right)  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{u}C\right)  . \label{pf.lem.BK.conf.c1.1}%
\end{equation}
\footnote{\textit{Proof of (\ref{pf.lem.BK.conf.c1.1}):} First, let
$h\in\left\{  v,v+1\right\}  $. Then, $h\notin\left\{  u,u+1\right\}  $ (since
otherwise, we would have $h\in\left\{  u,u+1\right\}  $, which (combined with
$h\in\left\{  v,v+1\right\}  $) would yield $h\in\left\{  u,u+1\right\}
\cap\left\{  v,v+1\right\}  =\varnothing$, which is absurd), so that
$h\in\mathbb{N}_{+}\setminus\left\{  u,u+1\right\}  $. Hence,
(\ref{pf.lem.BK.res.loc}) (applied to $P=A$ and $k=u$) yields%
\[
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{u}%
A\right)  =\left(  \text{the }h\text{-th column of }A\right)  .
\]
Since $\operatorname*{res}\nolimits_{u}A=B$, this rewrites as
\[
\left(  \text{the }h\text{-th column of }B\right)  =\left(  \text{the
}h\text{-th column of }A\right)  .
\]
\par
Let us now forget that we fixed $h$. We thus have shown that
\begin{align*}
\left(  \text{the }h\text{-th column of }B\right)   &  =\left(  \text{the
}h\text{-th column of }A\right) \\
&  \ \ \ \ \ \ \ \ \ \ \text{for each }h\in\left\{  v,v+1\right\}  .
\end{align*}
Thus, (\ref{pf.lem.BK.res.loc2}) (applied to $P=A$, $Q=B$ and $k=v$) yields%
\begin{align}
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{v}%
B\right)   &  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{v}A\right) \label{pf.lem.BK.conf.c1.1.pf.2}\\
&  \ \ \ \ \ \ \ \ \ \ \text{for each }h\in\left\{  v,v+1\right\}  .\nonumber
\end{align}
\par
Now, fix $h\in\mathbb{N}_{+}$. We want to prove (\ref{pf.lem.BK.conf.c1.1}).
At least one of the relations $h\notin\left\{  u,u+1\right\}  $ and
$h\notin\left\{  v,v+1\right\}  $ holds (because otherwise, we would have
$h\in\left\{  u,u+1\right\}  $ and $h\in\left\{  v,v+1\right\}  $, which would
lead to $h\in\left\{  u,u+1\right\}  \cap\left\{  v,v+1\right\}  =\varnothing
$, which is absurd). We WLOG assume that $h\notin\left\{  u,u+1\right\}  $
(since otherwise, we can achieve this by switching $B$ and $C$). Thus,
$h\in\mathbb{N}_{+}\setminus\left\{  u,u+1\right\}  $. Thus,
(\ref{pf.lem.BK.res.loc}) (applied to $P=C$ and $k=u$) yields%
\begin{align*}
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{u}%
C\right)   &  =\left(  \text{the }h\text{-th column of }\underbrace{C}%
_{=\operatorname*{res}\nolimits_{v}A}\right) \\
&  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{v}A\right)  .
\end{align*}
If $h\in\left\{  v,v+1\right\}  $, then comparing this with
(\ref{pf.lem.BK.conf.c1.1.pf.2}) yields $\left(  \text{the }h\text{-th column
of }\operatorname*{res}\nolimits_{v}B\right)  =\left(  \text{the }h\text{-th
column of }\operatorname*{res}\nolimits_{u}C\right)  $, which immediately
proves (\ref{pf.lem.BK.conf.c1.1}). Hence, for the rest of this proof of
(\ref{pf.lem.BK.conf.c1.1}), we can WLOG assume that $h\notin\left\{
v,v+1\right\}  $. Assume this. Then, $h\in\mathbb{N}_{+}\setminus\left\{
v,v+1\right\}  $. Then,%
\[
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{u}%
C\right)  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{v}A\right)  =\left(  \text{the }h\text{-th column of }A\right)
\]
(by (\ref{pf.lem.BK.res.loc}), applied to $P=A$ and $k=v$). Comparing this
with%
\begin{align*}
\left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{v}%
B\right)   &  =\left(  \text{the }h\text{-th column of }\underbrace{B}%
_{=\operatorname*{res}\nolimits_{u}A}\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BK.res.loc}), applied to
}P=B\text{ and }k=v\right) \\
&  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{u}A\right)  =\left(  \text{the }h\text{-th column of }A\right) \\
&  \ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BK.res.loc}), applied to
}P=A\text{ and }k=u\right)  ,
\end{align*}
we obtain $\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{v}B\right)  =\left(  \text{the }h\text{-th column of }%
\operatorname*{res}\nolimits_{u}C\right)  $. Thus, (\ref{pf.lem.BK.conf.c1.1})
is proven.} In other words, $\operatorname*{res}\nolimits_{v}%
B=\operatorname*{res}\nolimits_{u}C$. Define an element $D\in\mathbf{S}$ by
$D=\operatorname*{res}\nolimits_{v}B=\operatorname*{res}\nolimits_{u}C$. So we
know that $\left(  v,v+1\right)  $ is a conflict of $B$ and we have
$D=\operatorname*{res}\nolimits_{v}B$. In other words,
$B\underset{v}{\Rrightarrow}D$ (by the definition of \textquotedblleft%
$B\underset{v}{\Rrightarrow}D$\textquotedblright), so that $B\Rrightarrow D$
and thus $B\overset{\ast}{\Rrightarrow}D$ (since the relation $\overset{\ast
}{\Rrightarrow}$ extends $\Rrightarrow$). Similarly, $C\overset{\ast
}{\Rrightarrow}D$. Thus, the proof is complete in Case 2.

Let us now consider Case 1. In this case, we have $\left\vert u-v\right\vert
=1$. We can WLOG assume that $u\leq v$ (since otherwise, we can achieve this
by switching $B$ and $C$). Assume this. Thus, $u-v\leq0$, so that $\left\vert
u-v\right\vert =-\left(  u-v\right)  $ and thus $-\left(  u-v\right)
=\left\vert u-v\right\vert =1$. In other words, $u=v-1$. Thus, $\left(
u,u+1\right)  =\left(  v-1,v\right)  $. Hence, $\left(  v-1,v\right)  $ is a
conflict of $A$ (since $\left(  u,u+1\right)  $ is a conflict of $A$) and we
have $B=\operatorname*{res}\nolimits_{u}A=\operatorname*{res}\nolimits_{v-1}A$
(since $u=v-1$). Thus,%
\[
B=\operatorname*{res}\nolimits_{v-1}A\ \ \ \ \ \ \ \ \ \ \text{and}%
\ \ \ \ \ \ \ \ \ \ C=\operatorname*{res}\nolimits_{v}A.
\]
Also, Proposition \ref{prop.conflict.transitive} (applied to $T=A$, $a=v-1$,
$b=v$ and $c=v+1$) yields that $\left(  v-1,v+1\right)  $ is a conflict of $A$
(since $\left(  v-1,v\right)  $ and $\left(  v,v+1\right)  $ are conflicts of
$A$).

Now we know that $\left(  v-1,v+1\right)  $ is a conflict of $A$ such that
$\left(  v-1,v+1\right)  \neq\left(  v,v+1\right)  $. Thus, Proposition
\ref{prop.conflict-resolution-props} \textbf{(f)} (applied to $P=A$, $k=v$,
$i=v-1$ and $j=v+1$) yields that $\left(  s_{v}\left(  v-1\right)
,s_{v}\left(  v+1\right)  \right)  $ is a conflict of $\operatorname*{res}%
\nolimits_{v}A$. In other words, $\left(  v-1,v\right)  $ is a conflict of $C$
(since $s_{v}\left(  v-1\right)  =v-1$, $s_{v}\left(  v+1\right)  =v$ and
$\operatorname*{res}\nolimits_{v}A=C$). Hence, $\operatorname*{res}%
\nolimits_{v-1}C$ is well-defined. Similarly, we can show that
$\operatorname*{res}\nolimits_{v}B$ is well-defined\footnote{\textit{Proof.}
We know that $\left(  v-1,v+1\right)  $ is a conflict of $A$ such that
$\left(  v-1,v+1\right)  \neq\left(  v-1,v\right)  $. Thus, Proposition
\ref{prop.conflict-resolution-props} \textbf{(f)} (applied to $P=A$, $k=v-1$,
$i=v-1$ and $j=v+1$) yields that $\left(  s_{v-1}\left(  v-1\right)
,s_{v-1}\left(  v+1\right)  \right)  $ is a conflict of $\operatorname*{res}%
\nolimits_{v-1}A$. In other words, $\left(  v,v+1\right)  $ is a conflict of
$B$ (since $s_{v-1}\left(  v-1\right)  =v$, $s_{v-1}\left(  v+1\right)  =v+1$
and $\operatorname*{res}\nolimits_{v-1}A=B$). Hence, $\operatorname*{res}%
\nolimits_{v}B$ is well-defined, qed.}.

We furthermore know that $\left(  v-1,v\right)  $ is a conflict of $A$ such
that $\left(  v-1,v\right)  \neq\left(  v,v+1\right)  $. Thus, Proposition
\ref{prop.conflict-resolution-props} \textbf{(f)} (applied to $P=A$, $k=v$,
$i=v-1$ and $j=v$) yields that $\left(  s_{v}\left(  v-1\right)  ,s_{v}\left(
v\right)  \right)  $ is a conflict of $\operatorname*{res}\nolimits_{v}A$. In
other words, $\left(  v-1,v+1\right)  $ is a conflict of $C$ (since
$s_{v}\left(  v-1\right)  =v-1$, $s_{v}\left(  v\right)  =v+1$ and
$\operatorname*{res}\nolimits_{v}A=C$). This conflict clearly satisfies
$\left(  v-1,v+1\right)  \neq\left(  v-1,v\right)  $. Therefore, Proposition
\ref{prop.conflict-resolution-props} \textbf{(f)} (applied to $P=C$, $k=v-1$,
$i=v-1$ and $j=v+1$) yields that $\left(  s_{v-1}\left(  v-1\right)
,s_{v-1}\left(  v+1\right)  \right)  $ is a conflict of $\operatorname*{res}%
\nolimits_{v-1}C$. In other words, $\left(  v,v+1\right)  $ is a conflict of
$\operatorname*{res}\nolimits_{v-1}C$ (since $s_{v-1}\left(  v-1\right)  =v$
and $s_{v-1}\left(  v+1\right)  =v+1$). Hence, $\operatorname*{res}%
\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}C\right)  $ is
well-defined. Similarly, we can show that $\left(  v-1,v\right)  $ is a
conflict of $\operatorname*{res}\nolimits_{v}B$%
\ \ \ \ \footnote{\textit{Proof.} We know that $\left(  v,v+1\right)  $ is a
conflict of $A$ such that $\left(  v,v+1\right)  \neq\left(  v-1,v\right)  $.
Thus, Proposition \ref{prop.conflict-resolution-props} \textbf{(f)} (applied
to $P=A$, $k=v-1$, $i=v$ and $j=v+1$) yields that $\left(  s_{v-1}\left(
v\right)  ,s_{v-1}\left(  v+1\right)  \right)  $ is a conflict of
$\operatorname*{res}\nolimits_{v-1}A$. In other words, $\left(
v-1,v+1\right)  $ is a conflict of $B$ (since $s_{v-1}\left(  v\right)  =v-1$,
$s_{v-1}\left(  v+1\right)  =v+1$ and $\operatorname*{res}\nolimits_{v-1}%
A=B$). This conflict clearly satisfies $\left(  v-1,v+1\right)  \neq\left(
v,v+1\right)  $. Therefore, Proposition \ref{prop.conflict-resolution-props}
\textbf{(f)} (applied to $P=B$, $k=v$, $i=v-1$ and $j=v+1$) yields that
$\left(  s_{v}\left(  v-1\right)  ,s_{v}\left(  v+1\right)  \right)  $ is a
conflict of $\operatorname*{res}\nolimits_{v}B$. In other words, $\left(
v-1,v\right)  $ is a conflict of $\operatorname*{res}\nolimits_{v}B$ (since
$s_{v}\left(  v-1\right)  =v-1$ and $s_{v}\left(  v+1\right)  =v$), qed.}.
Hence, $\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  $ is well-defined.

From the definition of the relation $\overset{\ast}{\Rrightarrow}$, it is easy
to obtain $B\overset{\ast}{\Rrightarrow}\operatorname*{res}\nolimits_{v-1}%
\left(  \operatorname*{res}\nolimits_{v}B\right)  $%
\ \ \ \ \footnote{\textit{Proof.} We know that $\left(  v,v+1\right)  $ is a
conflict of $B$. Hence, $B\underset{v}{\Rrightarrow}\operatorname*{res}%
\nolimits_{v}B$ (by the definition of \textquotedblleft%
$B\underset{v}{\Rrightarrow}\operatorname*{res}\nolimits_{v}B$%
\textquotedblright), so that $B\Rrightarrow\operatorname*{res}\nolimits_{v}B$
(by the definition of the relation $\Rrightarrow$) and thus $B\overset{\ast
}{\Rrightarrow}\operatorname*{res}\nolimits_{v}B$ (since the relation
$\overset{\ast}{\Rrightarrow}$ extends the relation $\Rrightarrow$).
\par
But $\left(  v-1,v\right)  $ is a conflict of $\operatorname*{res}%
\nolimits_{v}B$. Hence, $\operatorname*{res}\nolimits_{v}%
B\underset{v-1}{\Rrightarrow}\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  $ (by the definition of
\textquotedblleft$\operatorname*{res}\nolimits_{v}B\underset{v-1}{\Rrightarrow
}\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  $\textquotedblright), so that $\operatorname*{res}\nolimits_{v}%
B\Rrightarrow\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  $ (by the definition of the relation $\Rrightarrow$)
and thus $\operatorname*{res}\nolimits_{v}B\overset{\ast}{\Rrightarrow
}\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  $ (since the relation $\overset{\ast}{\Rrightarrow}$ extends the
relation $\Rrightarrow$). Combining $B\overset{\ast}{\Rrightarrow
}\operatorname*{res}\nolimits_{v}B$ with $\operatorname*{res}\nolimits_{v}%
B\overset{\ast}{\Rrightarrow}\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  $, we obtain $B\overset{\ast
}{\Rrightarrow}\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  $ (since the relation $\overset{\ast}{\Rrightarrow}$ is
transitive), qed.}. Similarly, $C\overset{\ast}{\Rrightarrow}%
\operatorname*{res}\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}%
C\right)  $.

Our next goal is to prove that $\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  =\operatorname*{res}\nolimits_{v}%
\left(  \operatorname*{res}\nolimits_{v-1}C\right)  $.

Let us first find out how the $\left(  v-1\right)  $-th, the $v$-th, and the
$\left(  v+1\right)  $-th columns of $A$ look like.

Since $\left(  v,v+1\right)  $ is a conflict of $A$, it is clear that the
$v$-th column of $A$ must contain at least one $2$. But since $\left(
v-1,v\right)  $ is a conflict of $A$, it is clear that the $v$-th column of
$A$ must contain at least one $1$. Thus, the $v$-th column of $A$ contains at
least one $1$ and at least one $2$; it thus is mixed.

Since $\left(  v,v+1\right)  $ is a conflict of $A$, it is clear that the
$\left(  v+1\right)  $-th column of $A$ must contain at least one $1$. Thus,
the $\left(  v+1\right)  $-th column of $A$ is either mixed or 1-pure. But it
cannot be mixed\footnote{\textit{Proof.} Assume the contrary. Then, both the
$v$-th and the $\left(  v+1\right)  $-th column of $A$ are mixed. But $A$ is
benign. In other words, there exists no conflict $\left(  i,j\right)  $ of $T$
such that the $i$-th column of $T$ and the $j$-th column of $T$ both are
mixed. This flies in the face of the fact that $\left(  v,v+1\right)  $ is
exactly such a conflict. This contradiction proves that our assumption was
wrong, qed.}, and thus it must be 1-pure.

Since $\left(  v-1,v\right)  $ is a conflict of $A$, it is clear that the
$\left(  v-1\right)  $-th column of $A$ must contain at least one $2$. Thus,
the $\left(  v-1\right)  $-th column of $A$ is either mixed or 2-pure. But it
cannot be mixed\footnote{\textit{Proof.} Assume the contrary. Then, both the
$\left(  v-1\right)  $-th and the $v$-th column of $A$ are mixed. But $A$ is
benign. In other words, there exists no conflict $\left(  i,j\right)  $ of $T$
such that the $i$-th column of $T$ and the $j$-th column of $T$ both are
mixed. This flies in the face of the fact that $\left(  v-1,v\right)  $ is
exactly such a conflict. This contradiction proves that our assumption was
wrong, qed.}, and thus it must be 2-pure.

So we know that:

\begin{itemize}
\item the $\left(  v-1\right)  $-th column of $A$ is 2-pure;

\item the $v$-th column of $A$ is mixed;

\item the $\left(  v+1\right)  $-th column of $A$ is 1-pure.
\end{itemize}

Now we shall find out how the $\left(  v-1\right)  $-th, the $v$-th, and the
$\left(  v+1\right)  $-th columns of $\operatorname*{res}\nolimits_{v-1}%
\left(  \operatorname*{res}\nolimits_{v}B\right)  $ look like.

First of all, how do the respective columns of $B$ look like? Recall that
$B=\operatorname*{res}\nolimits_{v-1}A$. The 12-table $A$ has $\left(
v-1\right)  $-type 2M (since the $\left(  v-1\right)  $-th column of $A$ is
2-pure, while the $v$-th column of $A$ is mixed). Thus, the definition of
$\operatorname*{res}_{v-1}A$ shows that $\operatorname*{res}_{v-1}A$ is the
12-table which differs from $A$ in that the $\left(  v-1\right)  $-th column
of $\operatorname*{res}_{v-1}A$ is mixed and satisfies $\operatorname*{sep}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v-1}A\right)
=\operatorname*{sep}\nolimits_{v}A$, whereas the $v$-th column of
$\operatorname*{res}\nolimits_{v}A$ is 2-pure. Since $\operatorname*{res}%
\nolimits_{v-1}A=B$, this rewrites as follows: $B$ is the 12-table which
differs from $A$ in that the $\left(  v-1\right)  $-th column of $B$ is mixed
and satisfies $\operatorname*{sep}\nolimits_{v-1}B=\operatorname*{sep}%
\nolimits_{v}A$, whereas the $v$-th column of $B$ is 2-pure. Thus:

\begin{itemize}
\item the $\left(  v-1\right)  $-th column of $B$ is mixed and satisfies
$\operatorname*{sep}\nolimits_{v-1}B=\operatorname*{sep}\nolimits_{v}A$;

\item the $v$-th column of $B$ is 2-pure;

\item the $\left(  v+1\right)  $-th column of $B$ is the same as the $\left(
v+1\right)  $-th column of $A$\ \ \ \ \footnote{since $v+1\notin\left\{
v-1,v\right\}  $}, and thus is 1-pure\footnote{since the $\left(  v+1\right)
$-th column of $A$ is 1-pure}.
\end{itemize}

But the 12-table $B$ has $v$-type 21 (since the $v$-th column of $B$ is
2-pure, and the $\left(  v+1\right)  $-th column of $P$ is 1-pure). Thus, the
definition of $\operatorname*{res}\nolimits_{v}B$ shows that
$\operatorname*{res}\nolimits_{v}B$ is the 12-table which differs from $B$ in
that the $v$-th column of $\operatorname*{res}\nolimits_{v}B$ is 1-pure,
whereas the $\left(  v+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v}B$ is 2-pure. Thus:

\begin{itemize}
\item the $\left(  v-1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v}B$ is the same as the $\left(  v-1\right)  $-th column of
$B$\ \ \ \ \footnote{since $v-1\notin\left\{  v,v+1\right\}  $}; hence, it is
mixed\footnote{since the $\left(  v-1\right)  $-th column of $B$ is mixed} and
satisfies $\operatorname*{sep}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  =\operatorname*{sep}\nolimits_{v-1}%
B=\operatorname*{sep}\nolimits_{v}A$;

\item the $v$-th column of $\operatorname*{res}\nolimits_{v}B$ is 1-pure;

\item the $\left(  v+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v}B$ is 2-pure.
\end{itemize}

But the 12-table $\operatorname*{res}\nolimits_{v}B$ has $\left(  v-1\right)
$-type M1 (since the $\left(  v-1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v}B$ is mixed, and the $v$-th column of $\operatorname*{res}%
\nolimits_{v}B$ is 1-pure). Thus, the definition of $\operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  $ shows that
$\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  $ is the 12-table which differs from $\operatorname*{res}%
\nolimits_{v}B$ in that the $\left(  v-1\right)  $-th column of
$\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  $ is 1-pure, whereas the $v$-th column of $\operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  $ is mixed
and satisfies $\operatorname*{sep}\nolimits_{v}\left(  \operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  \right)
=\operatorname*{sep}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  $. Thus:

\begin{itemize}
\item the $\left(  v-1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  $ is 1-pure;

\item the $v$-th column of $\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  $ is mixed and satisfies
$\operatorname*{sep}\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}%
\left(  \operatorname*{res}\nolimits_{v}B\right)  \right)
=\operatorname*{sep}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  =\operatorname*{sep}\nolimits_{v}A$;

\item the $\left(  v+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  $ is the same
as the $\left(  v+1\right)  $-th column of $\operatorname*{res}\nolimits_{v}%
B$\ \ \ \ \footnote{since $v+1\notin\left\{  v-1,v\right\}  $}, and thus is
2-pure\footnote{since the $\left(  v+1\right)  $-th column of
$\operatorname*{res}\nolimits_{v}B$ is 2-pure}.
\end{itemize}

Also, for every $h\in\mathbb{N}_{+}\setminus\left\{  v-1,v,v+1\right\}  $, it
is clear that the $h$-th column of $\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  $ is the same as the $h$-th column
of $A$\ \ \ \ \footnote{\textit{Proof.} Fix $h\in\mathbb{N}_{+}\setminus
\left\{  v-1,v,v+1\right\}  $. Then, $h\in\mathbb{N}_{+}\setminus\left\{
v-1,v,v+1\right\}  \subseteq\mathbb{N}_{+}\setminus\left\{  v,v+1\right\}  $
and $h\in\mathbb{N}_{+}\setminus\left\{  v-1,v,v+1\right\}  \subseteq
\mathbb{N}_{+}\setminus\left\{  v-1,v\right\}  $. Now,%
\begin{align*}
&  \left(  \text{the }h\text{-th column of }\operatorname*{res}\nolimits_{v-1}%
\left(  \operatorname*{res}\nolimits_{v}B\right)  \right) \\
&  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{v}B\right)  \ \ \ \ \ \ \ \ \ \ \left(  \text{by
(\ref{pf.lem.BK.res.loc}), applied to }P=\operatorname*{res}\nolimits_{v}%
B\text{ and }k=v-1\right) \\
&  =\left(  \text{the }h\text{-th column of }\underbrace{B}%
_{=\operatorname*{res}\nolimits_{v-1}A}\right)  \ \ \ \ \ \ \ \ \ \ \left(
\text{by (\ref{pf.lem.BK.res.loc}), applied to }P=B\text{ and }k=v\right) \\
&  =\left(  \text{the }h\text{-th column of }\operatorname*{res}%
\nolimits_{v-1}A\right) \\
&  =\left(  \text{the }h\text{-th column of }A\right)
\ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.BK.res.loc}), applied to
}P=A\text{ and }k=v-1\right)  ,
\end{align*}
qed.}. We can summarize these facts as follows:

\begin{itemize}
\item the $\left(  v-1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  $ is 1-pure;

\item the $v$-th column of $\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  $ is mixed and satisfies
$\operatorname*{sep}\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}%
\left(  \operatorname*{res}\nolimits_{v}B\right)  \right)
=\operatorname*{sep}\nolimits_{v}A$;

\item the $\left(  v+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  $ is 2-pure;

\item for every $h\in\mathbb{N}_{+}\setminus\left\{  v-1,v,v+1\right\}  $, the
$h$-th column of $\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  $ is the same as the $h$-th column
of $A$.
\end{itemize}

Notice that these facts uniquely describe all the columns of
$\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  $. Thus, we have described all columns of $\operatorname*{res}%
\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}B\right)  $. Similarly,
we can describe the columns of $\operatorname*{res}\nolimits_{v}\left(
\operatorname*{res}\nolimits_{v-1}C\right)  $\ \ \ \ \footnote{Here, of
course, we have to use $C=\operatorname*{res}\nolimits_{v}A$ instead of
$B=\operatorname*{res}\nolimits_{v-1}A$.}; as the result, we obtain:

\begin{itemize}
\item the $\left(  v-1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}C\right)  $ is 1-pure;

\item the $v$-th column of $\operatorname*{res}\nolimits_{v}\left(
\operatorname*{res}\nolimits_{v-1}C\right)  $ is mixed and satisfies
$\operatorname*{sep}\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v}%
\left(  \operatorname*{res}\nolimits_{v-1}C\right)  \right)
=\operatorname*{sep}\nolimits_{v}A$;

\item the $\left(  v+1\right)  $-th column of $\operatorname*{res}%
\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}C\right)  $ is 2-pure;

\item for every $h\in\mathbb{N}_{+}\setminus\left\{  v-1,v,v+1\right\}  $, the
$h$-th column of $\operatorname*{res}\nolimits_{v}\left(  \operatorname*{res}%
\nolimits_{v-1}C\right)  $ is the same as the $h$-th column of $A$.
\end{itemize}

Comparing this description of the columns of $\operatorname*{res}%
\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}C\right)  $ with the
above description of the columns of $\operatorname*{res}\nolimits_{v-1}\left(
\operatorname*{res}\nolimits_{v}B\right)  $, we notice that these descriptions
are precisely identical. Hence, for every $h\in\mathbb{N}_{+}$, the $h$-th
column of $\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  $ equals the $h$-th column of $\operatorname*{res}%
\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}C\right)  $. Hence,
$\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}\nolimits_{v}%
B\right)  =\operatorname*{res}\nolimits_{v}\left(  \operatorname*{res}%
\nolimits_{v-1}C\right)  $.

Now, set $D=\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  =\operatorname*{res}\nolimits_{v}\left(
\operatorname*{res}\nolimits_{v-1}C\right)  $. Recall that $B\overset{\ast
}{\Rrightarrow}\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  $. In other words, $B\overset{\ast}{\Rrightarrow}D$
(since $D=\operatorname*{res}\nolimits_{v-1}\left(  \operatorname*{res}%
\nolimits_{v}B\right)  $). Also, recall that $C\overset{\ast}{\Rrightarrow
}\operatorname*{res}\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}%
C\right)  $. In other words, $C\overset{\ast}{\Rrightarrow}D$ (since
$D=\operatorname*{res}\nolimits_{v}\left(  \operatorname*{res}\nolimits_{v-1}%
C\right)  $). Thus, our $D\in\mathbf{S}$ satisfies $B\overset{\ast
}{\Rrightarrow}D$ and $C\overset{\ast}{\Rrightarrow}D$. This completes the
proof in Case 1.

Hence, in both Cases 1 and 2, we have shown that there exists a $D\in
\mathbf{S}$ such that $B\overset{\ast}{\Rrightarrow}D$ and $C\overset{\ast
}{\Rrightarrow}D$. Since these two Cases cover all possibilities, this shows
that there always exists a $D\in\mathbf{S}$ such that $B\overset{\ast
}{\Rrightarrow}D$ and $C\overset{\ast}{\Rrightarrow}D$. This completes the
proof of the local confluence hypothesis.

Now, let us define the notion of a \textquotedblleft final\textquotedblright%
\ element of $\mathbf{S}$ as in Lemma \ref{lem.diamond}. Then, the following
is almost obvious:

\begin{proposition}
\label{prop.finality}Let $P\in\mathbf{S}$. Then, the element $P$ of
$\mathbf{S}$ is final if and only if $P$ is a 12-rpp.
\end{proposition}

\begin{proof}
[Proof of Proposition \ref{prop.finality}.]Let us first assume that $P$ is
final. We shall show that $P$ is a 12-rpp.

Indeed, assume the contrary. Then, $P$ is not a 12-rpp. But $P$ is an element
of $\mathbf{S}$, thus a benign 12-table. The entries of $P$ are weakly
increasing down columns (since $P$ is a 12-table). Thus, if the entries of $P$
are not weakly increasing along rows (because otherwise, $P$ would be a
12-rpp). In other words, there exists an $r\in\mathbb{N}_{+}$ such that the
$r$-th row of $P$ is not weakly increasing. Consider this $r$. The $r$-th row
of $P$ is not weakly increasing; hence, there exist two adjacent entries of
this row such that the left one is larger than the right one. In other words,
there exists a $k\in\mathbb{N}_{+}$ such that $\left(  r,k\right)  \in Z$,
$\left(  r,k+1\right)  \in Z$ and $P\left(  r,k\right)  >P\left(
r,k+1\right)  $. Consider this $k$. We have $P\left(  r,k+1\right)
\in\left\{  1,2\right\}  $ and thus $P\left(  r,k+1\right)  \geq1$. Hence,
$P\left(  r,k\right)  >P\left(  r,k+1\right)  \geq1$, so that $P\left(
r,k\right)  =2$ (since $P\left(  r,k\right)  \in\left\{  1,2\right\}  $). From
$P\left(  r,k\right)  >P\left(  r,k+1\right)  $, we obtain $P\left(
r,k+1\right)  <P\left(  r,k\right)  =2$, so that $P\left(  r,k+1\right)  =1$
(since $P\left(  r,k+1\right)  \in\left\{  1,2\right\}  $). So we know that
$\left(  r,k\right)  \in Z$, $\left(  r,k+1\right)  \in Z$, $P\left(
r,k\right)  =2$ and $P\left(  r,k+1\right)  =1$. Hence, $\left(  k,k+1\right)
$ is a conflict of $P$ (due to the definition of a \textquotedblleft
conflict\textquotedblright). Consequently, $\operatorname*{res}\nolimits_{k}P$
is well-defined, and we have $P\underset{k}{\Rrightarrow}\operatorname*{res}%
\nolimits_{k}P$ (due to the definition of \textquotedblleft%
$P\underset{k}{\Rrightarrow}\operatorname*{res}\nolimits_{k}P$%
\textquotedblright), so that $P\Rrightarrow\operatorname*{res}\nolimits_{k}P$
(due to the definition of the relation $\Rrightarrow$).

But recall that $P$ is final. In other words, there exists no $b\in\mathbf{S}$
satisfying $P\Rrightarrow b$ (according to the definition of \textquotedblleft
final\textquotedblright). This contradicts the fact that $\operatorname*{res}%
\nolimits_{k}P$ is such a $b$ (since $P\Rrightarrow\operatorname*{res}%
\nolimits_{k}P$ and $\operatorname*{res}\nolimits_{k}P\in\mathbf{S}$). This
contradiction proves that our assumption was wrong. So we have shown that $P$
is a 12-rpp.

Now, let us forget that we assumed that $P$ is final. Thus, we have proven
that if $P$ is final, then $P$ is a 12-rpp. It remains to prove the converse.
In other words, it remains to prove that if $P$ is a 12-rpp, then $P$ is final.

So let us assume that $P$ is a 12-rpp. Let $b\in\mathbf{S}$ be such that
$P\Rrightarrow b$. Then, there exists a $k\in\mathbb{N}_{+}$ such that
$P\underset{k}{\Rrightarrow}b$ (by the definition of the relation
$\Rrightarrow$). Consider this $k$. We have $P\underset{k}{\Rrightarrow}b$. In
other words, $\left(  k,k+1\right)  $ is a conflict of $P$ and we have
$b=\operatorname*{res}\nolimits_{k}P$ (due to the definition of
\textquotedblleft$P\underset{k}{\Rrightarrow}b$\textquotedblright). But $P$ is
a 12-rpp of shape $Z$, and thus a 12-table which has no conflicts (due to
(\ref{pf.lem.BK.no-conflicts})). So $\left(  k,k+1\right)  $ is a conflict of
$P$, but $P$ has no conflicts. This is a contradiction.

Now, let us forget that we fixed $b$. We thus have found a contradiction for
every $b\in\mathbf{S}$ satisfying $P\Rrightarrow b$. Hence, there exists no
$b\in\mathbf{S}$ satisfying $P\Rrightarrow b$. In other words, $P$ is final
(according to the definition of \textquotedblleft final\textquotedblright).
This completes our proof of Proposition \ref{prop.finality}.
\end{proof}

\subsection{The normalization map}

We now define a map $\operatorname*{norm}:\mathbf{S}\rightarrow\mathbf{R}$ as follows:

Let $T\in\mathbf{S}$. Lemma \ref{lem.diamond} shows that for every
$a\in\mathbf{S}$, there exists a unique final element $b\in\mathbf{S}$ such
that $a\overset{\ast}{\Rrightarrow}b$. Applying this to $a=T$, we conclude
that there exists a unique final element $b\in\mathbf{S}$ such that
$T\overset{\ast}{\Rrightarrow}b$. Denote this $b$ by $P$. Then, $P$ is a final
element of $\mathbf{S}$ and satisfies $T\overset{\ast}{\Rrightarrow}P$. But
Proposition \ref{prop.finality} shows that $P$ is final if and only if $P$ is
a 12-rpp. Hence, $P$ is a 12-rpp (since $P$ is final). In other words,
$P\in\mathbf{R}$ (since $\mathbf{R}$ is the set of all 12-rpps). We define
$\operatorname*{norm}\left(  T\right)  $ to be $P$.

Thus, for every $T\in\mathbf{S}$, we have defined $\operatorname*{norm}\left(
T\right)  $ to be the unique final element $b\in\mathbf{S}$ such that
$T\overset{\ast}{\Rrightarrow}b$. As a consequence, for every $T\in\mathbf{S}%
$, we have
\begin{equation}
T\overset{\ast}{\Rrightarrow}\operatorname*{norm}\left(  T\right)  .
\label{pf.lem.BK.norm.=>}%
\end{equation}


Thus, the map $\operatorname*{norm}:\mathbf{S}\rightarrow\mathbf{R}$ is defined.

\begin{example}
Let us give an example of a computation of $\operatorname*{norm}\left(
T\right)  $. For this example, let us take%
\[
T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 1 \\
%\none& 1 & 1 & 2 \\
%2 & 1 & 1 \\
%2 & 2 & 1 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 1 \\
\none& 1 & 1 & 2 \\
2 & 1 & 1 \\
2 & 2 & 1 \\
2
\end{ytableau}%
%EndExpansion
.
\]
Then, $\operatorname*{norm}\left(  T\right)  $ is the unique final element
$b\in\mathbf{S}$ such that $T\overset{\ast}{\Rrightarrow}b$. Thus, we can
obtain $\operatorname*{norm}\left(  T\right)  $ from $T$ by repeatedly
resolving conflicts until no more conflicts are left (because
\textquotedblleft$T\overset{\ast}{\Rrightarrow}b$\textquotedblright\ means
\textquotedblleft$b$ can be obtained from $T$ by repeatedly resolving
conflicts\textquotedblright). The word \textquotedblleft
unique\textquotedblright\ here implies that, in whatever order we resolve
conflicts, the result will always be the same.

Let us first resolve the conflict $\left(  2,3\right)  $ in $T$. This gives us
the 12-table%
\[
\operatorname*{res}\nolimits_{2}T=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 1 \\
%\none& 1 & 1 & 2 \\
%2 & 1 & 1 \\
%2 & 1 & 2 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 1 \\
\none& 1 & 1 & 2 \\
2 & 1 & 1 \\
2 & 1 & 2 \\
2
\end{ytableau}%
%EndExpansion
.
\]
(In fact, we have seen this in Example \ref{exa.resolve} already, but we
called the 12-table by $T$ there.) Next, resolving the conflict $\left(
4,5\right)  $ in $\operatorname*{res}\nolimits_{2}T$, we obtain the 12-table%
\[
\operatorname*{res}\nolimits_{4}\left(  \operatorname*{res}\nolimits_{2}%
T\right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 1 & 2 \\
%\none& 1 & 1 & 1 \\
%2 & 1 & 1 \\
%2 & 1 & 2 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 1 & 2 \\
\none& 1 & 1 & 1 \\
2 & 1 & 1 \\
2 & 1 & 2 \\
2
\end{ytableau}%
%EndExpansion
.
\]
We go on by resolving the conflict $\left(  1,2\right)  $ in
$\operatorname*{res}\nolimits_{4}\left(  \operatorname*{res}\nolimits_{2}%
T\right)  $, and thus obtain%
\[
\operatorname*{res}\nolimits_{1}\left(  \operatorname*{res}\nolimits_{4}%
\left(  \operatorname*{res}\nolimits_{2}T\right)  \right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 1 & 2 \\
%\none& 2 & 1 & 1 \\
%1 & 2 & 1 \\
%1 & 2 & 2 \\
%1
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 1 & 2 \\
\none& 2 & 1 & 1 \\
1 & 2 & 1 \\
1 & 2 & 2 \\
1
\end{ytableau}%
%EndExpansion
.
\]
Next, we resolve the conflict $\left(  2,3\right)  $ in $\operatorname*{res}%
\nolimits_{1}\left(  \operatorname*{res}\nolimits_{4}\left(
\operatorname*{res}\nolimits_{2}T\right)  \right)  $, and obtain%
\[
\operatorname*{res}\nolimits_{2}\left(  \operatorname*{res}\nolimits_{1}%
\left(  \operatorname*{res}\nolimits_{4}\left(  \operatorname*{res}%
\nolimits_{2}T\right)  \right)  \right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 2 & 1 & 2 \\
%\none& 1 & 2 & 1 \\
%1 & 1 & 2 \\
%1 & 2 & 2 \\
%1
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 2 & 1 & 2 \\
\none& 1 & 2 & 1 \\
1 & 1 & 2 \\
1 & 2 & 2 \\
1
\end{ytableau}%
%EndExpansion
.
\]
Next, we resolve the conflict $\left(  3,4\right)  $ in $\operatorname*{res}%
\nolimits_{2}\left(  \operatorname*{res}\nolimits_{1}\left(
\operatorname*{res}\nolimits_{4}\left(  \operatorname*{res}\nolimits_{2}%
T\right)  \right)  \right)  $, and this leads us to%
\[
\operatorname*{res}\nolimits_{3}\left(  \operatorname*{res}\nolimits_{2}%
\left(  \operatorname*{res}\nolimits_{1}\left(  \operatorname*{res}%
\nolimits_{4}\left(  \operatorname*{res}\nolimits_{2}T\right)  \right)
\right)  \right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 2 \\
%\none& 1 & 1 & 2 \\
%1 & 1 & 1 \\
%1 & 2 & 1 \\
%1
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 2 \\
\none& 1 & 1 & 2 \\
1 & 1 & 1 \\
1 & 2 & 1 \\
1
\end{ytableau}%
%EndExpansion
.
\]
Finally, we resolve the conflict $\left(  2,3\right)  $ in
$\operatorname*{res}\nolimits_{3}\left(  \operatorname*{res}\nolimits_{2}%
\left(  \operatorname*{res}\nolimits_{1}\left(  \operatorname*{res}%
\nolimits_{4}\left(  \operatorname*{res}\nolimits_{2}T\right)  \right)
\right)  \right)  $, and thus obtain%
\[
\operatorname*{res}\nolimits_{2}\left(  \operatorname*{res}\nolimits_{3}%
\left(  \operatorname*{res}\nolimits_{2}\left(  \operatorname*{res}%
\nolimits_{1}\left(  \operatorname*{res}\nolimits_{4}\left(
\operatorname*{res}\nolimits_{2}T\right)  \right)  \right)  \right)  \right)
=%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& 1 & 2 & 2 \\
%\none& 1 & 1 & 2 \\
%1 & 1 & 1 \\
%1 & 1 & 2 \\
%1
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& 1 & 2 & 2 \\
\none& 1 & 1 & 2 \\
1 & 1 & 1 \\
1 & 1 & 2 \\
1
\end{ytableau}%
%EndExpansion
.
\]
This 12-table $\operatorname*{res}\nolimits_{2}\left(  \operatorname*{res}%
\nolimits_{3}\left(  \operatorname*{res}\nolimits_{2}\left(
\operatorname*{res}\nolimits_{1}\left(  \operatorname*{res}\nolimits_{4}%
\left(  \operatorname*{res}\nolimits_{2}T\right)  \right)  \right)  \right)
\right)  $ has no more conflicts, and thus is final. So $\operatorname*{norm}%
\left(  T\right)  =\operatorname*{res}\nolimits_{2}\left(  \operatorname*{res}%
\nolimits_{3}\left(  \operatorname*{res}\nolimits_{2}\left(
\operatorname*{res}\nolimits_{1}\left(  \operatorname*{res}\nolimits_{4}%
\left(  \operatorname*{res}\nolimits_{2}T\right)  \right)  \right)  \right)
\right)  $.

Notice that we have needed six steps to compute $\operatorname*{norm}\left(
T\right)  $, although $T$ only had $4$ conflicts. So the number of conflicts
does not always decrease when we resolve a conflict. (It is easy to construct
an example where it can actually increase.) This is why we could not have used
a function $\ell:\mathbf{S}\rightarrow\mathbb{N}$ that counts the number of
conflicts to satisfy the length-decrease condition.
\end{example}

\subsection{Definition of $\mathbf{B}$}

We can now finally prove Lemma \ref{lem.BK}. Indeed, let us define a map
$\mathbf{B}:\mathbf{R}\rightarrow\mathbf{R}$ as follows:

Let $T\in\mathbf{R}$. Then, $T\in\mathbf{R}\subseteq\mathbf{S}$. Hence,
$\operatorname*{flip}\left(  T\right)  \in\mathbf{S}$ is well-defined, and
thus $\operatorname*{norm}\left(  \operatorname*{flip}\left(  T\right)
\right)  \in\mathbf{R}$ is well-defined. We define $\mathbf{B}\left(
T\right)  $ to be $\operatorname*{norm}\left(  \operatorname*{flip}\left(
T\right)  \right)  $.

Thus, the map $\mathbf{B}$ is defined. In order to complete the proof of Lemma
\ref{lem.BK}, we need to show that this map $\mathbf{B}$ is an involution and
that, for every $S\in\mathbf{R}$, the equalities (\ref{eq.lem.BK.ceq}) and
(\ref{eq.lem.BK.ircont}) hold. This all is easy by now:

\textit{Proof that }$\mathbf{B}$ \textit{is an involution:} Let $T\in
\mathbf{R}$. The definition of $\mathbf{B}$ yields $\mathbf{B}\left(
T\right)  =\operatorname*{norm}\left(  \operatorname*{flip}\left(  T\right)
\right)  $. From (\ref{pf.lem.BK.norm.=>}) (applied to $\operatorname*{flip}%
\left(  T\right)  $ instead of $T$), we have $\operatorname*{flip}\left(
T\right)  \overset{\ast}{\Rrightarrow}\operatorname*{norm}\left(
\operatorname*{flip}\left(  T\right)  \right)  $. This rewrites as
$\operatorname*{flip}\left(  T\right)  \overset{\ast}{\Rrightarrow}%
\mathbf{B}\left(  T\right)  $ (since $\mathbf{B}\left(  T\right)
=\operatorname*{norm}\left(  \operatorname*{flip}\left(  T\right)  \right)
$). Lemma \ref{lem.conflict-resolution-*props} \textbf{(c)} (applied to
$P=\operatorname*{flip}\left(  T\right)  $ and $Q=\mathbf{B}\left(  T\right)
$) thus yields $\operatorname*{flip}\left(  \mathbf{B}\left(  T\right)
\right)  \overset{\ast}{\Rrightarrow}\operatorname*{flip}\left(
\operatorname*{flip}T\right)  $. Since $\operatorname*{flip}\left(
\operatorname*{flip}T\right)  =\underbrace{\left(  \operatorname*{flip}%
\circ\operatorname*{flip}\right)  }_{\substack{=\operatorname*{id}\\\text{(by
Proposition \ref{prop.flip} \textbf{(a)})}}}\left(  T\right)
=\operatorname*{id}\left(  T\right)  =T$, this rewrites as
$\operatorname*{flip}\left(  \mathbf{B}\left(  T\right)  \right)
\overset{\ast}{\Rrightarrow}T$.

But $T\in\mathbf{R}$. In other words, $T$ is a 12-rpp (since $\mathbf{R}$ is
the set of all 12-rpps of shape $Z$). Thus, $T$ is final (because Proposition
\ref{prop.finality} (applied to $P=T$) yields that $T$ is final if and only if
$T$ is a 12-rpp).

Now, recall that $\operatorname*{norm}\left(  T\right)  $ is the unique final
element $b\in\mathbf{S}$ such that $T\overset{\ast}{\Rrightarrow}b$ (by the
definition of $\operatorname*{norm}\left(  T\right)  $). Applying this to
$\operatorname*{flip}\left(  \mathbf{B}\left(  T\right)  \right)  $ instead of
$T$, we see that $\operatorname*{norm}\left(  \operatorname*{flip}\left(
\mathbf{B}\left(  T\right)  \right)  \right)  $ is the unique final element
$b\in\mathbf{S}$ such that $\operatorname*{flip}\left(  \mathbf{B}\left(
T\right)  \right)  \overset{\ast}{\Rrightarrow}b$. Hence, every final element
$b\in\mathbf{S}$ such that $\operatorname*{flip}\left(  \mathbf{B}\left(
T\right)  \right)  \overset{\ast}{\Rrightarrow}b$ must satisfy
$b=\operatorname*{norm}\left(  \operatorname*{flip}\left(  \mathbf{B}\left(
T\right)  \right)  \right)  $. Applying this to $b=T$, we obtain
$T=\operatorname*{norm}\left(  \operatorname*{flip}\left(  \mathbf{B}\left(
T\right)  \right)  \right)  $ (since $T$ is a final element of $\mathbf{S}$
satisfying $\operatorname*{flip}\left(  \mathbf{B}\left(  T\right)  \right)
\overset{\ast}{\Rrightarrow}T$).

But $\left(  \mathbf{B}\circ\mathbf{B}\right)  \left(  T\right)
=\mathbf{B}\left(  \mathbf{B}\left(  T\right)  \right)  =\operatorname*{norm}%
\left(  \operatorname*{flip}\left(  \mathbf{B}\left(  T\right)  \right)
\right)  $ (by the definition of $\mathbf{B}\left(  \mathbf{B}\left(
T\right)  \right)  $). Comparing this with $T=\operatorname*{norm}\left(
\operatorname*{flip}\left(  \mathbf{B}\left(  T\right)  \right)  \right)  $,
we obtain $\left(  \mathbf{B}\circ\mathbf{B}\right)  \left(  T\right)  =T$.

Let us now forget that we fixed $T$. We thus have shown that $\left(
\mathbf{B}\circ\mathbf{B}\right)  \left(  T\right)  =T$ for every
$T\in\mathbf{S}$. In other words, $\mathbf{B}\circ\mathbf{B}%
=\operatorname*{id}$. In other words, $\mathbf{B}$ is an involution.

\textit{Proof of the equality (\ref{eq.lem.BK.ceq}) for every }$S\in
\mathbf{R}$\textit{:} Let $S\in\mathbf{R}$. The definition of $\mathbf{B}$
yields $\mathbf{B}\left(  S\right)  =\operatorname*{norm}\left(
\operatorname*{flip}\left(  S\right)  \right)  $. But (\ref{pf.lem.BK.norm.=>}%
) (applied to $T=\operatorname*{flip}\left(  S\right)  $) yields
$\operatorname*{flip}\left(  S\right)  \overset{\ast}{\Rrightarrow
}\operatorname*{norm}\left(  \operatorname*{flip}\left(  S\right)  \right)  $.
This rewrites as $\operatorname*{flip}\left(  S\right)  \overset{\ast
}{\Rrightarrow}\mathbf{B}\left(  S\right)  $ (since $\mathbf{B}\left(
S\right)  =\operatorname*{norm}\left(  \operatorname*{flip}\left(  S\right)
\right)  $). Lemma \ref{lem.conflict-resolution-*props} \textbf{(a)} (applied
to $P=\operatorname*{flip}\left(  S\right)  $ and $Q=\mathbf{B}\left(
S\right)  $) thus yields
\[
\operatorname*{ceq}\left(  \mathbf{B}\left(  S\right)  \right)
=\operatorname*{ceq}\left(  \operatorname*{flip}\left(  S\right)  \right)
=\operatorname*{ceq}\left(  S\right)
\]
(by (\ref{pf.lem.BK.flip.ceq}), applied to $T=S$). This proves
(\ref{eq.lem.BK.ceq}).

\textit{Proof of the equality (\ref{eq.lem.BK.ircont}) for every }%
$S\in\mathbf{R}$\textit{:} Let $S\in\mathbf{R}$. The definition of
$\mathbf{B}$ yields $\mathbf{B}\left(  S\right)  =\operatorname*{norm}\left(
\operatorname*{flip}\left(  S\right)  \right)  $. But (\ref{pf.lem.BK.norm.=>}%
) (applied to $T=\operatorname*{flip}\left(  S\right)  $) yields
$\operatorname*{flip}\left(  S\right)  \overset{\ast}{\Rrightarrow
}\operatorname*{norm}\left(  \operatorname*{flip}\left(  S\right)  \right)  $.
This rewrites as $\operatorname*{flip}\left(  S\right)  \overset{\ast
}{\Rrightarrow}\mathbf{B}\left(  S\right)  $ (since $\mathbf{B}\left(
S\right)  =\operatorname*{norm}\left(  \operatorname*{flip}\left(  S\right)
\right)  $). Lemma \ref{lem.conflict-resolution-*props} \textbf{(b)} (applied
to $P=\operatorname*{flip}\left(  S\right)  $ and $Q=\mathbf{B}\left(
S\right)  $) thus yields
\[
\operatorname*{ircont}\left(  \mathbf{B}\left(  S\right)  \right)
=\operatorname*{ircont}\left(  \operatorname*{flip}\left(  S\right)  \right)
=s_{1}\cdot\operatorname*{ircont}\left(  S\right)
\]
(by (\ref{pf.lem.BK.flip.ircont}), applied to $T=S$). This proves
(\ref{eq.lem.BK.ircont}).

We have thus shown that $\mathbf{B}$ is an involution, and that, for every
$S\in\mathbf{R}$, the equalities (\ref{eq.lem.BK.ceq}) and
(\ref{eq.lem.BK.ircont}) hold. This completes the proof of Lemma \ref{lem.BK}.
Thus, Lemma \ref{lem.BKi} is proven (since we have proven it using Lemma
\ref{lem.BK}), and consequently Theorem \ref{thm.BK} is proven (since we have
derived it from Lemma \ref{lem.BKi}). This, in turn, finishes the proof of
Theorem \ref{thm.gtilde.symm} (since we have proven Theorem
\ref{thm.gtilde.symm} using Theorem \ref{thm.BK}).

\begin{todo}
This argument reminds me of partially commutative monoids and heaps. Maybe
they have something to do with it?
\end{todo}

\section{\label{sect.BKclassical}The classical Bender-Knuth involutions}

\subsection{Recalling the definition of $\mathbf{B}_{i}$}

We fix a skew partition $\lambda/\mu$ and a positive integer $i$ for the whole
Section \ref{sect.BKclassical}.

Theorem \ref{thm.BK} merely claims the existence of an involution
$\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda/\mu\right)  \rightarrow
\operatorname*{RPP}\left(  \lambda/\mu\right)  $ satisfying certain
properties. Such an involution, per se, needs not be unique. However, if we
trace back the proof of Theorem \ref{thm.BK} (and the proofs of the lemmas
that were used in this proof), we notice that this proof constructs a specific
involution $\mathbf{B}_{i}$. This construction is spread across various
proofs; we can summarize it as follows:

\begin{itemize}
\item The main step of the construction was the construction of the involution
$\mathbf{B}:\mathbf{R}\rightarrow\mathbf{R}$ in Lemma \ref{lem.BK} (for a
given finite convex subset $Z$ of $\mathbb{N}_{+}$). This is an involution
which sends 12-rpps of shape $Z$ to 12-rpps of the same shape $Z$, and it was
constructed as follows: Given a 12-rpp $T$ of shape $Z$, we set $\mathbf{B}%
\left(  T\right)  =\operatorname*{norm}\left(  \operatorname*{flip}\left(
T\right)  \right)  $. (Recall that $\operatorname*{flip}\left(  T\right)  $
fills all the 1-pure columns of $T$ with $2$'s while simultaneously filling
all the 2-pure columns of $T$ with $1$'s. Recall furthermore that
$\operatorname*{norm}\left(  \operatorname*{flip}\left(  T\right)  \right)  $
is obtained from $\operatorname*{flip}\left(  T\right)  $ by repeatedly
resolving conflicts until no conflicts remain.)

\item Having constructed this map $\mathbf{B}:\mathbf{R}\rightarrow\mathbf{R}%
$, we can construct the involution $\mathbf{B}_{Z}:\mathbf{R}_{Z}%
\rightarrow\mathbf{R}_{Z}$ in Lemma \ref{lem.BKi} (for a given finite convex
subset $Z$ of $\mathbb{N}_{+}$) as follows: Given an rpp $S$ of shape $Z$
whose entries are $i$'s and $\left(  i+1\right)  $'s, we first replace these
entries by $1$'s and $2$'s (respectively), so that we obtain a 12-rpp; then,
we apply the involution $\mathbf{B}:\mathbf{R}\rightarrow\mathbf{R}$ to this
12-rpp; and then, in the resulting 12-rpp, we change the $1$'s and $2$'s back
into $i$'s and $\left(  i+1\right)  $'s. The resulting rpp is $\mathbf{B}%
_{Z}\left(  S\right)  $.

\item Finally, we can construct the involution $\mathbf{B}_{i}%
:\operatorname*{RPP}\left(  \lambda/\mu\right)  \rightarrow\operatorname*{RPP}%
\left(  \lambda/\mu\right)  $. To wit, if we are given an rpp $S\in
\operatorname*{RPP}\left(  \lambda/\mu\right)  $, then we can restrict our
attention to the cells of $S$ which contain the entries $i$ and $i+1$. These
cells form an rpp of some shape $Z$. We then apply the involution
$\mathbf{B}_{Z}$ to this new rpp, while leaving all the remaining entries of
$S$ unchanged. The result is an rpp of shape $Y\left(  \lambda/\mu\right)  $
again; this rpp is $\mathbf{B}_{i}\left(  S\right)  $.
\end{itemize}

In the following, whenever we will be talking about the involution
$\mathbf{B}_{i}$, we will always mean this particular involution
$\mathbf{B}_{i}$, rather than an arbitrary involution $\mathbf{B}_{i}$ which
satisfies the claims of Theorem \ref{thm.BK}.

\subsection{The Bender-Knuth involutions}

We claimed that our involution $\mathbf{B}_{i}:\operatorname*{RPP}\left(
\lambda/\mu\right)  \rightarrow\operatorname*{RPP}\left(  \lambda/\mu\right)
$ is a generalization of the $i$-th Bender-Knuth involution defined for
semistandard tableaux. Let us now elaborate on this claim. First, we shall
define the $i$-th Bender-Knuth involution (following \cite[proof of
Proposition 2.11]{GriRei15} and \cite[proof of Theorem 7.10.2]{Stan99}).

Let $\operatorname*{SST}\left(  \lambda/\mu\right)  $ denote the set of all
semistandard tableaux of shape $Y\left(  \lambda/\mu\right)  $. We define a
map $B_{i}:\operatorname*{SST}\left(  \lambda/\mu\right)  \rightarrow
\operatorname*{SST}\left(  \lambda/\mu\right)  $ as follows:\footnote{We refer
to Example \ref{exa.BKclassical} below for illustration.}

Let $T\in\operatorname*{SST}\left(  \lambda/\mu\right)  $. Then, $T$ is a
semistandard tableau, so that every column of $T$ contains at most one $i$ and
at most one $i+1$. We shall ignore all columns of $T$ which contain both an
$i$ and an $i+1$; that is, we mark all the entries of all such columns as
\textquotedblleft ignored\textquotedblright. Now, let $k\in\mathbb{N}_{+}$.
The $k$-th row of $T$ is a weakly increasing sequence of positive integers;
thus, it contains a (possibly empty) string of $i$'s followed by a (possibly
empty) string of $\left(  i+1\right)  $'s. These two strings together form a
substring of the $k$-th row which looks as follows:%
\[
\left(  i,i,\ldots,i,i+1,i+1,\ldots,i+1\right)
\]
\footnote{Of course, this might contain no $i$'s or no $\left(  i+1\right)
$'s.}. Some of the entries of this substring are \textquotedblleft
ignored\textquotedblright; it is easy to see that the \textquotedblleft
ignored\textquotedblright\ $i$'s are gathered at the left end of the substring
whereas the \textquotedblleft ignored\textquotedblright\ $\left(  i+1\right)
$'s are gathered end of the substring. So the substring looks as follows:%
\[
\left(  \underbrace{i,i,\ldots,i}_{\substack{a\text{ many }i\text{'s
which}\\\text{are \textquotedblleft ignored\textquotedblright}}%
},\underbrace{i,i,\ldots,i}_{\substack{r\text{ many }i\text{'s which}%
\\\text{are not \textquotedblleft ignored\textquotedblright}}%
},\underbrace{i+1,i+1,\ldots,i+1}_{\substack{s\text{ many }\left(  i+1\right)
\text{'s which}\\\text{are not \textquotedblleft ignored\textquotedblright}%
}},\underbrace{i+1,i+1,\ldots,i+1}_{\substack{b\text{ many }\left(
i+1\right)  \text{'s which}\\\text{are not \textquotedblleft
ignored\textquotedblright}}}\right)
\]
for some $a,r,s,b\in\mathbb{N}$. Now, we change this substring into%
\[
\left(  \underbrace{i,i,\ldots,i}_{\substack{a\text{ many }i\text{'s
which}\\\text{are \textquotedblleft ignored\textquotedblright}}%
},\underbrace{i,i,\ldots,i}_{\substack{s\text{ many }i\text{'s which}%
\\\text{are not \textquotedblleft ignored\textquotedblright}}%
},\underbrace{i+1,i+1,\ldots,i+1}_{\substack{r\text{ many }\left(  i+1\right)
\text{'s which}\\\text{are not \textquotedblleft ignored\textquotedblright}%
}},\underbrace{i+1,i+1,\ldots,i+1}_{\substack{b\text{ many }\left(
i+1\right)  \text{'s which}\\\text{are not \textquotedblleft
ignored\textquotedblright}}}\right)  .
\]
And we do this for every $k\in\mathbb{N}_{+}$ (simultaneously or consecutively
-- it does not matter). At the end, we have obtained a new semistandard
tableau of shape $Y\left(  \lambda/\mu\right)  $. We define $B_{i}\left(
T\right)  $ to be this new tableau.

\begin{example}
\label{exa.BKclassical}Let us give an example of this construction of $B_{i}$.
Namely, let $i=2$, let $\lambda=\left(  7,6,4,1\right)  $, and let
$\mu=\left(  3\right)  $. Let $T$ be the semistandard tableau%
\[%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& 1 & 1 & 2 & 2 \\
%1 & 2 & 2 & 2 & 3 & 3 \\
%3 & 3 & 5 & 6 \\
%4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& 1 & 1 & 2 & 2 \\
1 & 2 & 2 & 2 & 3 & 3 \\
3 & 3 & 5 & 6 \\
4
\end{ytableau}%
%EndExpansion
\]
of shape $Y\left(  \lambda/\mu\right)  $. We want to find $B_{i}\left(
T\right)  $.

The columns that contain both an $i$ and an $i+1$ (that is, both a $2$ and a
$3$) are the second and the sixth columns. So we mark all entries of these two
columns as \textquotedblleft ignored\textquotedblright. Now, the substring of
the $2$-nd row of $T$ formed by the $i$'s and the $\left(  i+1\right)  $'s
looks as follows:%
\[
\left(  \underbrace{2}_{\substack{1\text{ many }2\text{'s which}\\\text{are
\textquotedblleft ignored\textquotedblright}}},\underbrace{2,2}%
_{\substack{2\text{ many }2\text{'s which}\\\text{are not \textquotedblleft
ignored\textquotedblright}}},\underbrace{3}_{\substack{1\text{ many }3\text{'s
which}\\\text{are not \textquotedblleft ignored\textquotedblright}%
}},\underbrace{3}_{\substack{2\text{ many }3\text{'s which}\\\text{are not
\textquotedblleft ignored\textquotedblright}}}\right)  .
\]
So we change it into%
\[
\left(  \underbrace{2}_{\substack{1\text{ many }2\text{'s which}\\\text{are
\textquotedblleft ignored\textquotedblright}}},\underbrace{2}%
_{\substack{1\text{ many }2\text{'s which}\\\text{are not \textquotedblleft
ignored\textquotedblright}}},\underbrace{3,3}_{\substack{2\text{ many
}3\text{'s which}\\\text{are not \textquotedblleft ignored\textquotedblright}%
}},\underbrace{3}_{\substack{2\text{ many }3\text{'s which}\\\text{are not
\textquotedblleft ignored\textquotedblright}}}\right)  .
\]
Similarly, we change the substring $\left(  2,2\right)  $ of the $1$-st row of
$T$ into $\left(  2,3\right)  $ (because its first $2$ is \textquotedblleft
ignored\textquotedblright\ but its second $2$ is not), and we change the
substring $\left(  3,3\right)  $ of the $3$-rd row of $T$ into $\left(
2,3\right)  $ (because its first $3$ is not \textquotedblleft
ignored\textquotedblright\ but its second $3$ is). The substring of the $4$-th
row, of the $5$-th row, of the $6$-th row, etc., formed by the $i$'s and
$\left(  i+1\right)  $'s are empty (because these rows have neither $i$'s nor
$\left(  i+1\right)  $'s), and thus we do not make any changes on them. Now,
$B_{i}\left(  T\right)  $ is defined to be the tableau that results from all
of these changes; thus,%
\[
B_{i}\left(  T\right)  =%
%TCIMACRO{\TeXButton{Y}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& 1 & 1 & 2 & 3 \\
%1 & 2 & 2 & 3 & 3 & 3 \\
%2 & 3 & 5 & 6 \\
%4
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& 1 & 1 & 2 & 3 \\
1 & 2 & 2 & 3 & 3 & 3 \\
2 & 3 & 5 & 6 \\
4
\end{ytableau}%
%EndExpansion
.
\]

\end{example}

\begin{proposition}
\label{prop.BKclassical}The map $B_{i}:\operatorname*{SST}\left(  \lambda
/\mu\right)  \rightarrow\operatorname*{SST}\left(  \lambda/\mu\right)  $ thus
defined is an involution. It is known as the $i$\textit{-th Bender-Knuth
involution}.
\end{proposition}

Proposition \ref{prop.BKclassical} is easy to prove (and is usually proven in
less or more detail everywhere the map $B_{i}$ is defined).

Now, every semistandard tableau of shape $Y\left(  \lambda/\mu\right)  $ is
also an rpp of shape $Y\left(  \lambda/\mu\right)  $. In other words,
$\operatorname*{SST}\left(  \lambda/\mu\right)  \subseteq\operatorname*{RPP}%
\left(  \lambda/\mu\right)  $. Hence, $\mathbf{B}_{i}\left(  T\right)  $ is
defined for every $T\in\operatorname*{SST}\left(  \lambda/\mu\right)  $. Now,
the claim that we want to make (that our involution $\mathbf{B}_{i}$ is a
generalization of the $i$-th Bender-Knuth involution $B_{i}$) can be stated as follows:

\begin{proposition}
\label{prop.BK=BK}For every $T\in\operatorname*{SST}\left(  \lambda
/\mu\right)  $, we have $B_{i}\left(  T\right)  =\mathbf{B}_{i}\left(
T\right)  $.
\end{proposition}

\begin{proof}
[Proof of Proposition \ref{prop.BK=BK} (sketched).]We shall abbreviate
\textquotedblleft semistandard tableau\textquotedblright\ as \textquotedblleft
sst\textquotedblright. We define a \textit{12-sst} to be an sst whose entries
all belong to the set $\left\{  1,2\right\}  $.

Let $Z$ be a finite convex subset of $\mathbb{N}_{+}^{2}$. Let $R$ denote the
set of all 12-ssts of shape $Z$. We define a map $B:R\rightarrow R$ in the
same way as we defined the map $B_{i}:\operatorname*{SST}\left(  \lambda
/\mu\right)  \rightarrow\operatorname*{SST}\left(  \lambda/\mu\right)  $, with
the only differences that we replace every appearance of \textquotedblleft%
$\operatorname*{SST}\left(  \lambda/\mu\right)  $\textquotedblright, of
\textquotedblleft$i$\textquotedblright\ and of \textquotedblleft%
$i+1$\textquotedblright\ by \textquotedblleft$R$\textquotedblright,
\textquotedblleft$1$\textquotedblright\ and \textquotedblleft$2$%
\textquotedblright, respectively. Then, this map $B:R\rightarrow R$ is an involution.

Now let us forget that we fixed $Z$. We thus have constructed a map
$B:R\rightarrow R$ for every finite convex subset $Z$ of $\mathbb{N}_{+}^{2}$.
Now, recall how the map $\mathbf{B}_{i}:\operatorname*{RPP}\left(  \lambda
/\mu\right)  \rightarrow\operatorname*{RPP}\left(  \lambda/\mu\right)  $ was
constructed from the maps $\mathbf{B}:\mathbf{R}\rightarrow\mathbf{R}$ for
every finite convex subset $Z$ of $\mathbb{N}_{+}^{2}$ (essentially by
forgetting all entries of an rpp except for the entries $i$ and $i+1$ and
relabelling these entries $i$ and $i+1$ as $1$ and $2$). Similarly, the map
$B_{i}:\operatorname*{SST}\left(  \lambda/\mu\right)  \rightarrow
\operatorname*{SST}\left(  \lambda/\mu\right)  $ can be constructed from the
maps $B:R\rightarrow R$ for every finite convex subset $Z$ of $\mathbb{N}%
_{+}^{2}$ (essentially by forgetting all entries of an rpp except for the
entries $i$ and $i+1$ and relabelling these entries $i$ and $i+1$ as $1$ and
$2$). Thus, in order to prove that $B_{i}\left(  T\right)  =\mathbf{B}%
_{i}\left(  T\right)  $ for every $T\in\operatorname*{SST}\left(  \lambda
/\mu\right)  $, it suffices to show that $B\left(  T\right)  =\mathbf{B}%
\left(  T\right)  $ for every finite convex subset $Z$ of $\mathbb{N}_{+}^{2}$
and any 12-sst $T$ of shape $Z$.

\begin{todo}
Is this readable?
\end{todo}

So let $Z$ be any finite convex subset of $\mathbb{N}_{+}^{2}$, and let $T$ be
a 12-sst of shape $Z$. We need to prove that $B\left(  T\right)
=\mathbf{B}\left(  T\right)  $.

\begin{example}
Here is an example of a 12-sst:%
\begin{equation}
T=%
%TCIMACRO{\TeXButton{ytableau}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& \none& \none& \none& \none& 1 \\
%\none& \none& \none& \none& \none& 1 & 1 & 2 \\
%\none& \none& \none& 1 & 2 & 2 & 2 \\
%1 & 2 \\
%2
%\end{ytableau}
%}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& \none& \none& \none& \none& 1 \\
\none& \none& \none& \none& \none& 1 & 1 & 2 \\
\none& \none& \none& 1 & 2 & 2 & 2 \\
1 & 2 \\
2
\end{ytableau}
%EndExpansion
.\label{pf.prop.BK=BK.exampleT}%
\end{equation}
It satisfies%
\begin{equation}
B\left(  T\right)  =%
%TCIMACRO{\TeXButton{ytableau}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& \none& \none& \none& \none& 1 \\
%\none& \none& \none& \none& \none& 1 & 2 & 2 \\
%\none& \none& \none& 1 & 1 & 2 & 2 \\
%1 & 1 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& \none& \none& \none& \none& 1 \\
\none& \none& \none& \none& \none& 1 & 2 & 2 \\
\none& \none& \none& 1 & 1 & 2 & 2 \\
1 & 1 \\
2
\end{ytableau}%
%EndExpansion
\label{pf.prop.BK=BK.exampleBT}%
\end{equation}
and%
\begin{equation}
\operatorname*{flip}\left(  T\right)  =%
%TCIMACRO{\TeXButton{ytableau}{\ytableausetup{notabloids}
%\begin{ytableau}
%\none& \none& \none& \none& \none& \none& \none& \none& 1 \\
%\none& \none& \none& \none& \none& 1 & 2 & 2 \\
%\none& \none& \none& 2 & 1 & 1 & 2 \\
%1 & 1 \\
%2
%\end{ytableau}}}%
%BeginExpansion
\ytableausetup{notabloids}
\begin{ytableau}
\none& \none& \none& \none& \none& \none& \none& \none& 1 \\
\none& \none& \none& \none& \none& 1 & 2 & 2 \\
\none& \none& \none& 2 & 1 & 1 & 2 \\
1 & 1 \\
2
\end{ytableau}%
%EndExpansion
\label{pf.prop.BK=BK.exampleflipT}%
\end{equation}
(where $\operatorname*{flip}\left(  T\right)  $ is defined as in the
construction of $\mathbf{B}\left(  T\right)  $).
\end{example}

We make a few basic observations: The columns which are ignored in the
construction of $B\left(  T\right)  $ are the columns which contain both a $1$
and a $2$.\ \ \ \ \footnote{For instance, in the 12-sst
(\ref{pf.prop.BK=BK.exampleT}), the ignored columns are the $1$-st, the $7$-th
and the $9$-th columns.} These columns contain exactly two entries each
(because a column of a 12-sst can only contain at most one $1$, at most one
$2$ and no other entries), while every other column is either empty or
contains only one entry. As a consequence, every entry of $T$ which is not
\textquotedblleft ignored\textquotedblright\ in the construction of $B\left(
T\right)  $ is alone in its column.

Let us compare the basic ideas of the constructions of $B\left(  T\right)  $
and $\mathbf{B}\left(  T\right)  $:

\begin{itemize}
\item To construct $B\left(  T\right)  $, we ignore all columns of $T$ which
contain both a $1$ and a $2$; that is, we mark all entries in these columns as
\textquotedblleft ignored\textquotedblright. Then, in every row, we let $r$ be
the number of $1$'s which are not \textquotedblleft ignored\textquotedblright,
and let $s$ be the number of $2$'s which are not \textquotedblleft
ignored\textquotedblright. We replace these $r$ many $1$'s and $s$ many $2$'s
by $s$ many $1$'s and $r$ many $2$'s. This we do for every row; the resulting
12-sst is $B\left(  T\right)  $.

\item To construct $\mathbf{B}\left(  T\right)  $, we consider $T$ as a
12-rpp, and we identify which of its columns are 1-pure, which are 2-pure and
which are mixed. Then, we replace all entries of all 1-pure columns by $1$'s,
while simultaneously replacing all entries of all 2-pure columns by $2$'s. The
resulting 12-table is denoted $\operatorname*{flip}\left(  T\right)  $. Then,
we repeatedly resolve conflicts in $\operatorname*{flip}\left(  T\right)  $
until no more conflicts remain. The resulting 12-table $\operatorname*{norm}%
\left(  \operatorname*{flip}\left(  T\right)  \right)  $ is a 12-rpp, and is
denoted $\mathbf{B}\left(  T\right)  $.
\end{itemize}

If we compare the two constructions just described, we first notice that the
columns ignored in the construction of $B\left(  T\right)  $ are precisely the
mixed columns of $T$. Thus, the 12-table $\operatorname*{flip}\left(
T\right)  $ can be obtained from $T$ by replacing all $1$'s which are not
\textquotedblleft ignored\textquotedblright\ by $2$'s while simultaneously
replacing all $2$'s which are not \textquotedblleft ignored\textquotedblright%
\ by $1$'s. Thus, for any given $r\in\mathbb{N}_{+}$, if the $r$-th row of $T$
contains $r$ many $1$'s which are not \textquotedblleft
ignored\textquotedblright\ and $s$ many $2$'s which are not \textquotedblleft
ignored\textquotedblright, then the $r$-th row of $\operatorname*{flip}\left(
T\right)  $ contains $r$ many $2$'s which are not \textquotedblleft
ignored\textquotedblright\ and $s$ many $1$'s which are not \textquotedblleft
ignored\textquotedblright\ (while the \textquotedblleft
ignored\textquotedblright\ entries in $T$ appear in $\operatorname*{flip}%
\left(  T\right)  $ unchanged). So we can restate the construction of
$\operatorname*{flip}\left(  T\right)  $ as follows:

To construct $\operatorname*{flip}\left(  T\right)  $ from $T$, do the
following: In every row of $T$, let $r$ be the number of $1$'s which are not
\textquotedblleft ignored\textquotedblright, and let $s$ be the number of
$2$'s which are not \textquotedblleft ignored\textquotedblright. We replace
these $r$ many $1$'s and $s$ many $2$'s by $r$ many $2$'s and $s$ many $1$'s
(in this order). This we do for every row; the resulting 12-table is
$\operatorname*{flip}\left(  T\right)  $.

Compare this to our construction of $B\left(  T\right)  $:

To construct $B\left(  T\right)  $ from $T$, do the following: In every row of
$T$, let $r$ be the number of $1$'s which are not \textquotedblleft
ignored\textquotedblright, and let $s$ be the number of $2$'s which are not
\textquotedblleft ignored\textquotedblright. We replace these $r$ many $1$'s
and $s$ many $2$'s by $s$ many $1$'s and $r$ many $2$'s (in this order). This
we do for every row; the resulting 12-sst is $B\left(  T\right)  $.

Comparing these two constructions makes it clear that each row of $B\left(
T\right)  $ differs from the corresponding row of $\operatorname*{flip}\left(
T\right)  $ merely in the order in which the non-\textquotedblleft
ignored\textquotedblright\ entries appear: In $B\left(  T\right)  $, the
non-\textquotedblleft ignored\textquotedblright\ $1$'s appear before the
non-\textquotedblleft ignored\textquotedblright\ $2$'s (as they must,
$B\left(  T\right)  $ being an sst), whereas in $\operatorname*{flip}\left(
T\right)  $ they appear in the opposite order. Hence, $B\left(  T\right)  $
can be obtained from $\operatorname*{flip}\left(  T\right)  $ by sorting all
non-\textquotedblleft ignored\textquotedblright\ entries into increasing order
in each row.

Now, let us notice that every pair of a non-\textquotedblleft
ignored\textquotedblright\ $2$ and a non-\textquotedblleft
ignored\textquotedblright\ $1$ lying in the same row of $\operatorname*{flip}%
\left(  T\right)  $ cause a conflict\footnote{More precisely: If
$r\in\mathbb{N}_{+}$, $i\in\mathbb{N}_{+}$ and $j\in\mathbb{N}_{+}$ are such
that $\left(  \operatorname*{flip}T\right)  \left(  r,i\right)  $ is a
non-\textquotedblleft ignored\textquotedblright\ $2$ and that $\left(
\operatorname*{flip}T\right)  \left(  r,j\right)  $ is a non-\textquotedblleft
ignored\textquotedblright\ $1$, then $\left(  i,j\right)  $ is a conflict of
$\operatorname*{flip}T$.}. Conversely, all conflicts of $\operatorname*{flip}%
\left(  T\right)  $ are caused by a non-\textquotedblleft
ignored\textquotedblright\ $2$ and a non-\textquotedblleft
ignored\textquotedblright\ $1$ lying in the same row (because all
\textquotedblleft ignored\textquotedblright\ entries are carried over from $T$
without change and thus cannot take part in conflicts). We can resolve these
conflicts one after the other (starting with the $2$ and the $1$ that are
adjacent to each other), until none are left. The result is a 12-rpp. What is
this 12-rpp?

\begin{itemize}
\item On the one hand, this 12-rpp is $\operatorname*{norm}\left(
\operatorname*{flip}\left(  T\right)  \right)  $, because
$\operatorname*{norm}\left(  \operatorname*{flip}\left(  T\right)  \right)  $
is defined as what results when all conflicts of $\operatorname*{flip}\left(
T\right)  $ are resolved.

\item On the other hand, this 12-rpp is $B\left(  T\right)  $. In fact,
resolving a conflict caused by a non-\textquotedblleft
ignored\textquotedblright\ $2$ and a non-\textquotedblleft
ignored\textquotedblright\ $1$ lying in the same row results in this $2$
getting switched with the $1$ (while no other entries get moved\footnote{This
is because every non-\textquotedblleft ignored\textquotedblright\ entry is
alone in its column.}). Hence, when we resolve the conflicts, we just sort all
non-\textquotedblleft ignored\textquotedblright\ entries into increasing order
in each row. But as we know, the 12-table obtained from $\operatorname*{flip}%
\left(  T\right)  $ by sorting all non-\textquotedblleft
ignored\textquotedblright\ entries into increasing order in each row is
$B\left(  T\right)  $.
\end{itemize}

So we have found a 12-rpp which equals both $\operatorname*{norm}\left(
\operatorname*{flip}\left(  T\right)  \right)  $ and $B\left(  T\right)  $.
Thus, $B\left(  T\right)  =\operatorname*{norm}\left(  \operatorname*{flip}%
\left(  T\right)  \right)  =\mathbf{B}\left(  T\right)  $. This completes our
proof of Proposition \ref{prop.BK=BK}.
\end{proof}

\begin{todo}
Prove this (well, sketch a proof).
\end{todo}



\section{The structure of 12-rpps}
\def\cut{{\operatorname*{cut}}} % what would be a good notation here? same question for the below:
\def\ceq{{\operatorname*{ceq}}}
\def\ircont{{\operatorname*{ircont}}}
\def\ceqvar{{{ceq}}} %??
\def\cutvar{{{\nu}}} % ???
\def\supp{{\operatorname*{supp}}}
\def\NS{{\operatorname*{NS}}}
\def\g{{\widetilde{g}}}
\def\t{{\mathbf{t}}}
\def\lm{{\lambda/\mu}}
\def\lmp{{(\lambda/\mu)}}
\def\N{{\mathbb{N}}}
\def\Z{\mathbb{Z}}

\def\OneTwoRPP{{\operatorname*{RPP}^{12}\left(  \lambda/\mu\right)}}
\def\OneTwoRPPCutvar{{\operatorname*{RPP}^{12}\left(  \lambda/\mu ;\cutvar \right)}}
\def\flip{{\operatorname*{flip}}}

In this section, we restrict ourselves to the two-variable dual-stable Grothendieck polynomial $\g_\lm(x_1,x_2,0,0,\dots;\t)$. We can represent it as a polynomial in $\t$ with coefficients in $\Z[x_1,x_2]$:
$$\g_\lm(x_1,x_2,0,0,\dots;\t)=\sum_{\ceqvar\in \N^{\N_+}}\t^\ceqvar Q_\ceqvar(x_1,x_2).$$
We show that each $Q_\ceqvar(x_1,x_2)$ is either zero or has a form
$$Q_\ceqvar(x_1,x_2)=(x_1x_2)^{M} P_{n_0}(x_1,x_2)P_{n_1}(x_1,x_2)\dots P_{n_r}(x_1,x_2) ,$$
where $M,r$ and $n_0,n_1,\dots,n_{r}$ are integers naturally associated to $\ceqvar$ and $\lm$ and 
$$P_n(x_1,x_2)=(x_1^{n+1}-x_2^{n+1})/(x_1-x_2)=x_1^{n}+x_1^{n-1}x_2+\dots+x_1x_2^{n-1}+x_2^n.$$
We fix the skew-shape $\lm$ throughout the whole section and let $W(\lm)$ be the number of columns in $\lm$. We will have a running example with $\lambda=(7,7,7,4,4)$ and $\mu=(5,3,2)$.



\subsection{Irreducible components}
Given a rpp $T$, consider the set $\NS(T)$ of all cells $(i,j)\in \lm$ such that $T(i,j)=1$ but $T(i+1,j)=2$ (in other words, $\NS(T)$ is the set of all non-stangant cells in $T$ filled with a $1$). Clearly, $\NS(T)$ contains at most one cell from each column, so denote $\NS(T)=\{(i_1,j_1),(i_2,j_2),\dots,(i_s,j_s)\}$ with $j_1<j_2<\dots<j_s$. Because $T$ is a 12-rpp, it follows that the numbers $i_1,i_2,\dots,i_s$ decrease weakly, therefore they form a partition which we call \textit{the cut-partition of} $T$ and denote 
$$\cut(T):=(i_1,i_2,\dots,i_s).$$ 
An example of calculation of $\cut(T)$ and $\NS(T)$ is illustrated on Figure \ref{fig:cut}.

\def\one{{\mathbf{1}}}
\def\two{{\mathbf{1}}}

\begin{figure}
\begin{tabular}{cc}
 & \\
\begin{ytableau}
\none& \none& \none&\none&\none & 1   & 2 \\
\none& \none& \none& 1   & 1    &\one & 2 \\
\none& \none& \one &\one & 1    & 2   & 2 \\
\one &    2 & 2    & 2 \\
2    &    2 & 2    & 2
\end{ytableau}\ \  &
\begin{ytableau}
\none& \none& \none&\none&\none & 1   & 1    \\
\none& \none& \none& 1   & 1    & 1   & \one \\
\none& \none& \one &\one & 1    & 1   & 2    \\
1    & \one & 2    & 2 \\
2    &    2 & 2    & 2
\end{ytableau}\\
 & \\
$\NS(T_1)=\{(4,1),(3,3),(3,4),(2,6)\}$ & $\NS(T_2)=\{(4,2),(3,3),(3,4),(2,7)\}$ \\
$\cut(T_1)=(4,3,3,2)$ & $\cut(T_2)=(4,3,3,2)$ 
\end{tabular}\\
\caption{\label{fig:cut} Two rpps of the same shape and with the same cut-partition.}
\end{figure}



We would like to answer the following question: for which partitions $\cutvar=(i_1\geq \dots\geq i_s>0)$ there exists a rpp $T$ of shape $\lm$ such that $\cut(T)=\cutvar$?

A trivial necessary condition for this to happen is that there should exist some numbers $j_1<j_2<\dots<j_s$ such that 
\begin{equation}\label{cond:necessary}
(i_1,j_1),(i_1+1,j_1),(i_2,j_2),(i_2+1,j_2),\dots,(i_s,j_s),(i_s+1,j_s)\in \lm. 
\end{equation}

\newcommand{\nuxy}[2]{{\cutvar\big|_{[#1,#2)}}}
\def\nuab{{\cutvar\big|_{[a,b)}}}


For each integer $i$ the set of all integers $j$ such that $(i,j),(i+1,j)\in\lm$ is just an interval $[\mu_{i}+1,\lambda_{i+1}]$ which we call \textit{the support of $i$} and denote $\supp(i):=[\mu_{i}+1,\lambda_{i+1}]$. For two integers $a< b$, by $\nuab$ we denote the subpartition $(i_r,i_{r+1},\dots,i_{r+q})$ of $\cutvar$ such that for $r\leq k\leq r+q$ we have $\supp(i_k)\subset [a,b)$. In this case, we put $\#\nuab:=q+1$ which is just the number of entries in $\nuab$. For example, for $\cutvar=(4,3,3,2)$ and $\lm$ as on Figure \ref{fig:cut}, we have $\supp(3)=[3,4]$, $\supp(2)=[4,7]$, $\supp(4)=[1,4]$, $\nuxy{2}{7}=(3,3)$, $\nuxy{2}{8}=(3,3,2)$, $\nuxy{4}{8}=(2)$ and $\#\nuxy{2}{7}=2$. 

We introduce several definitions (all of which depend on $\lm$): a partition $\cutvar=(i_1\geq \dots\geq i_s>0)$ is called

\begin{tabular}{@{$\bullet$ }lll}
 \textit{non-representable} & if for some $a<b$ we have & $\#\nuab>b-a$;\\
 \textit{representable}& if for all $a<b$ we have& $\#\nuab\leq b-a$;\\
 \textit{irreducible}& if for all  $a<b$ we have &$\#\nuab < b-a$;\\
 \textit{reducible} &if for some $a<b$ we have &$\#\nuab=b-a$.
\end{tabular}

For example, $\cutvar=(4,3,3,2)$ is representable but reducible because we have $\nuxy{3}{5}=(3,3)$ so $\#\nuxy{3}{5}=2=5-3$.

These definitions can be motivated as follows. Suppose that a partition $\cutvar$ is non-representable, so there exist integers $a<b$ such that $\#\nuab>b-a$. Recall that $\nuab=:(i_r,i_{r+1},\dots,i_{r+q})$ contains all entries of $\cutvar$ whose support is a subset of $[a,b)$. Thus in order for condition (\ref{cond:necessary}) to be true there must exist some integers $j_r<j_{r+1}<\dots<j_{r+q}$ such that 
$$(i_r, j_r),\dots,(i_{r+q},j_{r+q})\in\lm.$$
From the other hand, by the defintion of the support, we must have $j_k\in \supp(i_k)\subset [a,b)$ for all $r\leq k\leq r+q$. Therefore we get $q+1$ distinct elements of $[a,b)$ which is impossible if $q+1=\#\nuab>b-a$. It means that a non-representable partition $\cutvar$ is never a cut-partition of a 12-rpp $T$. 

Suppose now that a partition $\cutvar$ is reducible, so for some $a<b$ we get an equality $\#\nuab=b-a$. Then these integers $j_r<\dots<j_{r+q}$ should still all belong to $[a,b)$ and there are exactly $b-a$ of them, hence 
$$j_r=a,j_{r+1}=a+1,\dots,j_{r+q}=a+q=b-1.$$
Because $\supp(i_r)\subset[a,b)$, we have $(i_r,a-1)\notin\lm$ so placing a one into $(i_r,a)$ and twos into $(i_r+1,a),(i_r+2,a),\dots$ does not put any resrtictions on entries in columns $1,\dots, a-1$. And the same is true for columns $b,b+1,\dots$. Thus, if a partition $\cutvar$ is reducible then the filling of columns $a,a+1,\dots, b-1$ is uniquely determined and the filling of the rest can be arbitrary -- the problem of existence of and 12-rpp $T$ such that $\cut(T)=\cutvar$ reduces to two smaller independent problems of the same kind. One can continue this reduction process and end up with several independent irreducible components separated from each other by mixed columns. An illustration of this phenomenon can be seen on Figure \ref{fig:cut}: the columns $3$ and $4$ must be mixed for any 12-rpps $T$ with $\cut(T)=(4,3,3,2)$. We summarize our observations in the follwing lemma:
\begin{lemma}
\label{lemma:irreducible}
 For a partition $\cutvar$, there exist unique numbers $(1=b_0\leq a_1<b_1<a_2<b_2<\dots<a_r<b_r\leq a_{r+1}=W(\lm)+1)$ such that 
 \begin{itemize}
  \item for all $1\leq k\leq r$, $\#\nuxy{a_k}{b_k} =b_k-a_k$;
  \item for all $0\leq k \leq r$, $\nuxy{b_k}{a_{k+1}}$ is irreducible.
 \end{itemize}
\end{lemma}\qed
\begin{defi}
 In the context of Lemma \ref{lemma:irreducible}, for $0\leq k\leq r$ the subpartitions $\nuxy{b_k}{a_{k+1}}$ are called \textit{the irreducible components of $\cutvar$} and the numbers $n_k:=a_{k+1}-b_k-\#\nuxy{b_k}{a_{k+1}}$ are called their \textit{degrees}  (for $T$ with $\cut(T)=\cutvar$, the $k$-th degree $n_k$ is equal to the number of pure columns of $T$ inside the corresponding $k$-th irreducible component).
\end{defi}
\begin{remark}
 Note that the conditions on $b_0,a_1,\dots,a_{r+1}$ guarantee that $\cutvar$ is just a concatenation of partitions $\nuxy{b_0}{a_1},\nuxy{a_1}{b_1},\dots,\nuxy{b_r}{a_{r+1}}$. 
\end{remark}

\begin{exmp}
 For $\cutvar=(4,3,3,2)$ we have $r=1,b_0=1,a_1=3,b_1=5,a_2=8$. The irreducible components of $\cutvar$ are $(4)$ and $(2)$ and their degrees are $3-1-1=1$ and $8-5-1=2$ respectively. We have $\nuxy{1}{3}=(4),\nuxy{3}{5}=(3,3),\nuxy{5}{8}=(2)$.
\end{exmp}


\subsection{The structural theorem and its applications}
It is easy to see that for a 12-rpp $T$, $\#\cut(T)$ is equal to the number of mixed columns in $T$. Also, by $\OneTwoRPP$ denote the set of all 12-rpps $T$ of shape $\lm$ and by $\OneTwoRPPCutvar$ denote its subset that contains only 12-rpps $T$ with $\cut(T)=\cutvar$. Now we are ready to state a theorem that completely describes the structure of irreducible components:
\begin{theo}
\label{thm:12rpps}
 Let $\cutvar$ be an irreducible partition. Then for all $0\leq m\leq W(\lm)-\#\cutvar$ there is exactly one 12-rpp $T\in\OneTwoRPPCutvar$ with $\#\cutvar$ mixed columns, $m$ $1$-pure columns and $(W(\lm)-\#\cutvar-m)$ $2$-pure columns. Moreover, these are the only elements of $\OneTwoRPPCutvar$. In other words, for an irreducible partition $\cutvar$ we have
  \begin{equation}
 \label{eq:thm12rpps}
 \sum_{T\in\OneTwoRPPCutvar} x^{\ircont(T)}=(x_1x_2)^{\#\cutvar} P_{W(\lm)-\#\cutvar}(x_1,x_2).
 \end{equation}
\end{theo}

\begin{exmp}
 Each of the two 12-rpps on Figure \ref{fig:cut} has two irreducible components. One of them is supported on the first two columns and the other one is supported on the last three columns. All possible 12-rpps for each component are depicted on Figure \ref{fig:irr}.
 
\begin{figure}
\begin{tabular}{cc}
\begin{tabular}{cc}
 & \\
\begin{ytableau}
1 & \one \\
1 & 2
\end{ytableau}\ &
\begin{ytableau}
\one& 2\\
2   & 2
\end{ytableau}\\
\end{tabular} & 
\begin{tabular}{ccc}
\begin{ytableau}
\none & 1 & 1\\
1 & 1 & \one \\
1 & 1 & 2
\end{ytableau}\ &
\begin{ytableau}
\none & 1 & 2\\
1 & \one & 2 \\
1 & 2 & 2
\end{ytableau}\ &
\begin{ytableau}
\none & 2 & 2\\
\one & 2 & 2 \\
2 & 2 & 2
\end{ytableau} \\
\end{tabular}\\
$\lambda=(2,2);\ \mu=();\ \cutvar=(1)$ & $\lambda=(3,3,3);\ \mu=(1);\ \cutvar=(2)$. 
\end{tabular}\\
\caption{\label{fig:irr} Irreducible components and all possible 12-rpps for them}
\end{figure}
\end{exmp}


After decomposing into irreducible components, we can obtain a formula for general reducible partitions:
\begin{coro}
 Let $\cutvar$ be a representable partition. Then
  \begin{equation}
  \label{eq:thm12rppsComposite}
\sum_{T\in\OneTwoRPPCutvar} x^{\ircont(T)}=(x_1x_2)^{M} P_{n_0}(x_1,x_2)P_{n_1}(x_1,x_2)\dots P_{n_r}(x_1,x_2),
  \end{equation}

  where the numbers $M,r,n_0,\dots,n_r$ are defined above: $M=\#\cutvar$, $r+1$ is the number of irreducible components of $\cutvar$ and $n_0,n_1,\dots,n_r$ are their degrees.
\end{coro}

 For a 12-rpp $T$, the vectors $\cut(T)$ and $\ceq(T)$ uniquely determine each other: if $(\ceq(T))_i=h$ then $\cut(T)$ contains exactly $\lambda_{i+1}-\mu_i-h$ entries equal to $i$, and this correspondence is one-to-one. Therefore, the polynomials on both sides of (\ref{eq:thm12rppsComposite}) are equal to $Q_{\ceqvar}(x_1,x_2)$ where the vector $\ceqvar$ is the one that corresponds to $\cutvar$.

 Note that the polynomials $P_n(x_1,x_2)$ are symmetric for all $n$. Since the question about the symmetry of $\g$ can be reduced to the two-variable case, Theorem \ref{thm:12rpps} gives an alternative proof of the symmetry of $\g$:
\begin{coro}
 The polynomials $\g(x_1,x_2,x_3,\dots;\t)$ are symmetric in $(x_1,x_2,x_3\dots)$.
\end{coro}

Another application of Theorem \ref{thm:12rpps} is a complete description of Bender-Knuth involutions on rpps.

\begin{coro}
\label{cor:uniqueBK}
Let $\cutvar$ be an irreducible partition. Then there is a unique map $b:\OneTwoRPPCutvar\to\OneTwoRPPCutvar$ such that for all $T\in\OneTwoRPPCutvar$ we have 
$$\ircont(T)=(c_1,c_2,0,0,\dots)\Longrightarrow \ircont(b(T))=(c_2,c_1,0,0,\dots).$$
In this case, such a map is an involution on $\OneTwoRPPCutvar$. So, for irreducible partition $\cutvar$ the corresponding Bender-Knuth involution exists and is unique.
\end{coro}

Take any 12-rpp $T\in\OneTwoRPPCutvar$ and recall that a 12-table $\flip(T)$ is obtained from $T$ by simultaneously replacing all entries in $1$-pure columns by $2$ and all entries in $2$-pure columns by $1$. 

\begin{coro}
\label{cor:confluence}
 If $\cutvar$ is an irreducible partition, then no matter in which order one resolves conflicts in $\flip(T)$, the resulting tableau $T'$ will be the same. The map $T\to T'$ is the unique Bender-Knuth involution on $\OneTwoRPPCutvar$.
\end{coro}
\begin{proof}[Proof of Corollary \ref{cor:confluence}]
 By Proposition \ref{prop.finality}, conflict-resolving steps applied in any order give an element of $\OneTwoRPPCutvar$. So we get a map $\OneTwoRPPCutvar\to \OneTwoRPPCutvar$ that satisfies the assumptions of Corollary \ref{cor:uniqueBK}.
\end{proof}


Finally, notice that for a general representable partition $\cutvar$ conflicts may only occur inside each irreducible component independently, so we conclude the chain of corollaries by stating that our constructed involutions are canonical in the following sense:

\begin{coro}
 For a representable partition, the map $\mathbf{B}:\OneTwoRPPCutvar\to\OneTwoRPPCutvar$ is the unique involution that interchanges the number of $1$-pure columns with the number of $2$-pure columns inside each irreducible component.
\end{coro}

\subsection{The proof}
Recall that $\cutvar=(i_1,\dots,i_s)$ is an irreducible partition. We start with the following simple observation:
\begin{lemma}
\label{lemma:leftRight}
 Let $T\in\OneTwoRPPCutvar$. Then any $1$-pure column of $T$ is to the left of any $2$-pure column of $T$.
\end{lemma}
\begin{proof}[Proof of Lemma \ref{lemma:leftRight}]
Suppose it is false and we have a $1$-pure column to the right of a $2$-pure column. Consider the closest pair of columns $a$ and $b$ such that $a$ is $2$-pure and $b$ is $1$-pure, then the columns $a+1,\dots,b-1$ must all be mixed. %, otherwise if some column $k\in (a,b)$ is $1$-pure (resp., $2$-pure) then the columns $a$ and $k$ (resp., $k$ and $b$) would be closer to each other than $a$ and $b$.
Therefore the set $\NS(T)$ contains $\{(i_1,a+1),(i_2,a+2),\dots,(i_{b-1-a},b-1)\}$. And because $a$ is $2$-pure and $b$ is $1$-pure, the support of any $i_k$ for $k=1\dots b-1-a$ is a subset of $[a+1,b)$ which contradicts the irreducibility of $\cutvar$.
\end{proof}


\begin{proof}[Proof of Theorem \ref{thm:12rpps}]
We proceed by induction on the number of columns in $\lm$. If the number of columns is one then the statement of Theorem \ref{thm:12rpps} is obvious. Suppose that we have proven that for all skew-shapes $\widetilde{\lm}$ with less than $W(\lm)$ columns and for all $\widetilde{\lm}$-irreducible partitions $\widetilde\cutvar$ and for all $0\leq \widetilde m\leq W(\widetilde{\lm})-\#\widetilde\cutvar$, there is exactly one 12-rpp $\widetilde T$ of shape $\widetilde{\lm}$ with exactly $\widetilde m$ $1$-pure columns, exactly $\#\widetilde\cutvar$ mixed columns and exactly $(W(\widetilde{\lm})-\#\widetilde\cutvar-\widetilde m)$ $2$-pure columns. Now we want to prove the same for $\lm$.

Take any 12-rpp $T\in\OneTwoRPPCutvar$ with $\cut(T)=\cutvar$ and with $m$ $1$-pure columns for $0\leq m\leq W(\lm)-\#\cutvar$. Suppose first that $m>0$. Then there is at least one $1$-pure column in $T$. Let $q+1$ be the leftmost such column for some $q\geq 0$. Then by Lemma \ref{lemma:leftRight} the columns $1,2,\dots,q$ are mixed. If $q>0$ then the supports of $i_1,i_2,\dots,i_q$ are all contained inside $[1,q+1)$ and we get a contradiction with the irreducibility of $\cutvar$. The only remaining case is that $q=0$ and the first column of $T$ is $1$-pure. Let $\widetilde\lm$ denote $\lm$ with the first column removed. Then $\cutvar$ may be not $\widetilde\lm$-reducible, because it may happen that $\#\nuxy{1}{b}=b-1$ for some $b$. In this case we can ignore these first $b-1$ mixed columns and apply the induction hypothesis. We are done with the case $m>0$. If $m<W(\lm)-\#\cutvar$ then we can apply a mirrored argument to the last column, and it remains to note that for $W(\lm)-\#\cutvar>0$ the cases $m>0$ and $m<W(\lm)-\#\cutvar$ cover everything and for $W(\lm)=\#\cutvar$ we get that $T$ is a 12-rpp with all mixed columns, but there is obviously a unique such 12-rpp.
\end{proof}




\begin{todo}
Mention failure of order-$6$ relation?
\end{todo}

\begin{thebibliography}{99999999}                                                                                         %


\bibitem[BaaNip98]{BaaNip98}Franz Baader, Tobias Nipkow, \textit{Term
Rewriting and All That}, Cambridge University Press 1998.

\bibitem[BezCoq03]{BezCoq}Marc Bezem, Thierry Coquand, \textit{Newman's Lemma
-- a Case Study in Proof Automation and Geometric Logic}, Bulletin of the
European Association for Theoretical Computer Science, February 2003.\newline%
\texttt{\href{http://www.ii.uib.no/~bezem/NL/}{http://www.ii.uib.no/\symbol{126}%
bezem/NL/}}

\bibitem[FomGre06]{FomGre}Sergey Fomin, Curtis Greene, \textit{Noncommutative
Schur functions and their applications}, Discrete Mathematics 306 (2006) 1080--1096.

\bibitem[Fulton97]{Fulton97}William Fulton, \textit{Young Tableaux}, London
Mathematical Society Student Texts 35, Cambridge University Press 1997.

\bibitem[GriRei15]{GriRei15}Darij Grinberg, Victor Reiner, \textit{Hopf
algebras in Combinatorics}, June 1, 2015,
\href{http://arxiv.org/abs/1409.8356v2}{arXiv:1409.8356v2}. \newline See also
\url{http://web.mit.edu/~darij/www/algebra/HopfComb.pdf} for a version which
is more frequently updated.

\bibitem[LamPyl07]{LamPyl}Thomas Lam, Pavlo Pylyavskyy, \textit{Combinatorial
Hopf algebras and }$K$\textit{-homology of Grassmanians},
\href{http://arxiv.org/abs/0705.2189v1}{arXiv:0705.2189v1}. An updated version
was later published in: International Mathematics Research Notices, Vol. 2007,
Article ID rnm125, 48 pages. doi:10.1093/imrn/rnm125.

\bibitem[Macdon95]{Macdon95}Ian G. Macdonald, \textit{Symmetric Functions and
Hall Polynomials}, 2nd edition, Oxford University Press 1995.

\bibitem[Stan99]{Stan99}Richard Stanley, \textit{Enumerative Combinatorics,
volume 2}, Cambridge University Press, 1999.
\end{thebibliography}


\end{document}